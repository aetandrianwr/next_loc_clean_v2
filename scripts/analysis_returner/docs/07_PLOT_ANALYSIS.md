# Plot Analysis: Visual Interpretation Guide

## 1. Overview of Generated Plots

This document provides detailed interpretation of all plots generated by the return probability analysis. Each plot is explained with:
- How to read the plot
- What the visual elements mean
- Key insights from the visualization
- Interpretation for research purposes

---

## 2. Plot Inventory

| Plot File | Description | Key Feature |
|-----------|-------------|-------------|
| `geolife_return_probability_v2.png` | Geolife return distribution with RW baseline | Strong 24h periodicity |
| `diy_return_probability_v2.png` | DIY return distribution with RW baseline | Smooth 24h peak |
| `geolife_return_probability.png` | Geolife return distribution (basic) | Original style |
| `diy_return_probability.png` | DIY return distribution (basic) | Original style |
| `comparison_return_probability.png` | Both datasets overlaid | Direct comparison |

---

## 3. Geolife Return Probability Plot (V2)

### 3.1 Visual Description

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                    geolife_return_probability_v2.png                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│                                               ┌──────────────┐              │
│                                               │    Legend    │              │
│   F_pt(t) ▲                                   │ - - - Users  │              │
│           │                                   │ ─── RW       │              │
│   0.025 ──┤║                                  └──────────────┘              │
│           │║                                                                │
│           │║     ║        ║                                                 │
│   0.020 ──┤║     ║        ║     ║                                          │
│           │║     ║        ║     ║                                          │
│           │║     ║   ║    ║     ║                                          │
│   0.015 ──┤║     ║   ║    ║     ║                                          │
│           │║     ║   ║    ║     ║            ║                              │
│           │║════════════════════════════════════════════════                │
│   0.010 ──┤╲     (Blue dashed line - Users)                                │
│           │ ╲                                                               │
│           │  ╲╲  (Black solid line - RW baseline)                          │
│   0.005 ──┤    ╲╲                                                          │
│           │      ╲╲╲                                                        │
│           │         ╲╲╲╲__________                                          │
│   0.000 ──┼─────────────────────────────────────────────────────────► t    │
│           0    24    48    72    96   120   144   168   192   216   240    │
│                                                                  (hours)    │
│                                                                             │
│   Title: Return Probability Distribution - Geolife                         │
│   X-axis: t (h) - Time since first observation in hours                    │
│   Y-axis: F_pt(t) - Probability density of first return                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 Reading the Plot

**X-Axis (Horizontal)**:
- Represents time in hours since the user's first observation
- Ranges from 0 to 240 hours (10 days)
- Tick marks every 24 hours (one day)

**Y-Axis (Vertical)**:
- Represents probability density F_pt(t)
- Higher values = more users return at that time
- Unit: probability per hour

**Blue Dashed Line (Users)**:
- Actual observed return probability distribution
- Each point shows likelihood of return at that time
- Spikes indicate times when many users return

**Black Solid Line (RW)**:
- Random Walk baseline (exponential decay)
- Represents what we'd expect if movement was random
- Comparison benchmark

### 3.3 Key Observations

1. **Initial Peak at ~3 hours**:
   - Highest probability density (~0.05)
   - Indicates many users return quickly (same day)
   - Could represent forgotten items, quick errands

2. **24-Hour Periodicity**:
   - Clear spikes at 24h, 48h, 72h, 96h
   - Strong evidence of daily routine
   - "Next day at same time" returns

3. **Above RW Baseline**:
   - Users line consistently above RW
   - Proves non-random, intentional returns
   - Especially elevated at 24-hour multiples

4. **Decay Pattern**:
   - Overall decreasing trend
   - Most returns within first 3 days
   - Long tail extends to 240 hours

### 3.4 Research Interpretation

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ INSIGHT: Geolife users exhibit strong circadian rhythms with sharp         │
│ periodic peaks, indicating highly scheduled routines. The deviation from   │
│ random walk confirms intentional mobility patterns.                        │
│                                                                             │
│ FOR THESIS: Use this plot to demonstrate that human mobility is not        │
│ random - the periodic structure justifies temporal features in models.     │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4. DIY Return Probability Plot (V2)

### 4.1 Visual Description

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      diy_return_probability_v2.png                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│                                               ┌──────────────┐              │
│   F_pt(t) ▲                                   │    Legend    │              │
│           │                                   │ - - - Users  │              │
│   0.025 ──┤        ∿                          │ ─── RW       │              │
│           │      ∿  ∿                         └──────────────┘              │
│           │     ∿    ∿                                                      │
│   0.020 ──┤    ∿      ∿                                                    │
│           │   ∿        ∿                                                    │
│           │  ∿          ∿∿                                                  │
│   0.015 ──┤ ∿            ∿∿                                                │
│           │∿               ∿∿                                               │
│           │                  ∿∿∿                                            │
│   0.010 ──┤╲                   ∿∿∿∿                                        │
│           │ ╲                      ∿∿∿∿                                     │
│           │  ╲╲                        ∿∿∿∿∿                                │
│   0.005 ──┤    ╲╲                          ∿∿∿∿∿∿∿                         │
│           │      ╲╲╲                             ∿∿∿∿∿∿∿∿∿                  │
│           │         ╲╲╲╲____________                     ∿∿∿∿∿∿∿            │
│   0.000 ──┼─────────────────────────────────────────────────────────► t    │
│           0    24    48    72    96   120   144   168   192   216   240    │
│                ↑                                                 (hours)    │
│             Peak ~23h                                                       │
│                                                                             │
│   Title: Return Probability Distribution - DIY                             │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.2 Key Observations

1. **Smooth Peak at ~23 hours**:
   - Broader peak than Geolife (not as sharp)
   - Maximum F_pt(t) ≈ 0.024
   - Indicates 24-hour cycle but with variation

2. **Gradual Decline**:
   - Smoother curve than Geolife
   - Reflects more diverse user behaviors
   - 1,091 users vs 49 users = more averaging

3. **Sustained Probability**:
   - Remains elevated even at 120+ hours
   - Users continue returning throughout week
   - Long tail extends to 10 days

4. **Above RW Baseline Throughout**:
   - Consistently higher than random expectation
   - Gap widens around 24-hour mark
   - Confirms intentional return behavior

### 4.3 Comparison: DIY vs Geolife

| Aspect | Geolife | DIY |
|--------|---------|-----|
| Peak Height | 0.051 | 0.024 |
| Peak Location | 3h | 23h |
| Peak Shape | Sharp spikes | Smooth curve |
| Periodicity | Very clear | Present but blended |
| Sample Size | 49 users | 1,091 users |

**Interpretation**:
- Geolife: Small sample, extreme behaviors visible
- DIY: Large sample, individual patterns averaged out

---

## 5. Comparison Plot

### 5.1 Visual Description

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                   comparison_return_probability.png                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│                                               ┌──────────────┐              │
│   F_pt(t) ▲                                   │    Legend    │              │
│           │                                   │ --●-- Geolife│              │
│   0.05  ──┤▓                                  │ ──■── DIY    │              │
│           │▓                                  └──────────────┘              │
│           │▓                                                                │
│   0.04  ──┤▓     ▓                                                         │
│           │▓     ▓        ▓                                                 │
│           │▓     ▓   ▓    ▓                                                 │
│   0.03  ──┤▓     ▓   ▓    ▓     ▓                                          │
│           │▓     ▓   ▓    ▓     ▓                                          │
│           │      ∿∿∿∿                                                       │
│   0.02  ──┤    ∿      ∿      ∿                                             │
│           │   ∿        ∿∿∿  ∿ ∿                                            │
│           │  ∿            ∿∿   ∿∿                                           │
│   0.01  ──┤ ∿                    ∿∿∿∿                                      │
│           │∿                          ∿∿∿∿∿∿∿∿∿∿∿                          │
│           │                                                                 │
│   0.00  ──┼─────────────────────────────────────────────────────────► t    │
│           0    24    48    72    96   120   144   168   192   216   240    │
│                                                                  (hours)    │
│                                                                             │
│   ▓ = Geolife (blue dashed with markers)                                   │
│   ∿ = DIY (red solid with markers)                                         │
│                                                                             │
│   Title: Return Probability Distribution - Dataset Comparison              │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 5.2 Cross-Dataset Insights

1. **Different Peak Structures**:
   - Geolife: Multiple sharp spikes
   - DIY: Single smooth peak
   - Both centered around 24 hours

2. **Scale Difference**:
   - Geolife peaks higher (smaller sample, less averaging)
   - DIY more moderate heights (larger sample, more stable)

3. **Tail Behavior**:
   - Geolife: Sporadic returns at long times
   - DIY: Sustained low probability out to 240h

4. **Common Pattern**:
   - Both show 24-hour periodicity
   - Both deviate from random walk
   - Both confirm returner behavior

---

## 6. How to Read Probability Density

### 6.1 Understanding Y-axis Values

The Y-axis shows **probability density**, not probability:

```
                    INTERPRETING PROBABILITY DENSITY
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

F_pt(t) = 0.025 at t = 23 hours

This means:
  P(return between 22h and 24h) = F_pt(23) × bin_width
                                = 0.025 × 2
                                = 0.05
                                = 5%

About 5% of users return between 22 and 24 hours after first observation.
```

### 6.2 Converting to Probability

To get probability for a time interval:

```
P(t₁ ≤ return_time < t₂) = ∫_{t₁}^{t₂} F_pt(t) dt
                        ≈ Σ F_pt(tᵢ) × Δt   (for bins in [t₁, t₂])
```

**Example**: What's the probability of returning within 48 hours?

```
P(return within 48h) = Σ F_pt(tᵢ) × 2   for tᵢ ∈ [1, 3, 5, ..., 47]
                     ≈ 0.45  (about 45%)
```

---

## 7. Visual Features Explained

### 7.1 Periodic Spikes

```
        WHY DO WE SEE 24-HOUR SPIKES?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   User leaves home at 8 AM on Day 1
        │
        ▼
   ┌─────────────────────────────────────────┐
   │ Day 1: 8 AM → Work → Gym → Home (8 PM) │
   │        Δt = 12 hours                    │
   └─────────────────────────────────────────┘
        │
        ▼
   ┌─────────────────────────────────────────┐
   │ Day 2: 8 AM → Returns home from prev.  │
   │        Δt = 24 hours exactly           │
   └─────────────────────────────────────────┘
        │
        ▼
   The 24-hour spike represents users who return
   "at the same time the next day"
```

### 7.2 Early Peak (3 hours)

```
        WHY PEAK AT 3 HOURS?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   Common scenarios for quick returns:
   
   1. Forgot something at home
      Home (8 AM) → Work → forgot keys → Home (9 AM)
      Δt = 1 hour
   
   2. Short errands
      Home → Grocery → Home
      Δt = 2-3 hours
   
   3. Weekend morning
      Home (8 AM) → Breakfast → Home (11 AM)
      Δt = 3 hours
   
   These aggregate to create the early peak
```

### 7.3 RW Baseline Purpose

```
        WHY INCLUDE RANDOM WALK BASELINE?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   Scientific Question:
   "Is human mobility different from random movement?"
   
   Method:
   1. Calculate what random movement would look like (RW)
   2. Compare actual data to RW
   3. Measure deviation
   
   Result:
   ┌────────────────────────────────────────────────┐
   │                                                │
   │   Users consistently ABOVE RW baseline         │
   │   ───────────────────────────────────────      │
   │   This proves humans return MORE than random   │
   │   Movement is intentional, not random          │
   │                                                │
   └────────────────────────────────────────────────┘
```

---

## 8. Using Plots in Publications

### 8.1 Figure Caption Template

For `geolife_return_probability_v2.png`:

> **Figure X**: Return probability distribution F_pt(t) for the Geolife dataset. 
> The blue dashed line shows the empirical probability density of first-return 
> times for users, while the black solid line represents the Random Walk (RW) 
> baseline model with exponential decay. Clear peaks at 24-hour intervals 
> indicate strong circadian periodicity in human mobility. The observed 
> distribution significantly exceeds the RW baseline, confirming that human 
> movement is intentional rather than random. Analysis based on 49 users with 
> returns (53.85% return rate) over a 10-day observation window.

### 8.2 Key Claims Supported by Plots

| Claim | Visual Evidence |
|-------|-----------------|
| "Human mobility is predictable" | High probability values (up to 0.05) |
| "Daily routines dominate" | 24-hour periodic peaks |
| "Movement is not random" | Users above RW baseline |
| "Returns are common" | Sustained high probability over time |
| "Timing matters" | Sharp peaks at specific hours |

### 8.3 Statistical Annotations

When presenting, consider adding:
- Peak values with labels
- Confidence bands (if computed)
- Key percentile markers
- Statistical test results (KS test p-value)

---

## 9. Interpretation Summary

### 9.1 Main Findings from Visual Analysis

1. **Periodicity Confirmed**: 
   - Both datasets show 24-hour patterns
   - Visual evidence of circadian rhythm influence

2. **Non-Random Behavior**:
   - Consistent elevation above RW baseline
   - Periodic structure impossible with random walk

3. **Dataset Differences**:
   - Geolife: Sharp peaks, high variability
   - DIY: Smooth curve, more stable patterns

4. **Prediction Relevance**:
   - High probability at specific times
   - Justifies temporal features in models

### 9.2 Connection to Model Design

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                 VISUAL EVIDENCE → MODEL DESIGN                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   Plot Observation           →    Model Feature                            │
│   ─────────────────────────────────────────────────────────────            │
│   High return probability    →    Pointer mechanism (copy from history)   │
│   24-hour peaks              →    Time-of-day embedding                    │
│   Recency matters            →    Position-from-end encoding              │
│   Some new locations         →    Generation head (full vocabulary)       │
│   User-specific patterns     →    User embeddings                         │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

*← Back to [Results Interpretation](06_RESULTS_INTERPRETATION.md) | Continue to [Model Justification](08_MODEL_JUSTIFICATION.md) →*
