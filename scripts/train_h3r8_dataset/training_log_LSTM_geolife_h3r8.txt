Using device: cuda
Experiment directory: experiments/geolife_LSTM_20260107_104427
Data loaders: train=297, val=132, test=139
Total trainable parameters: 536294
Current learning rate: 0.0
Epoch 1, 6.7%	 loss: 7.119 acc@1: 0.00 mrr: 0.53, ndcg: 0.12, took: 1.33s
Epoch 1, 13.5%	 loss: 7.081 acc@1: 0.00 mrr: 0.61, ndcg: 0.37, took: 0.77s
Epoch 1, 20.2%	 loss: 6.994 acc@1: 0.31 mrr: 1.24, ndcg: 1.03, took: 0.77s
Epoch 1, 26.9%	 loss: 6.926 acc@1: 0.00 mrr: 0.87, ndcg: 0.45, took: 0.75s
Epoch 1, 33.7%	 loss: 6.787 acc@1: 0.47 mrr: 1.67, ndcg: 1.26, took: 0.72s
Epoch 1, 40.4%	 loss: 6.578 acc@1: 3.75 mrr: 6.00, ndcg: 6.03, took: 0.76s
Epoch 1, 47.1%	 loss: 6.403 acc@1: 6.09 mrr: 9.30, ndcg: 9.97, took: 0.72s
Epoch 1, 53.9%	 loss: 6.137 acc@1: 9.84 mrr: 13.68, ndcg: 14.49, took: 0.83s
Epoch 1, 60.6%	 loss: 5.889 acc@1: 11.41 mrr: 16.55, ndcg: 17.95, took: 0.83s
Epoch 1, 67.3%	 loss: 5.658 acc@1: 13.75 mrr: 20.41, ndcg: 22.59, took: 0.77s
Epoch 1, 74.1%	 loss: 5.414 acc@1: 17.50 mrr: 25.23, ndcg: 28.44, took: 0.76s
Epoch 1, 80.8%	 loss: 5.266 acc@1: 17.03 mrr: 26.63, ndcg: 30.50, took: 0.83s
Epoch 1, 87.5%	 loss: 5.153 acc@1: 16.56 mrr: 26.33, ndcg: 30.46, took: 0.83s
Epoch 1, 94.3%	 loss: 4.789 acc@1: 20.78 mrr: 31.28, ndcg: 35.40, took: 0.67s
Validation loss = 4.94 acc@1 = 19.28 f1 = 10.86 mrr = 30.12, ndcg = 34.42
Validation loss decreased (inf --> 4.939090). Saving model...
Current learning rate: 0.000500
==================================================
Epoch 2, 6.7%	 loss: 4.515 acc@1: 20.16 mrr: 31.51, ndcg: 35.71, took: 0.81s
Epoch 2, 13.5%	 loss: 4.379 acc@1: 24.22 mrr: 34.84, ndcg: 38.76, took: 0.76s
Epoch 2, 20.2%	 loss: 4.185 acc@1: 27.50 mrr: 38.46, ndcg: 42.65, took: 0.80s
Epoch 2, 26.9%	 loss: 4.125 acc@1: 27.97 mrr: 38.83, ndcg: 42.99, took: 0.81s
Epoch 2, 33.7%	 loss: 4.149 acc@1: 24.84 mrr: 37.00, ndcg: 41.52, took: 0.82s
Epoch 2, 40.4%	 loss: 3.937 acc@1: 26.25 mrr: 38.87, ndcg: 44.08, took: 0.75s
Epoch 2, 47.1%	 loss: 3.961 acc@1: 25.47 mrr: 38.61, ndcg: 43.68, took: 0.83s
Epoch 2, 53.9%	 loss: 4.150 acc@1: 24.38 mrr: 36.12, ndcg: 41.30, took: 0.82s
Epoch 2, 60.6%	 loss: 4.046 acc@1: 26.56 mrr: 38.07, ndcg: 42.48, took: 0.71s
Epoch 2, 67.3%	 loss: 3.864 acc@1: 26.72 mrr: 40.65, ndcg: 46.00, took: 0.68s
Epoch 2, 74.1%	 loss: 3.929 acc@1: 24.69 mrr: 38.03, ndcg: 43.18, took: 0.73s
Epoch 2, 80.8%	 loss: 3.682 acc@1: 27.50 mrr: 41.53, ndcg: 46.97, took: 0.68s
Epoch 2, 87.5%	 loss: 4.074 acc@1: 25.78 mrr: 37.86, ndcg: 42.47, took: 0.70s
Epoch 2, 94.3%	 loss: 3.750 acc@1: 24.38 mrr: 39.16, ndcg: 45.09, took: 0.68s
Validation loss = 4.64 acc@1 = 22.43 f1 = 12.89 mrr = 34.20, ndcg = 38.99
Validation loss decreased (4.939090 --> 4.636606). Saving model...
Current learning rate: 0.001000
==================================================
Epoch 3, 6.7%	 loss: 3.602 acc@1: 28.12 mrr: 42.21, ndcg: 47.39, took: 0.70s
Epoch 3, 13.5%	 loss: 3.537 acc@1: 26.09 mrr: 41.23, ndcg: 47.11, took: 0.68s
Epoch 3, 20.2%	 loss: 3.705 acc@1: 26.09 mrr: 39.80, ndcg: 44.97, took: 0.63s
Epoch 3, 26.9%	 loss: 3.543 acc@1: 29.84 mrr: 43.28, ndcg: 48.59, took: 0.77s
Epoch 3, 33.7%	 loss: 3.482 acc@1: 30.00 mrr: 43.60, ndcg: 49.44, took: 0.65s
Epoch 3, 40.4%	 loss: 3.714 acc@1: 24.06 mrr: 38.86, ndcg: 44.83, took: 0.66s
Epoch 3, 47.1%	 loss: 3.501 acc@1: 30.62 mrr: 44.35, ndcg: 49.54, took: 0.67s
Epoch 3, 53.9%	 loss: 3.505 acc@1: 28.75 mrr: 42.81, ndcg: 48.14, took: 0.76s
Epoch 3, 60.6%	 loss: 3.563 acc@1: 26.72 mrr: 41.98, ndcg: 47.80, took: 0.67s
Epoch 3, 67.3%	 loss: 3.448 acc@1: 25.62 mrr: 41.14, ndcg: 47.60, took: 0.72s
Epoch 3, 74.1%	 loss: 3.298 acc@1: 27.50 mrr: 43.87, ndcg: 50.49, took: 0.72s
Epoch 3, 80.8%	 loss: 3.449 acc@1: 28.28 mrr: 43.05, ndcg: 49.60, took: 0.72s
Epoch 3, 87.5%	 loss: 3.494 acc@1: 28.28 mrr: 42.17, ndcg: 48.03, took: 0.70s
Epoch 3, 94.3%	 loss: 3.462 acc@1: 27.03 mrr: 42.18, ndcg: 48.48, took: 0.66s
Validation loss = 4.50 acc@1 = 25.59 f1 = 16.56 mrr = 37.96, ndcg = 42.69
Validation loss decreased (4.636606 --> 4.500832). Saving model...
Current learning rate: 0.000979
==================================================
Epoch 4, 6.7%	 loss: 3.172 acc@1: 30.94 mrr: 45.79, ndcg: 51.84, took: 0.72s
Epoch 4, 13.5%	 loss: 3.243 acc@1: 29.06 mrr: 44.25, ndcg: 50.51, took: 0.73s
Epoch 4, 20.2%	 loss: 3.225 acc@1: 31.56 mrr: 45.56, ndcg: 50.75, took: 0.70s
Epoch 4, 26.9%	 loss: 3.272 acc@1: 28.44 mrr: 44.01, ndcg: 50.12, took: 0.66s
Epoch 4, 33.7%	 loss: 3.211 acc@1: 28.75 mrr: 44.09, ndcg: 50.38, took: 0.74s
Epoch 4, 40.4%	 loss: 3.325 acc@1: 26.72 mrr: 43.34, ndcg: 49.61, took: 0.69s
Epoch 4, 47.1%	 loss: 3.155 acc@1: 32.81 mrr: 47.15, ndcg: 52.95, took: 0.69s
Epoch 4, 53.9%	 loss: 3.188 acc@1: 31.25 mrr: 45.91, ndcg: 51.87, took: 0.65s
Epoch 4, 60.6%	 loss: 3.256 acc@1: 28.75 mrr: 44.64, ndcg: 50.98, took: 0.69s
Epoch 4, 67.3%	 loss: 3.207 acc@1: 28.44 mrr: 44.51, ndcg: 50.58, took: 0.76s
Epoch 4, 74.1%	 loss: 3.337 acc@1: 24.69 mrr: 41.26, ndcg: 47.93, took: 0.76s
Epoch 4, 80.8%	 loss: 3.301 acc@1: 28.12 mrr: 43.32, ndcg: 49.43, took: 0.66s
Epoch 4, 87.5%	 loss: 3.303 acc@1: 27.81 mrr: 42.95, ndcg: 49.21, took: 0.69s
Epoch 4, 94.3%	 loss: 2.961 acc@1: 32.66 mrr: 48.65, ndcg: 55.02, took: 0.70s
Validation loss = 4.57 acc@1 = 24.85 f1 = 15.13 mrr = 37.78, ndcg = 42.48
EarlyStopping counter: 1 out of 5
Current learning rate: 0.000958
==================================================
Epoch 5, 6.7%	 loss: 3.032 acc@1: 27.81 mrr: 44.36, ndcg: 51.18, took: 0.68s
Epoch 5, 13.5%	 loss: 2.977 acc@1: 31.41 mrr: 47.20, ndcg: 53.83, took: 0.64s
Epoch 5, 20.2%	 loss: 2.986 acc@1: 33.44 mrr: 48.48, ndcg: 55.00, took: 0.69s
Epoch 5, 26.9%	 loss: 2.959 acc@1: 33.12 mrr: 48.69, ndcg: 55.24, took: 0.72s
Epoch 5, 33.7%	 loss: 2.932 acc@1: 31.72 mrr: 47.60, ndcg: 53.84, took: 0.71s
Epoch 5, 40.4%	 loss: 2.941 acc@1: 32.03 mrr: 47.79, ndcg: 54.25, took: 0.65s
Epoch 5, 47.1%	 loss: 2.929 acc@1: 28.59 mrr: 46.55, ndcg: 53.70, took: 0.71s
Epoch 5, 53.9%	 loss: 2.995 acc@1: 31.56 mrr: 47.37, ndcg: 53.32, took: 0.68s
Epoch 5, 60.6%	 loss: 2.986 acc@1: 29.84 mrr: 46.38, ndcg: 53.22, took: 0.70s
Epoch 5, 67.3%	 loss: 3.165 acc@1: 27.19 mrr: 43.38, ndcg: 50.22, took: 0.75s
Epoch 5, 74.1%	 loss: 2.923 acc@1: 28.75 mrr: 46.96, ndcg: 54.04, took: 0.71s
Epoch 5, 80.8%	 loss: 3.029 acc@1: 29.84 mrr: 46.08, ndcg: 52.88, took: 0.68s
Epoch 5, 87.5%	 loss: 3.000 acc@1: 30.94 mrr: 47.29, ndcg: 53.72, took: 0.71s
Epoch 5, 94.3%	 loss: 2.994 acc@1: 29.84 mrr: 46.34, ndcg: 53.06, took: 0.68s
Validation loss = 4.54 acc@1 = 26.30 f1 = 17.73 mrr = 38.86, ndcg = 43.52
EarlyStopping counter: 2 out of 5
Current learning rate: 0.000937
==================================================
Epoch 6, 6.7%	 loss: 2.695 acc@1: 32.50 mrr: 49.99, ndcg: 57.38, took: 0.74s
Epoch 6, 13.5%	 loss: 2.781 acc@1: 30.31 mrr: 48.22, ndcg: 55.52, took: 0.63s
Epoch 6, 20.2%	 loss: 2.780 acc@1: 32.97 mrr: 49.62, ndcg: 56.53, took: 0.72s
Epoch 6, 26.9%	 loss: 2.872 acc@1: 32.19 mrr: 48.29, ndcg: 55.10, took: 0.72s
Epoch 6, 33.7%	 loss: 2.855 acc@1: 33.59 mrr: 49.10, ndcg: 55.73, took: 0.74s
Epoch 6, 40.4%	 loss: 2.851 acc@1: 30.62 mrr: 47.91, ndcg: 54.85, took: 0.67s
Epoch 6, 47.1%	 loss: 2.928 acc@1: 25.94 mrr: 44.35, ndcg: 51.78, took: 0.69s
Epoch 6, 53.9%	 loss: 2.862 acc@1: 30.94 mrr: 47.28, ndcg: 53.94, took: 0.69s
Epoch 6, 60.6%	 loss: 2.804 acc@1: 30.31 mrr: 48.20, ndcg: 55.59, took: 0.72s
Epoch 6, 67.3%	 loss: 2.814 acc@1: 32.81 mrr: 49.23, ndcg: 55.90, took: 0.68s
Epoch 6, 74.1%	 loss: 2.915 acc@1: 33.91 mrr: 48.64, ndcg: 54.89, took: 0.68s
Epoch 6, 80.8%	 loss: 2.802 acc@1: 30.78 mrr: 48.20, ndcg: 55.17, took: 0.73s
Epoch 6, 87.5%	 loss: 3.035 acc@1: 29.53 mrr: 45.87, ndcg: 52.49, took: 0.71s
Epoch 6, 94.3%	 loss: 2.821 acc@1: 32.97 mrr: 48.68, ndcg: 55.20, took: 0.73s
Validation loss = 4.66 acc@1 = 25.04 f1 = 16.94 mrr = 37.40, ndcg = 42.17
EarlyStopping counter: 3 out of 5
Current learning rate: 0.000917
==================================================
Epoch 7, 6.7%	 loss: 2.625 acc@1: 32.81 mrr: 50.60, ndcg: 57.70, took: 0.72s
Epoch 7, 13.5%	 loss: 2.586 acc@1: 36.25 mrr: 52.80, ndcg: 59.41, took: 0.65s
Epoch 7, 20.2%	 loss: 2.705 acc@1: 33.28 mrr: 50.40, ndcg: 57.59, took: 0.72s
Epoch 7, 26.9%	 loss: 2.697 acc@1: 29.38 mrr: 48.13, ndcg: 55.31, took: 0.77s
Epoch 7, 33.7%	 loss: 2.609 acc@1: 33.28 mrr: 51.19, ndcg: 58.01, took: 0.73s
Epoch 7, 40.4%	 loss: 2.692 acc@1: 32.50 mrr: 49.46, ndcg: 56.75, took: 0.66s
Epoch 7, 47.1%	 loss: 2.768 acc@1: 30.16 mrr: 47.62, ndcg: 55.22, took: 0.61s
Epoch 7, 53.9%	 loss: 2.865 acc@1: 28.28 mrr: 46.31, ndcg: 53.81, took: 0.66s
Epoch 7, 60.6%	 loss: 2.710 acc@1: 30.94 mrr: 48.45, ndcg: 55.78, took: 0.68s
Epoch 7, 67.3%	 loss: 2.709 acc@1: 34.06 mrr: 50.49, ndcg: 57.56, took: 0.67s
Epoch 7, 74.1%	 loss: 2.702 acc@1: 31.56 mrr: 49.22, ndcg: 56.89, took: 0.71s
Epoch 7, 80.8%	 loss: 2.819 acc@1: 29.84 mrr: 47.65, ndcg: 54.98, took: 0.68s
Epoch 7, 87.5%	 loss: 2.606 acc@1: 33.28 mrr: 51.23, ndcg: 58.26, took: 0.68s
Epoch 7, 94.3%	 loss: 2.799 acc@1: 28.75 mrr: 47.35, ndcg: 54.70, took: 0.74s
Validation loss = 4.66 acc@1 = 25.54 f1 = 17.73 mrr = 38.31, ndcg = 43.03
EarlyStopping counter: 4 out of 5
Current learning rate: 0.000896
==================================================
Epoch 8, 6.7%	 loss: 2.474 acc@1: 34.53 mrr: 52.23, ndcg: 60.03, took: 0.72s
Epoch 8, 13.5%	 loss: 2.576 acc@1: 32.97 mrr: 50.60, ndcg: 57.92, took: 0.71s
Epoch 8, 20.2%	 loss: 2.586 acc@1: 31.41 mrr: 49.72, ndcg: 57.47, took: 0.69s
Epoch 8, 26.9%	 loss: 2.451 acc@1: 33.28 mrr: 51.57, ndcg: 59.39, took: 0.69s
Epoch 8, 33.7%	 loss: 2.535 acc@1: 31.72 mrr: 51.00, ndcg: 58.72, took: 0.71s
Epoch 8, 40.4%	 loss: 2.649 acc@1: 34.06 mrr: 51.03, ndcg: 58.43, took: 0.74s
Epoch 8, 47.1%	 loss: 2.557 acc@1: 32.66 mrr: 50.75, ndcg: 58.89, took: 0.72s
Epoch 8, 53.9%	 loss: 2.542 acc@1: 33.75 mrr: 51.75, ndcg: 59.43, took: 0.72s
Epoch 8, 60.6%	 loss: 2.706 acc@1: 30.62 mrr: 48.15, ndcg: 55.41, took: 0.68s
Epoch 8, 67.3%	 loss: 2.684 acc@1: 31.56 mrr: 49.47, ndcg: 56.28, took: 0.67s
Epoch 8, 74.1%	 loss: 2.584 acc@1: 34.38 mrr: 51.73, ndcg: 58.94, took: 0.71s
Epoch 8, 80.8%	 loss: 2.609 acc@1: 31.88 mrr: 50.22, ndcg: 57.80, took: 0.71s
Epoch 8, 87.5%	 loss: 2.685 acc@1: 32.19 mrr: 49.30, ndcg: 56.58, took: 0.67s
Epoch 8, 94.3%	 loss: 2.579 acc@1: 33.75 mrr: 51.40, ndcg: 58.59, took: 0.62s
Validation loss = 4.76 acc@1 = 26.25 f1 = 18.31 mrr = 38.48, ndcg = 42.81
EarlyStopping counter: 5 out of 5
==================================================
Early stopping
Current learning rate: 0.000088
==================================================
Epoch 9, 6.7%	 loss: 3.281 acc@1: 28.75 mrr: 43.92, ndcg: 49.57, took: 0.68s
Epoch 9, 13.5%	 loss: 3.075 acc@1: 32.97 mrr: 47.52, ndcg: 54.03, took: 0.71s
Epoch 9, 20.2%	 loss: 3.258 acc@1: 27.66 mrr: 43.43, ndcg: 49.48, took: 0.69s
Epoch 9, 26.9%	 loss: 3.134 acc@1: 31.88 mrr: 46.51, ndcg: 52.80, took: 0.65s
Epoch 9, 33.7%	 loss: 3.120 acc@1: 32.50 mrr: 47.23, ndcg: 53.16, took: 0.68s
Epoch 9, 40.4%	 loss: 2.953 acc@1: 33.12 mrr: 48.96, ndcg: 55.37, took: 0.68s
Epoch 9, 47.1%	 loss: 3.201 acc@1: 29.53 mrr: 44.15, ndcg: 50.03, took: 0.69s
Epoch 9, 53.9%	 loss: 3.157 acc@1: 28.28 mrr: 44.47, ndcg: 50.64, took: 0.71s
Epoch 9, 60.6%	 loss: 3.006 acc@1: 32.97 mrr: 48.10, ndcg: 54.73, took: 0.69s
Epoch 9, 67.3%	 loss: 2.957 acc@1: 35.62 mrr: 49.84, ndcg: 55.68, took: 0.68s
Epoch 9, 74.1%	 loss: 3.101 acc@1: 28.28 mrr: 44.88, ndcg: 51.68, took: 0.72s
Epoch 9, 80.8%	 loss: 3.057 acc@1: 33.75 mrr: 48.18, ndcg: 54.35, took: 0.71s
Epoch 9, 87.5%	 loss: 3.135 acc@1: 30.00 mrr: 45.69, ndcg: 51.91, took: 0.68s
Epoch 9, 94.3%	 loss: 3.012 acc@1: 33.59 mrr: 48.57, ndcg: 54.66, took: 0.68s
Validation loss = 4.42 acc@1 = 27.20 f1 = 17.61 mrr = 39.49, ndcg = 44.02
Validation loss decreased (4.500832 --> 4.424086). Saving model...
Current learning rate: 0.000088
==================================================
Epoch 10, 6.7%	 loss: 2.994 acc@1: 32.03 mrr: 47.94, ndcg: 54.34, took: 0.67s
Epoch 10, 13.5%	 loss: 2.983 acc@1: 33.44 mrr: 49.57, ndcg: 55.68, took: 0.72s
Epoch 10, 20.2%	 loss: 3.083 acc@1: 27.03 mrr: 44.13, ndcg: 51.14, took: 0.67s
Epoch 10, 26.9%	 loss: 2.972 acc@1: 32.81 mrr: 48.07, ndcg: 54.36, took: 0.69s
Epoch 10, 33.7%	 loss: 3.232 acc@1: 30.16 mrr: 44.97, ndcg: 50.90, took: 0.75s
Epoch 10, 40.4%	 loss: 2.957 acc@1: 32.03 mrr: 48.05, ndcg: 54.74, took: 0.68s
Epoch 10, 47.1%	 loss: 2.928 acc@1: 32.66 mrr: 48.72, ndcg: 54.94, took: 0.76s
Epoch 10, 53.9%	 loss: 3.002 acc@1: 32.19 mrr: 47.71, ndcg: 54.06, took: 0.74s
Epoch 10, 60.6%	 loss: 2.891 acc@1: 33.44 mrr: 49.86, ndcg: 56.16, took: 0.68s
Epoch 10, 67.3%	 loss: 3.086 acc@1: 31.41 mrr: 46.90, ndcg: 53.13, took: 0.70s
Epoch 10, 74.1%	 loss: 3.092 acc@1: 29.69 mrr: 45.61, ndcg: 51.87, took: 0.63s
Epoch 10, 80.8%	 loss: 3.042 acc@1: 29.69 mrr: 46.37, ndcg: 53.22, took: 0.67s
Epoch 10, 87.5%	 loss: 2.977 acc@1: 28.75 mrr: 45.90, ndcg: 52.91, took: 0.67s
Epoch 10, 94.3%	 loss: 2.996 acc@1: 32.03 mrr: 48.26, ndcg: 55.05, took: 0.67s
Validation loss = 4.44 acc@1 = 26.42 f1 = 16.94 mrr = 39.06, ndcg = 43.69
EarlyStopping counter: 1 out of 5
Current learning rate: 0.000088
==================================================
Epoch 11, 6.7%	 loss: 2.906 acc@1: 32.19 mrr: 48.94, ndcg: 55.85, took: 0.72s
Epoch 11, 13.5%	 loss: 2.975 acc@1: 27.81 mrr: 45.47, ndcg: 52.34, took: 0.69s
Epoch 11, 20.2%	 loss: 3.053 acc@1: 31.41 mrr: 46.70, ndcg: 52.83, took: 0.69s
Epoch 11, 26.9%	 loss: 3.007 acc@1: 31.88 mrr: 47.69, ndcg: 53.82, took: 0.69s
Epoch 11, 33.7%	 loss: 3.079 acc@1: 31.25 mrr: 46.22, ndcg: 52.75, took: 0.72s
Epoch 11, 40.4%	 loss: 2.972 acc@1: 31.88 mrr: 48.32, ndcg: 54.46, took: 0.69s
Epoch 11, 47.1%	 loss: 2.998 acc@1: 32.81 mrr: 47.56, ndcg: 53.79, took: 0.73s
Epoch 11, 53.9%	 loss: 2.871 acc@1: 32.81 mrr: 49.52, ndcg: 56.50, took: 0.66s
Epoch 11, 60.6%	 loss: 3.034 acc@1: 32.81 mrr: 48.04, ndcg: 54.12, took: 0.67s
Epoch 11, 67.3%	 loss: 2.785 acc@1: 34.22 mrr: 50.80, ndcg: 56.87, took: 0.68s
Epoch 11, 74.1%	 loss: 2.875 acc@1: 32.19 mrr: 48.68, ndcg: 54.68, took: 0.64s
Epoch 11, 80.8%	 loss: 3.051 acc@1: 31.41 mrr: 46.80, ndcg: 53.08, took: 0.67s
Epoch 11, 87.5%	 loss: 3.057 acc@1: 30.47 mrr: 46.69, ndcg: 52.73, took: 0.69s
Epoch 11, 94.3%	 loss: 2.905 acc@1: 32.19 mrr: 48.73, ndcg: 55.60, took: 0.67s
Validation loss = 4.45 acc@1 = 26.42 f1 = 17.52 mrr = 39.10, ndcg = 43.81
EarlyStopping counter: 2 out of 5
Current learning rate: 0.000088
==================================================
Epoch 12, 6.7%	 loss: 2.891 acc@1: 34.06 mrr: 49.67, ndcg: 55.78, took: 0.64s
Epoch 12, 13.5%	 loss: 2.857 acc@1: 36.09 mrr: 51.06, ndcg: 56.96, took: 0.61s
Epoch 12, 20.2%	 loss: 2.886 acc@1: 34.06 mrr: 49.94, ndcg: 56.41, took: 0.58s
Epoch 12, 26.9%	 loss: 2.923 acc@1: 33.12 mrr: 49.67, ndcg: 56.13, took: 0.62s
Epoch 12, 33.7%	 loss: 3.004 acc@1: 32.03 mrr: 46.89, ndcg: 52.91, took: 0.62s
Epoch 12, 40.4%	 loss: 2.903 acc@1: 34.38 mrr: 50.05, ndcg: 55.89, took: 0.63s
Epoch 12, 47.1%	 loss: 2.856 acc@1: 33.75 mrr: 50.00, ndcg: 56.79, took: 0.63s
Epoch 12, 53.9%	 loss: 2.935 acc@1: 32.81 mrr: 48.84, ndcg: 55.69, took: 0.71s
Epoch 12, 60.6%	 loss: 2.981 acc@1: 29.22 mrr: 46.87, ndcg: 53.74, took: 0.69s
Epoch 12, 67.3%	 loss: 2.983 acc@1: 30.78 mrr: 46.50, ndcg: 53.09, took: 0.65s
Epoch 12, 74.1%	 loss: 2.898 acc@1: 32.81 mrr: 48.16, ndcg: 54.58, took: 0.65s
Epoch 12, 80.8%	 loss: 2.988 acc@1: 31.25 mrr: 47.57, ndcg: 53.70, took: 0.63s
Epoch 12, 87.5%	 loss: 2.963 acc@1: 32.34 mrr: 47.87, ndcg: 54.07, took: 0.63s
Epoch 12, 94.3%	 loss: 2.979 acc@1: 33.59 mrr: 48.18, ndcg: 54.34, took: 0.67s
Validation loss = 4.46 acc@1 = 26.16 f1 = 17.37 mrr = 39.01, ndcg = 43.72
EarlyStopping counter: 3 out of 5
Current learning rate: 0.000088
==================================================
Epoch 13, 6.7%	 loss: 2.825 acc@1: 36.25 mrr: 51.07, ndcg: 57.52, took: 0.65s
Epoch 13, 13.5%	 loss: 2.916 acc@1: 33.59 mrr: 48.92, ndcg: 55.28, took: 0.66s
Epoch 13, 20.2%	 loss: 2.923 acc@1: 33.75 mrr: 49.20, ndcg: 55.50, took: 0.60s
Epoch 13, 26.9%	 loss: 2.804 acc@1: 34.38 mrr: 50.76, ndcg: 57.30, took: 0.66s
Epoch 13, 33.7%	 loss: 2.852 acc@1: 30.94 mrr: 47.67, ndcg: 54.43, took: 0.61s
Epoch 13, 40.4%	 loss: 2.905 acc@1: 29.06 mrr: 46.96, ndcg: 53.89, took: 0.61s
Epoch 13, 47.1%	 loss: 2.882 acc@1: 33.91 mrr: 49.93, ndcg: 56.58, took: 0.66s
Epoch 13, 53.9%	 loss: 2.876 acc@1: 31.88 mrr: 48.70, ndcg: 55.04, took: 0.67s
Epoch 13, 60.6%	 loss: 2.901 acc@1: 34.53 mrr: 49.61, ndcg: 55.62, took: 0.66s
Epoch 13, 67.3%	 loss: 2.784 acc@1: 32.97 mrr: 49.79, ndcg: 56.59, took: 0.71s
Epoch 13, 74.1%	 loss: 2.910 acc@1: 32.97 mrr: 48.71, ndcg: 54.74, took: 0.68s
Epoch 13, 80.8%	 loss: 3.082 acc@1: 29.69 mrr: 45.64, ndcg: 52.02, took: 0.66s
Epoch 13, 87.5%	 loss: 2.717 acc@1: 34.53 mrr: 51.23, ndcg: 58.00, took: 0.67s
Epoch 13, 94.3%	 loss: 3.019 acc@1: 30.00 mrr: 46.51, ndcg: 52.83, took: 0.67s
Validation loss = 4.48 acc@1 = 26.20 f1 = 17.63 mrr = 39.04, ndcg = 43.72
EarlyStopping counter: 4 out of 5
Current learning rate: 0.000088
==================================================
Epoch 14, 6.7%	 loss: 2.760 acc@1: 34.06 mrr: 50.97, ndcg: 57.48, took: 0.66s
Epoch 14, 13.5%	 loss: 2.828 acc@1: 34.69 mrr: 50.38, ndcg: 56.38, took: 0.71s
Epoch 14, 20.2%	 loss: 2.849 acc@1: 34.53 mrr: 50.27, ndcg: 56.33, took: 0.72s
Epoch 14, 26.9%	 loss: 2.848 acc@1: 31.25 mrr: 48.89, ndcg: 55.34, took: 0.75s
Epoch 14, 33.7%	 loss: 2.803 acc@1: 34.69 mrr: 50.22, ndcg: 56.99, took: 0.66s
Epoch 14, 40.4%	 loss: 2.852 acc@1: 33.59 mrr: 49.75, ndcg: 56.07, took: 0.71s
Epoch 14, 47.1%	 loss: 2.768 acc@1: 32.03 mrr: 49.77, ndcg: 56.98, took: 0.68s
Epoch 14, 53.9%	 loss: 2.856 acc@1: 31.09 mrr: 48.21, ndcg: 55.27, took: 0.72s
Epoch 14, 60.6%	 loss: 2.859 acc@1: 33.59 mrr: 48.92, ndcg: 55.58, took: 0.73s
Epoch 14, 67.3%	 loss: 2.960 acc@1: 31.41 mrr: 46.92, ndcg: 53.67, took: 0.75s
Epoch 14, 74.1%	 loss: 2.738 acc@1: 32.81 mrr: 49.97, ndcg: 57.04, took: 0.70s
Epoch 14, 80.8%	 loss: 3.016 acc@1: 31.72 mrr: 47.48, ndcg: 53.88, took: 0.77s
Epoch 14, 87.5%	 loss: 2.878 acc@1: 33.91 mrr: 49.62, ndcg: 56.00, took: 0.69s
Epoch 14, 94.3%	 loss: 2.990 acc@1: 30.00 mrr: 47.13, ndcg: 53.37, took: 0.68s
Validation loss = 4.49 acc@1 = 26.08 f1 = 17.37 mrr = 38.89, ndcg = 43.58
EarlyStopping counter: 5 out of 5
==================================================
Early stopping
Current learning rate: 0.000009
==================================================
Epoch 15, 6.7%	 loss: 2.989 acc@1: 31.56 mrr: 47.31, ndcg: 53.74, took: 0.74s
Epoch 15, 13.5%	 loss: 2.996 acc@1: 32.97 mrr: 48.29, ndcg: 54.30, took: 0.65s
Epoch 15, 20.2%	 loss: 3.029 acc@1: 33.12 mrr: 47.59, ndcg: 53.75, took: 0.66s
Epoch 15, 26.9%	 loss: 3.027 acc@1: 31.41 mrr: 47.22, ndcg: 53.64, took: 0.67s
Epoch 15, 33.7%	 loss: 2.946 acc@1: 33.44 mrr: 49.19, ndcg: 55.53, took: 0.68s
Epoch 15, 40.4%	 loss: 3.058 acc@1: 33.44 mrr: 47.68, ndcg: 53.73, took: 0.63s
Epoch 15, 47.1%	 loss: 2.986 acc@1: 31.88 mrr: 47.56, ndcg: 53.80, took: 0.70s
Epoch 15, 53.9%	 loss: 3.173 acc@1: 29.38 mrr: 44.40, ndcg: 50.72, took: 0.68s
Epoch 15, 60.6%	 loss: 3.003 acc@1: 30.31 mrr: 46.88, ndcg: 53.99, took: 0.74s
Epoch 15, 67.3%	 loss: 2.925 acc@1: 31.09 mrr: 48.25, ndcg: 55.20, took: 0.76s
Epoch 15, 74.1%	 loss: 2.951 acc@1: 31.72 mrr: 48.54, ndcg: 54.66, took: 0.72s
Epoch 15, 80.8%	 loss: 3.030 acc@1: 33.12 mrr: 47.96, ndcg: 53.85, took: 0.68s
Epoch 15, 87.5%	 loss: 3.081 acc@1: 31.88 mrr: 46.93, ndcg: 52.99, took: 0.72s
Epoch 15, 94.3%	 loss: 3.094 acc@1: 29.84 mrr: 45.54, ndcg: 51.63, took: 0.71s
Validation loss = 4.43 acc@1 = 26.87 f1 = 17.39 mrr = 39.32, ndcg = 43.91
EarlyStopping counter: 1 out of 5
Current learning rate: 0.000009
==================================================
Epoch 16, 6.7%	 loss: 3.062 acc@1: 29.84 mrr: 45.47, ndcg: 51.90, took: 0.72s
Epoch 16, 13.5%	 loss: 3.160 acc@1: 32.03 mrr: 45.92, ndcg: 51.23, took: 0.72s
Epoch 16, 20.2%	 loss: 3.027 acc@1: 28.91 mrr: 45.98, ndcg: 52.73, took: 0.69s
Epoch 16, 26.9%	 loss: 3.052 acc@1: 30.00 mrr: 46.06, ndcg: 52.56, took: 0.69s
Epoch 16, 33.7%	 loss: 3.063 acc@1: 32.97 mrr: 47.63, ndcg: 53.45, took: 0.73s
Epoch 16, 40.4%	 loss: 2.920 acc@1: 33.59 mrr: 48.98, ndcg: 55.18, took: 0.68s
Epoch 16, 47.1%	 loss: 3.012 acc@1: 33.59 mrr: 48.95, ndcg: 54.80, took: 0.72s
Epoch 16, 53.9%	 loss: 2.878 acc@1: 33.75 mrr: 49.62, ndcg: 55.57, took: 0.68s
Epoch 16, 60.6%	 loss: 2.953 acc@1: 31.41 mrr: 48.30, ndcg: 54.72, took: 0.66s
Epoch 16, 67.3%	 loss: 2.868 acc@1: 35.94 mrr: 51.30, ndcg: 57.47, took: 0.68s
Epoch 16, 74.1%	 loss: 2.911 acc@1: 31.41 mrr: 47.92, ndcg: 54.40, took: 0.69s
Epoch 16, 80.8%	 loss: 3.142 acc@1: 29.84 mrr: 45.33, ndcg: 51.60, took: 0.69s
Epoch 16, 87.5%	 loss: 3.011 acc@1: 33.12 mrr: 48.45, ndcg: 54.59, took: 0.74s
Epoch 16, 94.3%	 loss: 3.005 acc@1: 32.50 mrr: 47.76, ndcg: 54.39, took: 0.72s
Validation loss = 4.44 acc@1 = 26.80 f1 = 17.59 mrr = 39.32, ndcg = 43.90
EarlyStopping counter: 2 out of 5
Current learning rate: 0.000009
==================================================
Epoch 17, 6.7%	 loss: 3.071 acc@1: 28.12 mrr: 44.76, ndcg: 51.75, took: 0.70s
Epoch 17, 13.5%	 loss: 2.982 acc@1: 33.59 mrr: 48.27, ndcg: 54.47, took: 0.67s
Epoch 17, 20.2%	 loss: 2.888 acc@1: 32.66 mrr: 49.07, ndcg: 55.64, took: 0.69s
Epoch 17, 26.9%	 loss: 3.129 acc@1: 29.53 mrr: 45.44, ndcg: 51.42, took: 0.71s
Epoch 17, 33.7%	 loss: 3.113 acc@1: 28.59 mrr: 44.25, ndcg: 50.52, took: 0.71s
Epoch 17, 40.4%	 loss: 2.892 acc@1: 33.59 mrr: 49.74, ndcg: 55.93, took: 0.74s
Epoch 17, 47.1%	 loss: 3.013 acc@1: 32.03 mrr: 47.82, ndcg: 54.14, took: 0.65s
Epoch 17, 53.9%	 loss: 2.925 acc@1: 33.91 mrr: 49.83, ndcg: 55.81, took: 0.65s
Epoch 17, 60.6%	 loss: 2.932 acc@1: 32.50 mrr: 48.68, ndcg: 55.19, took: 0.71s
Epoch 17, 67.3%	 loss: 2.795 acc@1: 34.53 mrr: 50.36, ndcg: 57.07, took: 0.67s
Epoch 17, 74.1%	 loss: 3.093 acc@1: 31.88 mrr: 46.95, ndcg: 52.70, took: 0.71s
Epoch 17, 80.8%	 loss: 3.016 acc@1: 32.19 mrr: 47.74, ndcg: 54.35, took: 0.75s
Epoch 17, 87.5%	 loss: 3.030 acc@1: 32.81 mrr: 48.09, ndcg: 53.94, took: 0.73s
Epoch 17, 94.3%	 loss: 3.083 acc@1: 33.28 mrr: 47.88, ndcg: 53.56, took: 0.67s
Validation loss = 4.44 acc@1 = 26.63 f1 = 17.39 mrr = 39.19, ndcg = 43.78
EarlyStopping counter: 3 out of 5
Current learning rate: 0.000009
==================================================
Epoch 18, 6.7%	 loss: 2.949 acc@1: 32.97 mrr: 48.76, ndcg: 55.12, took: 0.70s
Epoch 18, 13.5%	 loss: 3.023 acc@1: 31.25 mrr: 46.98, ndcg: 53.19, took: 0.68s
Epoch 18, 20.2%	 loss: 2.942 acc@1: 32.66 mrr: 48.30, ndcg: 54.23, took: 0.66s
Epoch 18, 26.9%	 loss: 3.007 acc@1: 31.41 mrr: 47.31, ndcg: 54.24, took: 0.68s
Epoch 18, 33.7%	 loss: 3.097 acc@1: 30.00 mrr: 45.93, ndcg: 51.94, took: 0.69s
Epoch 18, 40.4%	 loss: 2.885 acc@1: 33.12 mrr: 49.38, ndcg: 56.19, took: 0.68s
Epoch 18, 47.1%	 loss: 3.276 acc@1: 29.22 mrr: 43.97, ndcg: 49.47, took: 0.70s
Epoch 18, 53.9%	 loss: 3.016 acc@1: 33.59 mrr: 48.27, ndcg: 53.93, took: 0.64s
Epoch 18, 60.6%	 loss: 3.105 acc@1: 33.28 mrr: 47.89, ndcg: 53.31, took: 0.65s
Epoch 18, 67.3%	 loss: 2.919 acc@1: 33.59 mrr: 49.50, ndcg: 55.68, took: 0.69s
Epoch 18, 74.1%	 loss: 2.842 acc@1: 35.47 mrr: 50.90, ndcg: 57.52, took: 0.74s
Epoch 18, 80.8%	 loss: 2.990 acc@1: 33.12 mrr: 48.23, ndcg: 54.29, took: 0.71s
Epoch 18, 87.5%	 loss: 2.942 acc@1: 32.97 mrr: 49.06, ndcg: 55.37, took: 0.69s
Epoch 18, 94.3%	 loss: 2.967 acc@1: 30.78 mrr: 46.66, ndcg: 53.40, took: 0.71s
Validation loss = 4.44 acc@1 = 26.68 f1 = 17.27 mrr = 39.24, ndcg = 43.80
EarlyStopping counter: 4 out of 5
Current learning rate: 0.000009
==================================================
Epoch 19, 6.7%	 loss: 3.032 acc@1: 31.72 mrr: 47.60, ndcg: 53.58, took: 0.70s
Epoch 19, 13.5%	 loss: 3.038 acc@1: 29.53 mrr: 46.52, ndcg: 53.29, took: 0.71s
Epoch 19, 20.2%	 loss: 2.891 acc@1: 33.59 mrr: 49.09, ndcg: 55.79, took: 0.72s
Epoch 19, 26.9%	 loss: 2.804 acc@1: 34.69 mrr: 50.77, ndcg: 57.23, took: 0.68s
Epoch 19, 33.7%	 loss: 2.974 acc@1: 32.50 mrr: 47.83, ndcg: 54.28, took: 0.68s
Epoch 19, 40.4%	 loss: 3.171 acc@1: 27.66 mrr: 43.95, ndcg: 50.29, took: 0.75s
Epoch 19, 47.1%	 loss: 2.983 acc@1: 32.97 mrr: 48.20, ndcg: 54.54, took: 0.70s
Epoch 19, 53.9%	 loss: 2.946 acc@1: 31.88 mrr: 47.69, ndcg: 54.31, took: 0.66s
Epoch 19, 60.6%	 loss: 2.985 acc@1: 29.69 mrr: 46.56, ndcg: 53.23, took: 0.72s
Epoch 19, 67.3%	 loss: 2.983 acc@1: 31.41 mrr: 47.96, ndcg: 54.56, took: 0.63s
Epoch 19, 74.1%	 loss: 2.833 acc@1: 34.69 mrr: 50.37, ndcg: 56.40, took: 0.70s
Epoch 19, 80.8%	 loss: 3.016 acc@1: 34.38 mrr: 49.36, ndcg: 55.42, took: 0.72s
Epoch 19, 87.5%	 loss: 3.110 acc@1: 30.16 mrr: 45.82, ndcg: 51.78, took: 0.74s
Epoch 19, 94.3%	 loss: 3.014 acc@1: 32.19 mrr: 47.89, ndcg: 53.98, took: 0.67s
Validation loss = 4.45 acc@1 = 26.49 f1 = 17.35 mrr = 39.12, ndcg = 43.75
EarlyStopping counter: 5 out of 5
==================================================
Early stopping
Training finished.	 Time: 245.86s.	 acc@1: 27.20%
Test acc@1 = 24.47 f1 = 14.94 mrr = 35.19 ndcg = 39.10
Test Results:
  acc@1: 24.47%
  acc@5: 47.62%
  acc@10: 53.76%
  mrr: 35.19%
  ndcg: 39.10%
  f1: 14.94%


Results saved to: experiments/geolife_LSTM_20260107_104427
Test Acc@1: 24.47%
