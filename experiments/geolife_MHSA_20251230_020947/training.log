Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/config/ht_grid_search/MHSA_geolife_prev3_emb32_h2_l2_ff256_lr0.0005.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=224, val=104, test=109
Total trainable parameters: 129187

=== Epoch 1 ===
Epoch 1, 8.9%	 loss: 7.083 acc@1: 0.00 mrr: 0.63, ndcg: 0.35, took: 1.14s
Epoch 1, 17.9%	 loss: 7.112 acc@1: 0.00 mrr: 0.70, ndcg: 0.46, took: 0.46s
Epoch 1, 26.8%	 loss: 7.096 acc@1: 0.16 mrr: 0.71, ndcg: 0.31, took: 0.47s
Epoch 1, 35.7%	 loss: 7.082 acc@1: 0.62 mrr: 1.27, ndcg: 0.97, took: 0.46s
Epoch 1, 44.6%	 loss: 7.082 acc@1: 0.16 mrr: 0.68, ndcg: 0.40, took: 0.45s
Epoch 1, 53.6%	 loss: 7.090 acc@1: 0.16 mrr: 0.80, ndcg: 0.41, took: 0.46s
Epoch 1, 62.5%	 loss: 7.092 acc@1: 0.00 mrr: 0.73, ndcg: 0.39, took: 0.48s
Epoch 1, 71.4%	 loss: 7.081 acc@1: 0.16 mrr: 1.00, ndcg: 0.81, took: 0.49s
Epoch 1, 80.4%	 loss: 7.056 acc@1: 0.00 mrr: 1.26, ndcg: 1.28, took: 0.42s
Epoch 1, 89.3%	 loss: 7.047 acc@1: 0.62 mrr: 1.70, ndcg: 1.74, took: 0.43s
Epoch 1, 98.2%	 loss: 7.036 acc@1: 0.31 mrr: 1.80, ndcg: 1.66, took: 0.44s
Validation - loss: 7.0463, acc@1: 0.39%, f1: 0.72%, mrr: 1.89%, ndcg: 1.88%
Current learning rate: 0.000250

=== Epoch 2 ===
Epoch 2, 8.9%	 loss: 7.008 acc@1: 1.41 mrr: 3.01, ndcg: 3.12, took: 0.46s
Epoch 2, 17.9%	 loss: 6.972 acc@1: 1.88 mrr: 4.14, ndcg: 4.41, took: 0.50s
Epoch 2, 26.8%	 loss: 6.960 acc@1: 3.28 mrr: 5.55, ndcg: 5.83, took: 0.46s
Epoch 2, 35.7%	 loss: 6.909 acc@1: 6.88 mrr: 9.85, ndcg: 10.33, took: 0.52s
Epoch 2, 44.6%	 loss: 6.890 acc@1: 8.75 mrr: 11.40, ndcg: 11.80, took: 0.48s
Epoch 2, 53.6%	 loss: 6.802 acc@1: 12.50 mrr: 15.62, ndcg: 16.29, took: 0.48s
Epoch 2, 62.5%	 loss: 6.762 acc@1: 11.72 mrr: 15.30, ndcg: 16.20, took: 0.57s
Epoch 2, 71.4%	 loss: 6.682 acc@1: 13.59 mrr: 18.21, ndcg: 19.29, took: 0.48s
Epoch 2, 80.4%	 loss: 6.551 acc@1: 15.94 mrr: 22.04, ndcg: 24.13, took: 0.49s
Epoch 2, 89.3%	 loss: 6.486 acc@1: 13.59 mrr: 20.80, ndcg: 23.34, took: 0.47s
Epoch 2, 98.2%	 loss: 6.375 acc@1: 16.41 mrr: 22.41, ndcg: 24.83, took: 0.46s
Validation - loss: 6.2814, acc@1: 15.36%, f1: 8.66%, mrr: 24.46%, ndcg: 28.01%
Current learning rate: 0.000000

=== Test Results ===
Test Results:
  acc@1: 13.50%
  acc@5: 31.75%
  acc@10: 35.02%
  mrr: 20.94%
  ndcg: 23.98%
  f1: 5.83%

=== Training Complete ===
