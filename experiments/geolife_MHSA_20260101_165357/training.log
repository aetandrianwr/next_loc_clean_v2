Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/scripts/sci_hyperparam_tuning/configs/mhsa_geolife_trial06.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=116, val=53, test=55
Total trainable parameters: 221443

=== Epoch 1 ===
Epoch 1, 17.2%	 loss: 7.110 acc@1: 0.16 mrr: 0.79, ndcg: 0.51, took: 2.34s
Epoch 1, 34.5%	 loss: 7.095 acc@1: 0.08 mrr: 0.84, ndcg: 0.61, took: 1.11s
Epoch 1, 51.7%	 loss: 7.049 acc@1: 0.55 mrr: 1.73, ndcg: 1.56, took: 1.17s
Epoch 1, 69.0%	 loss: 6.994 acc@1: 1.80 mrr: 3.74, ndcg: 4.06, took: 1.21s
Epoch 1, 86.2%	 loss: 6.818 acc@1: 10.62 mrr: 14.77, ndcg: 15.68, took: 1.30s
Validation - loss: 6.3907, acc@1: 17.97%, f1: 11.33%, mrr: 26.30%, ndcg: 28.93%
Current learning rate: 0.001000

=== Epoch 2 ===
Epoch 2, 17.2%	 loss: 6.205 acc@1: 18.05 mrr: 26.59, ndcg: 29.31, took: 1.23s
Epoch 2, 34.5%	 loss: 5.657 acc@1: 20.55 mrr: 30.37, ndcg: 34.17, took: 1.17s
Epoch 2, 51.7%	 loss: 5.331 acc@1: 21.72 mrr: 31.90, ndcg: 36.38, took: 1.18s
Epoch 2, 69.0%	 loss: 5.013 acc@1: 22.73 mrr: 33.37, ndcg: 37.82, took: 1.21s
Epoch 2, 86.2%	 loss: 4.799 acc@1: 23.28 mrr: 34.58, ndcg: 39.62, took: 1.15s
Validation - loss: 4.7630, acc@1: 22.02%, f1: 12.23%, mrr: 33.99%, ndcg: 38.95%
Current learning rate: 0.002000

=== Epoch 3 ===
Epoch 3, 17.2%	 loss: 4.242 acc@1: 26.41 mrr: 39.28, ndcg: 44.47, took: 1.18s
Epoch 3, 34.5%	 loss: 4.119 acc@1: 29.22 mrr: 41.02, ndcg: 45.12, took: 1.19s
Epoch 3, 51.7%	 loss: 3.869 acc@1: 32.11 mrr: 44.04, ndcg: 48.58, took: 1.26s
Epoch 3, 69.0%	 loss: 3.818 acc@1: 31.80 mrr: 44.34, ndcg: 49.01, took: 1.18s
Epoch 3, 86.2%	 loss: 3.620 acc@1: 33.59 mrr: 46.92, ndcg: 51.92, took: 1.15s
Validation - loss: 4.3659, acc@1: 34.58%, f1: 19.92%, mrr: 45.72%, ndcg: 49.37%
Current learning rate: 0.001958

=== Epoch 4 ===
Epoch 4, 17.2%	 loss: 3.481 acc@1: 32.81 mrr: 46.92, ndcg: 51.82, took: 1.18s
Epoch 4, 34.5%	 loss: 3.346 acc@1: 34.69 mrr: 49.08, ndcg: 53.97, took: 1.00s
Epoch 4, 51.7%	 loss: 3.487 acc@1: 33.67 mrr: 47.58, ndcg: 52.22, took: 1.02s
Epoch 4, 69.0%	 loss: 3.430 acc@1: 36.33 mrr: 49.47, ndcg: 53.87, took: 0.99s
Epoch 4, 86.2%	 loss: 3.310 acc@1: 36.02 mrr: 49.86, ndcg: 54.93, took: 1.03s
Validation - loss: 4.4076, acc@1: 36.89%, f1: 24.73%, mrr: 47.93%, ndcg: 51.85%
Current learning rate: 0.001917

=== Epoch 5 ===
Epoch 5, 17.2%	 loss: 3.101 acc@1: 38.44 mrr: 52.22, ndcg: 56.80, took: 1.03s
Epoch 5, 34.5%	 loss: 3.138 acc@1: 37.34 mrr: 51.04, ndcg: 55.50, took: 1.03s
Epoch 5, 51.7%	 loss: 3.119 acc@1: 36.56 mrr: 50.80, ndcg: 55.81, took: 1.00s
Epoch 5, 69.0%	 loss: 3.085 acc@1: 37.73 mrr: 51.78, ndcg: 56.40, took: 0.96s
Epoch 5, 86.2%	 loss: 3.040 acc@1: 37.89 mrr: 52.32, ndcg: 57.25, took: 0.95s
Validation - loss: 4.4109, acc@1: 36.74%, f1: 25.83%, mrr: 48.36%, ndcg: 52.38%
Current learning rate: 0.001875

=== Epoch 6 ===
Epoch 6, 17.2%	 loss: 2.770 acc@1: 42.66 mrr: 55.79, ndcg: 60.43, took: 0.96s
Epoch 6, 34.5%	 loss: 2.976 acc@1: 39.38 mrr: 52.62, ndcg: 56.89, took: 0.96s
Epoch 6, 51.7%	 loss: 2.815 acc@1: 40.78 mrr: 54.76, ndcg: 59.74, took: 0.91s
Epoch 6, 69.0%	 loss: 2.927 acc@1: 38.28 mrr: 52.52, ndcg: 57.40, took: 1.16s
Epoch 6, 86.2%	 loss: 2.900 acc@1: 38.91 mrr: 53.49, ndcg: 58.39, took: 1.01s
Validation - loss: 4.4558, acc@1: 39.98%, f1: 30.70%, mrr: 50.34%, ndcg: 54.04%
Current learning rate: 0.001833

=== Epoch 7 ===
Epoch 7, 17.2%	 loss: 2.612 acc@1: 42.97 mrr: 56.97, ndcg: 62.01, took: 1.09s
Epoch 7, 34.5%	 loss: 2.711 acc@1: 43.12 mrr: 56.00, ndcg: 60.38, took: 0.98s
Epoch 7, 51.7%	 loss: 2.537 acc@1: 46.17 mrr: 59.21, ndcg: 63.84, took: 0.87s
Epoch 7, 69.0%	 loss: 2.711 acc@1: 42.89 mrr: 56.09, ndcg: 60.59, took: 0.89s
Epoch 7, 86.2%	 loss: 2.699 acc@1: 45.31 mrr: 57.58, ndcg: 61.93, took: 0.94s
Validation - loss: 4.4739, acc@1: 39.35%, f1: 30.68%, mrr: 50.32%, ndcg: 54.14%
Current learning rate: 0.001792

=== Epoch 8 ===
Epoch 8, 17.2%	 loss: 2.375 acc@1: 48.44 mrr: 61.07, ndcg: 65.44, took: 0.94s
Epoch 8, 34.5%	 loss: 2.505 acc@1: 46.64 mrr: 59.06, ndcg: 63.61, took: 0.99s
Epoch 8, 51.7%	 loss: 2.407 acc@1: 46.56 mrr: 59.68, ndcg: 64.32, took: 0.88s
Epoch 8, 69.0%	 loss: 2.460 acc@1: 45.31 mrr: 59.29, ndcg: 64.29, took: 0.88s
Epoch 8, 86.2%	 loss: 2.582 acc@1: 44.38 mrr: 57.31, ndcg: 61.90, took: 0.93s
Validation - loss: 4.6007, acc@1: 40.25%, f1: 31.83%, mrr: 50.92%, ndcg: 54.57%
Current learning rate: 0.000175

=== Epoch 9 ===
Epoch 9, 17.2%	 loss: 3.552 acc@1: 32.66 mrr: 46.46, ndcg: 50.81, took: 0.94s
Epoch 9, 34.5%	 loss: 3.406 acc@1: 35.31 mrr: 48.81, ndcg: 53.17, took: 1.04s
Epoch 9, 51.7%	 loss: 3.320 acc@1: 36.17 mrr: 50.02, ndcg: 54.58, took: 0.88s
Epoch 9, 69.0%	 loss: 3.484 acc@1: 33.28 mrr: 47.42, ndcg: 52.18, took: 0.98s
Epoch 9, 86.2%	 loss: 3.411 acc@1: 35.39 mrr: 48.81, ndcg: 53.38, took: 0.88s
Validation - loss: 4.3562, acc@1: 35.42%, f1: 22.47%, mrr: 46.56%, ndcg: 50.39%
Current learning rate: 0.000175

=== Epoch 10 ===
Epoch 10, 17.2%	 loss: 3.414 acc@1: 35.94 mrr: 49.28, ndcg: 53.82, took: 0.97s
Epoch 10, 34.5%	 loss: 3.374 acc@1: 37.42 mrr: 50.19, ndcg: 54.38, took: 0.98s
Epoch 10, 51.7%	 loss: 3.356 acc@1: 37.19 mrr: 50.37, ndcg: 54.41, took: 0.90s
Epoch 10, 69.0%	 loss: 3.345 acc@1: 36.02 mrr: 49.30, ndcg: 53.89, took: 1.02s
Epoch 10, 86.2%	 loss: 3.334 acc@1: 35.00 mrr: 49.06, ndcg: 53.52, took: 0.98s
Validation - loss: 4.3440, acc@1: 35.69%, f1: 22.65%, mrr: 46.93%, ndcg: 50.85%
Current learning rate: 0.000175

=== Epoch 11 ===
Epoch 11, 17.2%	 loss: 3.237 acc@1: 36.33 mrr: 50.34, ndcg: 54.80, took: 0.89s
Epoch 11, 34.5%	 loss: 3.278 acc@1: 37.27 mrr: 50.15, ndcg: 54.42, took: 0.94s
Epoch 11, 51.7%	 loss: 3.239 acc@1: 36.80 mrr: 50.87, ndcg: 55.30, took: 0.93s
Epoch 11, 69.0%	 loss: 3.309 acc@1: 36.09 mrr: 49.91, ndcg: 54.32, took: 0.89s
Epoch 11, 86.2%	 loss: 3.346 acc@1: 36.95 mrr: 49.56, ndcg: 53.96, took: 0.93s
Validation - loss: 4.3467, acc@1: 35.93%, f1: 22.85%, mrr: 47.27%, ndcg: 51.16%
Current learning rate: 0.000175

=== Epoch 12 ===
Epoch 12, 17.2%	 loss: 3.241 acc@1: 36.17 mrr: 50.14, ndcg: 54.72, took: 0.92s
Epoch 12, 34.5%	 loss: 3.226 acc@1: 37.81 mrr: 51.30, ndcg: 55.64, took: 0.99s
Epoch 12, 51.7%	 loss: 3.396 acc@1: 33.67 mrr: 47.58, ndcg: 52.06, took: 1.06s
Epoch 12, 69.0%	 loss: 3.191 acc@1: 38.36 mrr: 51.84, ndcg: 56.26, took: 0.90s
Epoch 12, 86.2%	 loss: 3.291 acc@1: 37.42 mrr: 50.40, ndcg: 54.66, took: 0.97s
Validation - loss: 4.3542, acc@1: 36.32%, f1: 23.66%, mrr: 47.37%, ndcg: 51.26%
Current learning rate: 0.000175

=== Epoch 13 ===
Epoch 13, 17.2%	 loss: 3.177 acc@1: 38.05 mrr: 51.48, ndcg: 55.90, took: 1.02s
Epoch 13, 34.5%	 loss: 3.283 acc@1: 36.02 mrr: 49.42, ndcg: 53.85, took: 1.05s
Epoch 13, 51.7%	 loss: 3.236 acc@1: 38.05 mrr: 51.24, ndcg: 55.41, took: 1.07s
Epoch 13, 69.0%	 loss: 3.194 acc@1: 36.56 mrr: 50.43, ndcg: 54.88, took: 0.93s
Epoch 13, 86.2%	 loss: 3.214 acc@1: 37.11 mrr: 51.20, ndcg: 55.53, took: 1.02s
Validation - loss: 4.3633, acc@1: 36.56%, f1: 24.20%, mrr: 47.68%, ndcg: 51.56%
Current learning rate: 0.000175

=== Epoch 14 ===
Epoch 14, 17.2%	 loss: 3.216 acc@1: 38.67 mrr: 51.39, ndcg: 55.52, took: 0.96s
Epoch 14, 34.5%	 loss: 3.232 acc@1: 36.48 mrr: 50.21, ndcg: 54.65, took: 0.99s
Epoch 14, 51.7%	 loss: 3.117 acc@1: 38.91 mrr: 52.71, ndcg: 57.06, took: 0.94s
Epoch 14, 69.0%	 loss: 3.178 acc@1: 37.89 mrr: 51.14, ndcg: 55.46, took: 0.95s
Epoch 14, 86.2%	 loss: 3.147 acc@1: 36.56 mrr: 50.49, ndcg: 55.17, took: 1.03s
Validation - loss: 4.3665, acc@1: 36.62%, f1: 24.04%, mrr: 47.71%, ndcg: 51.60%
Current learning rate: 0.000175

=== Epoch 15 ===
Epoch 15, 17.2%	 loss: 3.102 acc@1: 38.91 mrr: 52.09, ndcg: 56.45, took: 0.97s
Epoch 15, 34.5%	 loss: 3.106 acc@1: 38.59 mrr: 51.94, ndcg: 56.30, took: 0.88s
Epoch 15, 51.7%	 loss: 3.158 acc@1: 38.52 mrr: 51.93, ndcg: 56.15, took: 0.90s
Epoch 15, 69.0%	 loss: 3.124 acc@1: 38.20 mrr: 51.97, ndcg: 56.42, took: 0.94s
Epoch 15, 86.2%	 loss: 3.285 acc@1: 35.23 mrr: 49.00, ndcg: 53.36, took: 0.94s
Validation - loss: 4.3697, acc@1: 36.65%, f1: 23.98%, mrr: 47.88%, ndcg: 51.75%
Current learning rate: 0.000018

=== Epoch 16 ===
Epoch 16, 17.2%	 loss: 3.351 acc@1: 35.94 mrr: 49.15, ndcg: 53.42, took: 1.06s
Epoch 16, 34.5%	 loss: 3.249 acc@1: 36.64 mrr: 50.68, ndcg: 55.32, took: 0.99s
Epoch 16, 51.7%	 loss: 3.224 acc@1: 35.23 mrr: 49.85, ndcg: 54.65, took: 1.04s
Epoch 16, 69.0%	 loss: 3.374 acc@1: 35.94 mrr: 49.27, ndcg: 53.53, took: 1.07s
Epoch 16, 86.2%	 loss: 3.301 acc@1: 37.27 mrr: 50.26, ndcg: 54.52, took: 1.04s
Validation - loss: 4.3395, acc@1: 35.81%, f1: 23.00%, mrr: 47.01%, ndcg: 50.82%
Current learning rate: 0.000018

=== Epoch 17 ===
Epoch 17, 17.2%	 loss: 3.307 acc@1: 37.34 mrr: 50.51, ndcg: 54.68, took: 0.99s
Epoch 17, 34.5%	 loss: 3.254 acc@1: 38.75 mrr: 51.59, ndcg: 55.79, took: 1.01s
Epoch 17, 51.7%	 loss: 3.244 acc@1: 37.03 mrr: 50.40, ndcg: 54.79, took: 1.04s
Epoch 17, 69.0%	 loss: 3.224 acc@1: 36.95 mrr: 50.92, ndcg: 55.67, took: 1.08s
Epoch 17, 86.2%	 loss: 3.374 acc@1: 34.92 mrr: 48.63, ndcg: 53.14, took: 0.96s
Validation - loss: 4.3520, acc@1: 35.84%, f1: 23.00%, mrr: 47.00%, ndcg: 50.87%
Current learning rate: 0.000018

=== Epoch 18 ===
Epoch 18, 17.2%	 loss: 3.265 acc@1: 37.66 mrr: 50.65, ndcg: 54.74, took: 1.00s
Epoch 18, 34.5%	 loss: 3.354 acc@1: 36.09 mrr: 49.46, ndcg: 53.71, took: 0.96s
Epoch 18, 51.7%	 loss: 3.295 acc@1: 36.80 mrr: 50.08, ndcg: 54.48, took: 0.99s
Epoch 18, 69.0%	 loss: 3.297 acc@1: 37.27 mrr: 50.52, ndcg: 54.77, took: 1.04s
Epoch 18, 86.2%	 loss: 3.251 acc@1: 36.72 mrr: 50.50, ndcg: 55.04, took: 1.06s
Validation - loss: 4.3489, acc@1: 35.81%, f1: 23.06%, mrr: 47.01%, ndcg: 50.86%
Current learning rate: 0.000018

=== Epoch 19 ===
Epoch 19, 17.2%	 loss: 3.340 acc@1: 33.52 mrr: 48.28, ndcg: 53.16, took: 0.98s
Epoch 19, 34.5%	 loss: 3.265 acc@1: 37.19 mrr: 50.67, ndcg: 54.88, took: 1.05s
Epoch 19, 51.7%	 loss: 3.252 acc@1: 37.58 mrr: 51.06, ndcg: 55.46, took: 1.00s
Epoch 19, 69.0%	 loss: 3.284 acc@1: 37.19 mrr: 50.43, ndcg: 54.62, took: 0.86s
Epoch 19, 86.2%	 loss: 3.302 acc@1: 35.70 mrr: 49.58, ndcg: 54.06, took: 0.83s
Validation - loss: 4.3421, acc@1: 35.96%, f1: 23.23%, mrr: 47.14%, ndcg: 51.02%
Current learning rate: 0.000018

=== Epoch 20 ===
Epoch 20, 17.2%	 loss: 3.306 acc@1: 36.64 mrr: 50.01, ndcg: 54.32, took: 0.82s
Epoch 20, 34.5%	 loss: 3.278 acc@1: 37.81 mrr: 51.04, ndcg: 55.22, took: 0.81s
Epoch 20, 51.7%	 loss: 3.330 acc@1: 34.84 mrr: 48.93, ndcg: 53.60, took: 0.80s
Epoch 20, 69.0%	 loss: 3.249 acc@1: 38.20 mrr: 51.53, ndcg: 55.97, took: 0.85s
Epoch 20, 86.2%	 loss: 3.338 acc@1: 35.23 mrr: 49.12, ndcg: 53.53, took: 0.86s
Validation - loss: 4.3449, acc@1: 35.84%, f1: 23.15%, mrr: 47.10%, ndcg: 50.99%
Current learning rate: 0.000018

=== Epoch 21 ===
Epoch 21, 17.2%	 loss: 3.275 acc@1: 36.72 mrr: 50.28, ndcg: 54.81, took: 0.94s
Epoch 21, 34.5%	 loss: 3.382 acc@1: 35.00 mrr: 48.42, ndcg: 52.89, took: 1.00s
Epoch 21, 51.7%	 loss: 3.334 acc@1: 34.77 mrr: 48.93, ndcg: 53.61, took: 0.95s
Epoch 21, 69.0%	 loss: 3.235 acc@1: 37.81 mrr: 51.08, ndcg: 55.32, took: 1.07s
Epoch 21, 86.2%	 loss: 3.190 acc@1: 38.59 mrr: 51.83, ndcg: 55.99, took: 1.02s
Validation - loss: 4.3470, acc@1: 35.84%, f1: 23.12%, mrr: 47.08%, ndcg: 50.96%
Training finished.	 Time: 152.68s.	 acc@1: 35.81%

=== Test Results ===
Test Results:
  acc@1: 30.44%
  acc@5: 51.40%
  acc@10: 56.23%
  mrr: 40.03%
  ndcg: 43.66%
  f1: 19.09%

=== Training Complete ===
