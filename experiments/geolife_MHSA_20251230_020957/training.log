Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/config/ht_grid_search/MHSA_geolife_prev3_emb32_h2_l2_ff128_lr0.002.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=224, val=104, test=109
Total trainable parameters: 112547

=== Epoch 1 ===
Epoch 1, 8.9%	 loss: 7.115 acc@1: 0.00 mrr: 0.66, ndcg: 0.41, took: 1.20s
Epoch 1, 17.9%	 loss: 7.113 acc@1: 0.16 mrr: 0.82, ndcg: 0.57, took: 0.47s
Epoch 1, 26.8%	 loss: 7.094 acc@1: 0.16 mrr: 0.86, ndcg: 0.63, took: 0.46s
Epoch 1, 35.7%	 loss: 7.061 acc@1: 0.16 mrr: 1.09, ndcg: 0.95, took: 0.46s
Epoch 1, 44.6%	 loss: 7.041 acc@1: 0.16 mrr: 1.45, ndcg: 1.24, took: 0.46s
Epoch 1, 53.6%	 loss: 7.034 acc@1: 0.94 mrr: 2.57, ndcg: 2.61, took: 0.45s
Epoch 1, 62.5%	 loss: 7.013 acc@1: 0.94 mrr: 2.82, ndcg: 2.90, took: 0.48s
Epoch 1, 71.4%	 loss: 6.979 acc@1: 3.12 mrr: 5.38, ndcg: 5.52, took: 0.56s
Epoch 1, 80.4%	 loss: 6.891 acc@1: 5.31 mrr: 8.80, ndcg: 9.78, took: 0.49s
Epoch 1, 89.3%	 loss: 6.839 acc@1: 8.44 mrr: 12.77, ndcg: 13.95, took: 0.46s
Epoch 1, 98.2%	 loss: 6.688 acc@1: 13.12 mrr: 19.02, ndcg: 21.03, took: 0.42s
Validation - loss: 6.5228, acc@1: 16.14%, f1: 8.04%, mrr: 25.18%, ndcg: 28.55%
Current learning rate: 0.001000

=== Epoch 2 ===
Epoch 2, 8.9%	 loss: 6.464 acc@1: 13.44 mrr: 22.90, ndcg: 26.40, took: 0.42s
Epoch 2, 17.9%	 loss: 6.112 acc@1: 18.59 mrr: 28.73, ndcg: 32.50, took: 0.39s
Epoch 2, 26.8%	 loss: 5.929 acc@1: 17.66 mrr: 27.73, ndcg: 31.59, took: 0.40s
Epoch 2, 35.7%	 loss: 5.700 acc@1: 17.34 mrr: 27.79, ndcg: 32.39, took: 0.39s
Epoch 2, 44.6%	 loss: 5.399 acc@1: 21.09 mrr: 31.53, ndcg: 35.63, took: 0.41s
Epoch 2, 53.6%	 loss: 5.263 acc@1: 21.56 mrr: 31.06, ndcg: 35.02, took: 0.40s
Epoch 2, 62.5%	 loss: 4.930 acc@1: 22.97 mrr: 34.10, ndcg: 39.41, took: 0.41s
Epoch 2, 71.4%	 loss: 4.966 acc@1: 20.94 mrr: 32.03, ndcg: 36.69, took: 0.36s
Epoch 2, 80.4%	 loss: 4.628 acc@1: 25.94 mrr: 37.37, ndcg: 42.18, took: 0.35s
Epoch 2, 89.3%	 loss: 4.324 acc@1: 26.72 mrr: 38.90, ndcg: 43.41, took: 0.34s
Epoch 2, 98.2%	 loss: 4.393 acc@1: 24.53 mrr: 37.33, ndcg: 42.56, took: 0.36s
Validation - loss: 4.7793, acc@1: 25.15%, f1: 14.87%, mrr: 37.36%, ndcg: 42.35%
Current learning rate: 0.000000

=== Test Results ===
Test Results:
  acc@1: 22.18%
  acc@5: 45.37%
  acc@10: 53.70%
  mrr: 32.31%
  ndcg: 36.96%
  f1: 12.33%

=== Training Complete ===
