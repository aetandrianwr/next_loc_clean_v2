Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/config/ht_optuna/optuna_MHSA_geolife_prev10_t9_20251231_154749_36ec972e.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=227, val=99, test=104
Total trainable parameters: 582652

=== Epoch 1 ===
Epoch 1, 8.8%	 loss: 7.148 acc@1: 0.00 mrr: 0.54, ndcg: 0.31, took: 1.95s
Epoch 1, 17.6%	 loss: 7.132 acc@1: 0.16 mrr: 0.82, ndcg: 0.65, took: 1.39s
Epoch 1, 26.4%	 loss: 7.157 acc@1: 0.16 mrr: 0.72, ndcg: 0.46, took: 1.44s
Epoch 1, 35.2%	 loss: 7.046 acc@1: 0.31 mrr: 1.51, ndcg: 1.44, took: 1.31s
Epoch 1, 44.1%	 loss: 7.020 acc@1: 0.62 mrr: 2.00, ndcg: 2.02, took: 1.47s
Epoch 1, 52.9%	 loss: 6.941 acc@1: 1.41 mrr: 3.23, ndcg: 3.12, took: 1.39s
Epoch 1, 61.7%	 loss: 6.824 acc@1: 6.72 mrr: 9.54, ndcg: 10.07, took: 1.45s
Epoch 1, 70.5%	 loss: 6.609 acc@1: 14.84 mrr: 18.25, ndcg: 18.95, took: 1.47s
Epoch 1, 79.3%	 loss: 6.374 acc@1: 14.22 mrr: 19.34, ndcg: 20.63, took: 1.48s
Epoch 1, 88.1%	 loss: 6.073 acc@1: 15.47 mrr: 22.65, ndcg: 24.81, took: 1.47s
Epoch 1, 96.9%	 loss: 5.727 acc@1: 20.31 mrr: 27.88, ndcg: 30.74, took: 1.53s
Validation - loss: 5.3448, acc@1: 20.61%, f1: 10.60%, mrr: 29.91%, ndcg: 34.27%
Current learning rate: 0.000500

=== Epoch 2 ===
Epoch 2, 8.8%	 loss: 5.312 acc@1: 22.66 mrr: 31.54, ndcg: 35.43, took: 1.02s
Epoch 2, 17.6%	 loss: 5.093 acc@1: 25.00 mrr: 34.42, ndcg: 38.52, took: 1.10s
Epoch 2, 26.4%	 loss: 5.083 acc@1: 21.41 mrr: 32.55, ndcg: 36.53, took: 1.28s
Epoch 2, 35.2%	 loss: 5.016 acc@1: 25.16 mrr: 34.75, ndcg: 38.56, took: 1.26s
Epoch 2, 44.1%	 loss: 4.751 acc@1: 27.97 mrr: 36.73, ndcg: 40.66, took: 1.33s
Epoch 2, 52.9%	 loss: 4.488 acc@1: 25.78 mrr: 37.78, ndcg: 42.53, took: 1.57s
Epoch 2, 61.7%	 loss: 4.321 acc@1: 31.72 mrr: 42.25, ndcg: 46.18, took: 1.49s
Epoch 2, 70.5%	 loss: 4.194 acc@1: 32.50 mrr: 42.81, ndcg: 47.13, took: 1.54s
Epoch 2, 79.3%	 loss: 3.952 acc@1: 34.38 mrr: 45.58, ndcg: 50.12, took: 1.47s
Epoch 2, 88.1%	 loss: 3.962 acc@1: 34.84 mrr: 45.73, ndcg: 50.12, took: 1.52s
Epoch 2, 96.9%	 loss: 3.892 acc@1: 32.66 mrr: 45.43, ndcg: 50.42, took: 1.53s
Validation - loss: 4.2387, acc@1: 36.27%, f1: 26.48%, mrr: 46.27%, ndcg: 49.85%
Current learning rate: 0.001000

=== Epoch 3 ===
Epoch 3, 8.8%	 loss: 3.904 acc@1: 32.34 mrr: 43.94, ndcg: 47.91, took: 1.04s
Epoch 3, 17.6%	 loss: 3.646 acc@1: 33.44 mrr: 46.59, ndcg: 51.12, took: 1.07s
Epoch 3, 26.4%	 loss: 3.504 acc@1: 35.94 mrr: 49.54, ndcg: 54.11, took: 1.44s
Epoch 3, 35.2%	 loss: 3.689 acc@1: 35.94 mrr: 48.16, ndcg: 52.47, took: 1.38s
Epoch 3, 44.1%	 loss: 3.411 acc@1: 40.94 mrr: 52.44, ndcg: 56.27, took: 1.26s
Epoch 3, 52.9%	 loss: 3.557 acc@1: 37.81 mrr: 49.66, ndcg: 53.83, took: 1.21s
Epoch 3, 61.7%	 loss: 3.450 acc@1: 36.72 mrr: 50.04, ndcg: 54.71, took: 1.27s
Epoch 3, 70.5%	 loss: 3.494 acc@1: 36.25 mrr: 49.38, ndcg: 54.12, took: 1.32s
Epoch 3, 79.3%	 loss: 3.301 acc@1: 39.38 mrr: 52.52, ndcg: 56.98, took: 1.42s
Epoch 3, 88.1%	 loss: 3.462 acc@1: 39.38 mrr: 51.05, ndcg: 54.98, took: 1.54s
Epoch 3, 96.9%	 loss: 3.395 acc@1: 39.22 mrr: 51.24, ndcg: 55.50, took: 1.53s
Validation - loss: 4.0709, acc@1: 39.33%, f1: 28.99%, mrr: 49.28%, ndcg: 52.83%
Current learning rate: 0.000979

=== Epoch 4 ===
Epoch 4, 8.8%	 loss: 3.026 acc@1: 40.31 mrr: 53.59, ndcg: 58.01, took: 0.96s
Epoch 4, 17.6%	 loss: 3.021 acc@1: 41.25 mrr: 54.27, ndcg: 58.66, took: 1.07s
Epoch 4, 26.4%	 loss: 3.202 acc@1: 41.88 mrr: 53.18, ndcg: 56.89, took: 1.15s
Epoch 4, 35.2%	 loss: 3.062 acc@1: 42.34 mrr: 54.12, ndcg: 58.33, took: 1.44s
Epoch 4, 44.1%	 loss: 2.933 acc@1: 43.44 mrr: 55.83, ndcg: 60.20, took: 1.48s
Epoch 4, 52.9%	 loss: 2.987 acc@1: 42.50 mrr: 55.02, ndcg: 59.22, took: 1.46s
Epoch 4, 61.7%	 loss: 2.961 acc@1: 44.53 mrr: 56.64, ndcg: 60.81, took: 1.44s
Epoch 4, 70.5%	 loss: 2.991 acc@1: 43.44 mrr: 56.07, ndcg: 60.23, took: 1.48s
Epoch 4, 79.3%	 loss: 3.146 acc@1: 38.12 mrr: 51.55, ndcg: 55.99, took: 1.39s
Epoch 4, 88.1%	 loss: 3.035 acc@1: 43.59 mrr: 55.09, ndcg: 59.63, took: 1.34s
Epoch 4, 96.9%	 loss: 3.067 acc@1: 43.28 mrr: 54.56, ndcg: 58.32, took: 1.31s
Validation - loss: 4.1873, acc@1: 39.36%, f1: 30.75%, mrr: 49.68%, ndcg: 53.34%
Current learning rate: 0.000958

=== Epoch 5 ===
Epoch 5, 8.8%	 loss: 2.651 acc@1: 45.47 mrr: 58.32, ndcg: 62.96, took: 1.06s
Epoch 5, 17.6%	 loss: 2.660 acc@1: 45.94 mrr: 59.02, ndcg: 63.43, took: 1.06s
Epoch 5, 26.4%	 loss: 2.701 acc@1: 44.06 mrr: 57.46, ndcg: 62.12, took: 1.09s
Epoch 5, 35.2%	 loss: 2.627 acc@1: 47.97 mrr: 59.35, ndcg: 63.63, took: 1.32s
Epoch 5, 44.1%	 loss: 2.584 acc@1: 47.66 mrr: 60.15, ndcg: 64.38, took: 1.44s
Epoch 5, 52.9%	 loss: 2.684 acc@1: 47.34 mrr: 59.26, ndcg: 63.40, took: 1.54s
Epoch 5, 61.7%	 loss: 2.626 acc@1: 48.91 mrr: 59.73, ndcg: 63.89, took: 1.51s
Epoch 5, 70.5%	 loss: 2.623 acc@1: 47.50 mrr: 59.75, ndcg: 63.94, took: 1.48s
Epoch 5, 79.3%	 loss: 2.857 acc@1: 44.84 mrr: 56.61, ndcg: 60.73, took: 1.47s
Epoch 5, 88.1%	 loss: 2.634 acc@1: 46.09 mrr: 59.21, ndcg: 63.55, took: 1.46s
Epoch 5, 96.9%	 loss: 2.724 acc@1: 47.81 mrr: 59.29, ndcg: 63.08, took: 1.47s
Validation - loss: 4.1647, acc@1: 41.69%, f1: 32.37%, mrr: 51.16%, ndcg: 54.56%
Current learning rate: 0.000937

=== Epoch 6 ===
Epoch 6, 8.8%	 loss: 2.160 acc@1: 51.56 mrr: 64.78, ndcg: 69.79, took: 1.03s
Epoch 6, 17.6%	 loss: 2.261 acc@1: 52.19 mrr: 64.44, ndcg: 68.98, took: 1.08s
Epoch 6, 26.4%	 loss: 2.310 acc@1: 48.28 mrr: 61.75, ndcg: 66.88, took: 1.13s
Epoch 6, 35.2%	 loss: 2.440 acc@1: 48.91 mrr: 61.20, ndcg: 65.80, took: 1.18s
Epoch 6, 44.1%	 loss: 2.355 acc@1: 51.72 mrr: 63.39, ndcg: 67.66, took: 1.40s
Epoch 6, 52.9%	 loss: 2.307 acc@1: 50.62 mrr: 63.13, ndcg: 67.49, took: 1.43s
Epoch 6, 61.7%	 loss: 2.414 acc@1: 49.69 mrr: 61.95, ndcg: 66.61, took: 1.51s
Epoch 6, 70.5%	 loss: 2.350 acc@1: 51.09 mrr: 62.89, ndcg: 67.37, took: 1.46s
Epoch 6, 79.3%	 loss: 2.305 acc@1: 53.59 mrr: 64.20, ndcg: 68.17, took: 1.43s
Epoch 6, 88.1%	 loss: 2.369 acc@1: 50.31 mrr: 62.38, ndcg: 66.82, took: 1.45s
Epoch 6, 96.9%	 loss: 2.512 acc@1: 48.28 mrr: 60.40, ndcg: 64.60, took: 1.47s
Validation - loss: 4.3515, acc@1: 42.26%, f1: 33.44%, mrr: 51.55%, ndcg: 54.94%
Current learning rate: 0.000917

=== Epoch 7 ===
Epoch 7, 8.8%	 loss: 1.914 acc@1: 57.81 mrr: 69.60, ndcg: 74.08, took: 1.21s
Epoch 7, 17.6%	 loss: 1.948 acc@1: 55.78 mrr: 68.33, ndcg: 73.26, took: 0.99s
Epoch 7, 26.4%	 loss: 2.047 acc@1: 55.00 mrr: 66.81, ndcg: 71.69, took: 0.96s
Epoch 7, 35.2%	 loss: 1.990 acc@1: 57.19 mrr: 68.20, ndcg: 72.59, took: 1.06s
Epoch 7, 44.1%	 loss: 2.035 acc@1: 53.44 mrr: 66.40, ndcg: 71.72, took: 1.10s
Epoch 7, 52.9%	 loss: 2.129 acc@1: 55.62 mrr: 66.36, ndcg: 70.60, took: 1.43s
Epoch 7, 61.7%	 loss: 2.233 acc@1: 50.78 mrr: 63.62, ndcg: 68.71, took: 1.43s
Epoch 7, 70.5%	 loss: 2.015 acc@1: 53.91 mrr: 66.89, ndcg: 71.79, took: 1.39s
Epoch 7, 79.3%	 loss: 2.061 acc@1: 54.22 mrr: 66.05, ndcg: 70.62, took: 1.42s
Epoch 7, 88.1%	 loss: 2.226 acc@1: 50.78 mrr: 63.57, ndcg: 68.45, took: 1.47s
Epoch 7, 96.9%	 loss: 2.294 acc@1: 51.41 mrr: 63.44, ndcg: 67.86, took: 1.43s
Validation - loss: 4.3737, acc@1: 41.62%, f1: 33.60%, mrr: 50.90%, ndcg: 54.39%
Current learning rate: 0.000896

=== Epoch 8 ===
Epoch 8, 8.8%	 loss: 1.641 acc@1: 60.62 mrr: 72.78, ndcg: 77.83, took: 1.45s
Epoch 8, 17.6%	 loss: 1.744 acc@1: 60.62 mrr: 71.93, ndcg: 76.39, took: 1.38s
Epoch 8, 26.4%	 loss: 1.931 acc@1: 56.41 mrr: 68.53, ndcg: 73.62, took: 1.12s
Epoch 8, 35.2%	 loss: 1.797 acc@1: 59.53 mrr: 71.06, ndcg: 75.87, took: 1.14s
Epoch 8, 44.1%	 loss: 1.844 acc@1: 59.06 mrr: 70.25, ndcg: 75.13, took: 1.09s
Epoch 8, 52.9%	 loss: 1.718 acc@1: 59.22 mrr: 71.12, ndcg: 76.16, took: 1.14s
Epoch 8, 61.7%	 loss: 1.847 acc@1: 55.78 mrr: 68.73, ndcg: 73.96, took: 1.21s
Epoch 8, 70.5%	 loss: 1.768 acc@1: 58.12 mrr: 70.58, ndcg: 75.26, took: 1.20s
Epoch 8, 79.3%	 loss: 1.807 acc@1: 58.12 mrr: 70.27, ndcg: 75.24, took: 1.36s
Epoch 8, 88.1%	 loss: 1.975 acc@1: 54.84 mrr: 66.76, ndcg: 72.03, took: 1.47s
Epoch 8, 96.9%	 loss: 1.805 acc@1: 61.56 mrr: 72.18, ndcg: 76.41, took: 1.51s
Validation - loss: 4.6154, acc@1: 41.43%, f1: 33.81%, mrr: 50.77%, ndcg: 54.10%
Current learning rate: 0.000088

=== Epoch 9 ===
Epoch 9, 8.8%	 loss: 3.001 acc@1: 42.50 mrr: 54.75, ndcg: 58.79, took: 1.42s
Epoch 9, 17.6%	 loss: 3.167 acc@1: 39.84 mrr: 52.72, ndcg: 57.23, took: 1.50s
Epoch 9, 26.4%	 loss: 2.855 acc@1: 41.88 mrr: 56.12, ndcg: 60.89, took: 1.28s
Epoch 9, 35.2%	 loss: 2.915 acc@1: 46.88 mrr: 57.49, ndcg: 60.93, took: 1.21s
Epoch 9, 44.1%	 loss: 2.968 acc@1: 42.34 mrr: 55.72, ndcg: 60.37, took: 1.34s
Epoch 9, 52.9%	 loss: 3.157 acc@1: 40.16 mrr: 52.48, ndcg: 56.61, took: 1.22s
Epoch 9, 61.7%	 loss: 2.917 acc@1: 44.06 mrr: 56.16, ndcg: 60.48, took: 1.31s
Epoch 9, 70.5%	 loss: 2.870 acc@1: 47.19 mrr: 57.99, ndcg: 61.47, took: 1.32s
Epoch 9, 79.3%	 loss: 3.043 acc@1: 41.88 mrr: 54.02, ndcg: 57.85, took: 1.18s
Epoch 9, 88.1%	 loss: 2.789 acc@1: 45.00 mrr: 57.48, ndcg: 61.89, took: 1.25s
Epoch 9, 96.9%	 loss: 3.036 acc@1: 41.56 mrr: 54.04, ndcg: 58.09, took: 1.26s
Validation - loss: 4.0318, acc@1: 40.76%, f1: 30.54%, mrr: 50.32%, ndcg: 53.67%
Current learning rate: 0.000088

=== Epoch 10 ===
Epoch 10, 8.8%	 loss: 3.075 acc@1: 40.31 mrr: 53.20, ndcg: 57.25, took: 1.40s
Epoch 10, 17.6%	 loss: 2.827 acc@1: 44.38 mrr: 57.21, ndcg: 61.61, took: 1.51s
Epoch 10, 26.4%	 loss: 2.894 acc@1: 42.34 mrr: 55.25, ndcg: 59.40, took: 1.36s
Epoch 10, 35.2%	 loss: 2.992 acc@1: 42.50 mrr: 54.22, ndcg: 58.44, took: 1.28s
Epoch 10, 44.1%	 loss: 2.726 acc@1: 46.56 mrr: 58.44, ndcg: 62.25, took: 1.31s
Epoch 10, 52.9%	 loss: 2.947 acc@1: 42.34 mrr: 55.30, ndcg: 59.50, took: 1.26s
Epoch 10, 61.7%	 loss: 2.732 acc@1: 47.81 mrr: 58.75, ndcg: 62.70, took: 1.29s
Epoch 10, 70.5%	 loss: 2.769 acc@1: 46.09 mrr: 58.01, ndcg: 62.14, took: 1.40s
Epoch 10, 79.3%	 loss: 2.920 acc@1: 44.69 mrr: 56.03, ndcg: 59.86, took: 1.47s
Epoch 10, 88.1%	 loss: 2.827 acc@1: 47.34 mrr: 58.18, ndcg: 61.77, took: 1.35s
Epoch 10, 96.9%	 loss: 3.083 acc@1: 40.62 mrr: 52.86, ndcg: 57.32, took: 1.34s
Validation - loss: 4.0481, acc@1: 41.85%, f1: 31.56%, mrr: 50.88%, ndcg: 54.16%
Current learning rate: 0.000088

=== Epoch 11 ===
Epoch 11, 8.8%	 loss: 2.963 acc@1: 42.19 mrr: 54.28, ndcg: 58.63, took: 1.41s
Epoch 11, 17.6%	 loss: 2.798 acc@1: 44.06 mrr: 56.72, ndcg: 61.45, took: 1.37s
Epoch 11, 26.4%	 loss: 2.776 acc@1: 44.53 mrr: 57.73, ndcg: 62.12, took: 1.42s
Epoch 11, 35.2%	 loss: 2.911 acc@1: 44.53 mrr: 55.92, ndcg: 59.95, took: 1.34s
Epoch 11, 44.1%	 loss: 2.741 acc@1: 47.03 mrr: 58.68, ndcg: 62.94, took: 1.32s
Epoch 11, 52.9%	 loss: 2.849 acc@1: 46.25 mrr: 57.32, ndcg: 61.19, took: 1.27s
Epoch 11, 61.7%	 loss: 2.707 acc@1: 46.09 mrr: 58.75, ndcg: 62.89, took: 1.31s
Epoch 11, 70.5%	 loss: 2.951 acc@1: 43.75 mrr: 55.69, ndcg: 59.74, took: 1.43s
Epoch 11, 79.3%	 loss: 2.885 acc@1: 45.62 mrr: 56.98, ndcg: 60.56, took: 1.42s
Epoch 11, 88.1%	 loss: 2.845 acc@1: 47.50 mrr: 58.03, ndcg: 61.40, took: 1.39s
Epoch 11, 96.9%	 loss: 2.759 acc@1: 45.47 mrr: 57.85, ndcg: 62.47, took: 1.42s
Validation - loss: 4.0769, acc@1: 41.85%, f1: 31.63%, mrr: 50.95%, ndcg: 54.25%
Current learning rate: 0.000088

=== Epoch 12 ===
Epoch 12, 8.8%	 loss: 2.882 acc@1: 44.06 mrr: 56.09, ndcg: 60.13, took: 1.13s
Epoch 12, 17.6%	 loss: 2.771 acc@1: 47.03 mrr: 58.74, ndcg: 62.78, took: 1.22s
Epoch 12, 26.4%	 loss: 2.625 acc@1: 48.44 mrr: 60.54, ndcg: 64.67, took: 1.29s
Epoch 12, 35.2%	 loss: 2.769 acc@1: 47.34 mrr: 58.65, ndcg: 62.64, took: 1.24s
Epoch 12, 44.1%	 loss: 2.683 acc@1: 46.56 mrr: 59.21, ndcg: 63.74, took: 1.29s
Epoch 12, 52.9%	 loss: 2.807 acc@1: 45.00 mrr: 56.87, ndcg: 60.79, took: 1.21s
Epoch 12, 61.7%	 loss: 2.735 acc@1: 46.09 mrr: 57.72, ndcg: 61.90, took: 1.32s
Epoch 12, 70.5%	 loss: 2.740 acc@1: 45.94 mrr: 57.96, ndcg: 62.09, took: 1.44s
Epoch 12, 79.3%	 loss: 2.673 acc@1: 48.28 mrr: 59.41, ndcg: 62.97, took: 1.42s
Epoch 12, 88.1%	 loss: 2.771 acc@1: 44.84 mrr: 57.38, ndcg: 61.58, took: 1.41s
Epoch 12, 96.9%	 loss: 2.893 acc@1: 42.50 mrr: 55.29, ndcg: 59.91, took: 1.47s
Validation - loss: 4.0935, acc@1: 41.46%, f1: 31.70%, mrr: 50.76%, ndcg: 54.01%
Current learning rate: 0.000088

=== Epoch 13 ===
Epoch 13, 8.8%	 loss: 2.697 acc@1: 48.91 mrr: 59.81, ndcg: 63.68, took: 1.47s
Epoch 13, 17.6%	 loss: 2.845 acc@1: 45.00 mrr: 56.65, ndcg: 60.65, took: 1.35s
Epoch 13, 26.4%	 loss: 2.667 acc@1: 47.81 mrr: 59.23, ndcg: 63.09, took: 1.29s
Epoch 13, 35.2%	 loss: 2.766 acc@1: 43.75 mrr: 56.59, ndcg: 61.60, took: 1.25s
Epoch 13, 44.1%	 loss: 2.842 acc@1: 44.53 mrr: 56.72, ndcg: 60.78, took: 1.16s
Epoch 13, 52.9%	 loss: 2.681 acc@1: 45.94 mrr: 58.24, ndcg: 62.70, took: 1.18s
Epoch 13, 61.7%	 loss: 2.665 acc@1: 47.34 mrr: 59.31, ndcg: 63.36, took: 1.15s
Epoch 13, 70.5%	 loss: 2.651 acc@1: 46.72 mrr: 58.63, ndcg: 62.81, took: 1.38s
Epoch 13, 79.3%	 loss: 2.658 acc@1: 48.44 mrr: 59.54, ndcg: 63.64, took: 1.35s
Epoch 13, 88.1%	 loss: 2.703 acc@1: 43.28 mrr: 57.45, ndcg: 62.31, took: 1.42s
Epoch 13, 96.9%	 loss: 2.642 acc@1: 47.66 mrr: 59.83, ndcg: 64.17, took: 1.49s
Validation - loss: 4.1041, acc@1: 41.50%, f1: 31.36%, mrr: 50.88%, ndcg: 54.15%
Current learning rate: 0.000088

=== Epoch 14 ===
Epoch 14, 8.8%	 loss: 2.670 acc@1: 46.25 mrr: 58.40, ndcg: 62.12, took: 1.44s
Epoch 14, 17.6%	 loss: 2.750 acc@1: 45.00 mrr: 57.53, ndcg: 61.99, took: 1.35s
Epoch 14, 26.4%	 loss: 2.645 acc@1: 47.19 mrr: 59.98, ndcg: 64.56, took: 1.52s
Epoch 14, 35.2%	 loss: 2.617 acc@1: 47.81 mrr: 59.81, ndcg: 64.07, took: 1.39s
Epoch 14, 44.1%	 loss: 2.609 acc@1: 49.06 mrr: 60.55, ndcg: 64.60, took: 1.30s
Epoch 14, 52.9%	 loss: 2.618 acc@1: 49.53 mrr: 60.21, ndcg: 64.02, took: 1.29s
Epoch 14, 61.7%	 loss: 2.563 acc@1: 46.72 mrr: 59.46, ndcg: 63.85, took: 1.16s
Epoch 14, 70.5%	 loss: 2.727 acc@1: 45.62 mrr: 57.60, ndcg: 62.07, took: 1.07s
Epoch 14, 79.3%	 loss: 2.561 acc@1: 48.75 mrr: 60.90, ndcg: 64.69, took: 1.22s
Epoch 14, 88.1%	 loss: 2.716 acc@1: 47.03 mrr: 58.62, ndcg: 62.46, took: 1.28s
Epoch 14, 96.9%	 loss: 2.672 acc@1: 47.19 mrr: 59.25, ndcg: 63.25, took: 1.26s
Validation - loss: 4.1119, acc@1: 41.97%, f1: 32.08%, mrr: 51.13%, ndcg: 54.33%
Current learning rate: 0.000009

=== Epoch 15 ===
Epoch 15, 8.8%	 loss: 2.892 acc@1: 42.97 mrr: 55.56, ndcg: 59.60, took: 1.45s
Epoch 15, 17.6%	 loss: 2.898 acc@1: 43.59 mrr: 55.84, ndcg: 59.66, took: 1.39s
Epoch 15, 26.4%	 loss: 2.870 acc@1: 44.53 mrr: 56.48, ndcg: 60.56, took: 1.48s
Epoch 15, 35.2%	 loss: 2.956 acc@1: 44.22 mrr: 55.82, ndcg: 59.73, took: 1.45s
Epoch 15, 44.1%	 loss: 3.094 acc@1: 42.34 mrr: 53.77, ndcg: 58.09, took: 1.40s
Epoch 15, 52.9%	 loss: 2.823 acc@1: 45.00 mrr: 56.90, ndcg: 60.97, took: 1.33s
Epoch 15, 61.7%	 loss: 2.714 acc@1: 49.06 mrr: 60.19, ndcg: 63.85, took: 1.35s
Epoch 15, 70.5%	 loss: 2.843 acc@1: 42.97 mrr: 55.97, ndcg: 60.37, took: 1.30s
Epoch 15, 79.3%	 loss: 3.001 acc@1: 42.03 mrr: 54.41, ndcg: 58.33, took: 1.32s
Epoch 15, 88.1%	 loss: 2.780 acc@1: 45.94 mrr: 57.70, ndcg: 61.78, took: 1.25s
Epoch 15, 96.9%	 loss: 2.872 acc@1: 46.72 mrr: 57.75, ndcg: 61.51, took: 1.21s
Validation - loss: 4.0373, acc@1: 41.56%, f1: 31.14%, mrr: 50.73%, ndcg: 53.99%
Current learning rate: 0.000009

=== Epoch 16 ===
Epoch 16, 8.8%	 loss: 2.682 acc@1: 48.12 mrr: 59.83, ndcg: 63.55, took: 1.44s
Epoch 16, 17.6%	 loss: 2.961 acc@1: 43.28 mrr: 55.36, ndcg: 59.08, took: 1.44s
Epoch 16, 26.4%	 loss: 3.005 acc@1: 43.28 mrr: 55.18, ndcg: 59.11, took: 1.47s
Epoch 16, 35.2%	 loss: 2.927 acc@1: 44.38 mrr: 56.51, ndcg: 60.46, took: 1.49s
Epoch 16, 44.1%	 loss: 2.885 acc@1: 45.78 mrr: 56.63, ndcg: 60.42, took: 1.50s
Epoch 16, 52.9%	 loss: 2.758 acc@1: 45.31 mrr: 57.66, ndcg: 61.92, took: 1.33s
Epoch 16, 61.7%	 loss: 2.858 acc@1: 43.91 mrr: 56.16, ndcg: 60.16, took: 1.36s
Epoch 16, 70.5%	 loss: 2.873 acc@1: 43.12 mrr: 55.68, ndcg: 59.77, took: 1.39s
Epoch 16, 79.3%	 loss: 2.855 acc@1: 44.38 mrr: 56.56, ndcg: 60.33, took: 1.40s
Epoch 16, 88.1%	 loss: 3.067 acc@1: 41.25 mrr: 53.23, ndcg: 57.67, took: 1.41s
Epoch 16, 96.9%	 loss: 2.933 acc@1: 44.53 mrr: 55.62, ndcg: 59.39, took: 1.37s
Validation - loss: 4.0421, acc@1: 41.66%, f1: 31.17%, mrr: 50.74%, ndcg: 53.99%
Current learning rate: 0.000009

=== Epoch 17 ===
Epoch 17, 8.8%	 loss: 2.924 acc@1: 40.78 mrr: 54.12, ndcg: 58.68, took: 1.27s
Epoch 17, 17.6%	 loss: 2.837 acc@1: 47.97 mrr: 58.41, ndcg: 61.77, took: 1.27s
Epoch 17, 26.4%	 loss: 2.944 acc@1: 42.81 mrr: 55.18, ndcg: 59.76, took: 1.37s
Epoch 17, 35.2%	 loss: 2.806 acc@1: 45.94 mrr: 57.89, ndcg: 61.93, took: 1.52s
Epoch 17, 44.1%	 loss: 2.885 acc@1: 42.34 mrr: 55.18, ndcg: 59.58, took: 1.46s
Epoch 17, 52.9%	 loss: 2.858 acc@1: 47.34 mrr: 58.12, ndcg: 61.12, took: 1.28s
Epoch 17, 61.7%	 loss: 2.857 acc@1: 43.59 mrr: 56.24, ndcg: 60.23, took: 1.38s
Epoch 17, 70.5%	 loss: 2.964 acc@1: 44.69 mrr: 56.00, ndcg: 59.85, took: 1.34s
Epoch 17, 79.3%	 loss: 2.916 acc@1: 43.12 mrr: 55.36, ndcg: 59.43, took: 1.40s
Epoch 17, 88.1%	 loss: 2.806 acc@1: 45.31 mrr: 57.74, ndcg: 61.89, took: 1.53s
Epoch 17, 96.9%	 loss: 3.031 acc@1: 41.41 mrr: 53.69, ndcg: 57.84, took: 1.51s
Validation - loss: 4.0498, acc@1: 40.83%, f1: 30.51%, mrr: 50.37%, ndcg: 53.75%
Current learning rate: 0.000009

=== Epoch 18 ===
Epoch 18, 8.8%	 loss: 2.927 acc@1: 44.38 mrr: 56.43, ndcg: 60.35, took: 1.13s
Epoch 18, 17.6%	 loss: 2.808 acc@1: 44.53 mrr: 56.95, ndcg: 61.13, took: 1.19s
Epoch 18, 26.4%	 loss: 2.692 acc@1: 46.72 mrr: 59.38, ndcg: 63.89, took: 1.26s
Epoch 18, 35.2%	 loss: 2.871 acc@1: 44.53 mrr: 56.59, ndcg: 60.69, took: 1.41s
Epoch 18, 44.1%	 loss: 2.893 acc@1: 44.69 mrr: 56.60, ndcg: 60.42, took: 1.41s
Epoch 18, 52.9%	 loss: 2.940 acc@1: 41.88 mrr: 54.35, ndcg: 58.59, took: 1.31s
Epoch 18, 61.7%	 loss: 2.836 acc@1: 43.91 mrr: 56.28, ndcg: 60.06, took: 1.33s
Epoch 18, 70.5%	 loss: 2.822 acc@1: 46.88 mrr: 57.98, ndcg: 61.55, took: 1.33s
Epoch 18, 79.3%	 loss: 2.813 acc@1: 44.53 mrr: 56.84, ndcg: 61.11, took: 1.28s
Epoch 18, 88.1%	 loss: 2.985 acc@1: 43.12 mrr: 54.69, ndcg: 58.66, took: 1.41s
Epoch 18, 96.9%	 loss: 2.957 acc@1: 42.66 mrr: 54.72, ndcg: 58.62, took: 1.30s
Validation - loss: 4.0326, acc@1: 41.66%, f1: 31.06%, mrr: 50.78%, ndcg: 54.04%
Current learning rate: 0.000009

=== Epoch 19 ===
Epoch 19, 8.8%	 loss: 2.838 acc@1: 46.72 mrr: 57.95, ndcg: 61.65, took: 1.36s
Epoch 19, 17.6%	 loss: 2.942 acc@1: 44.53 mrr: 55.61, ndcg: 59.38, took: 1.31s
Epoch 19, 26.4%	 loss: 2.952 acc@1: 42.19 mrr: 54.92, ndcg: 59.15, took: 1.30s
Epoch 19, 35.2%	 loss: 2.959 acc@1: 40.62 mrr: 53.67, ndcg: 57.89, took: 1.34s
Epoch 19, 44.1%	 loss: 2.834 acc@1: 44.69 mrr: 56.85, ndcg: 60.77, took: 1.38s
Epoch 19, 52.9%	 loss: 2.908 acc@1: 44.06 mrr: 55.93, ndcg: 60.09, took: 1.31s
Epoch 19, 61.7%	 loss: 2.829 acc@1: 43.28 mrr: 56.52, ndcg: 60.82, took: 1.20s
Epoch 19, 70.5%	 loss: 2.769 acc@1: 46.88 mrr: 58.64, ndcg: 62.52, took: 1.25s
Epoch 19, 79.3%	 loss: 2.898 acc@1: 43.91 mrr: 55.60, ndcg: 59.32, took: 1.24s
Epoch 19, 88.1%	 loss: 2.890 acc@1: 43.12 mrr: 55.77, ndcg: 60.01, took: 1.36s
Epoch 19, 96.9%	 loss: 2.726 acc@1: 48.44 mrr: 59.18, ndcg: 62.97, took: 1.40s
Validation - loss: 4.0469, acc@1: 41.50%, f1: 30.75%, mrr: 50.70%, ndcg: 53.96%
Training finished.	 Time: 380.40s.	 acc@1: 40.76%

=== Test Results ===
Test Results:
  acc@1: 33.60%
  acc@5: 54.87%
  acc@10: 59.85%
  mrr: 43.24%
  ndcg: 47.01%
  f1: 22.99%

=== Training Complete ===
