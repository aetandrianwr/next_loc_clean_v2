Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/config/ht_optuna/optuna_MHSA_geolife_prev10_t7_20251231_154749_2438f84c.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=227, val=99, test=104
Total trainable parameters: 913404

=== Epoch 1 ===
Epoch 1, 8.8%	 loss: 7.149 acc@1: 0.00 mrr: 0.52, ndcg: 0.33, took: 2.64s
Epoch 1, 17.6%	 loss: 7.113 acc@1: 0.16 mrr: 0.80, ndcg: 0.51, took: 1.46s
Epoch 1, 26.4%	 loss: 7.042 acc@1: 0.78 mrr: 1.92, ndcg: 2.03, took: 1.53s
Epoch 1, 35.2%	 loss: 6.823 acc@1: 5.16 mrr: 7.55, ndcg: 7.75, took: 1.48s
Epoch 1, 44.1%	 loss: 6.500 acc@1: 13.28 mrr: 17.64, ndcg: 19.02, took: 1.54s
Epoch 1, 52.9%	 loss: 6.058 acc@1: 19.22 mrr: 26.97, ndcg: 29.76, took: 1.52s
Epoch 1, 61.7%	 loss: 5.681 acc@1: 21.88 mrr: 29.74, ndcg: 32.47, took: 1.49s
Epoch 1, 70.5%	 loss: 5.264 acc@1: 19.38 mrr: 30.15, ndcg: 34.52, took: 1.54s
Epoch 1, 79.3%	 loss: 5.104 acc@1: 22.19 mrr: 31.97, ndcg: 36.14, took: 1.46s
Epoch 1, 88.1%	 loss: 4.971 acc@1: 23.59 mrr: 33.83, ndcg: 38.25, took: 1.56s
Epoch 1, 96.9%	 loss: 4.709 acc@1: 22.97 mrr: 35.52, ndcg: 40.72, took: 1.48s
Validation - loss: 4.5138, acc@1: 23.25%, f1: 14.38%, mrr: 36.30%, ndcg: 40.87%
Current learning rate: 0.001000

=== Epoch 2 ===
Epoch 2, 8.8%	 loss: 4.312 acc@1: 27.19 mrr: 40.10, ndcg: 44.97, took: 1.25s
Epoch 2, 17.6%	 loss: 4.253 acc@1: 29.84 mrr: 40.71, ndcg: 45.18, took: 1.32s
Epoch 2, 26.4%	 loss: 4.006 acc@1: 33.12 mrr: 45.11, ndcg: 49.49, took: 1.38s
Epoch 2, 35.2%	 loss: 4.184 acc@1: 25.47 mrr: 39.02, ndcg: 44.11, took: 1.54s
Epoch 2, 44.1%	 loss: 4.063 acc@1: 29.84 mrr: 42.61, ndcg: 47.47, took: 1.53s
Epoch 2, 52.9%	 loss: 4.165 acc@1: 26.72 mrr: 40.35, ndcg: 45.51, took: 1.51s
Epoch 2, 61.7%	 loss: 4.071 acc@1: 28.91 mrr: 41.76, ndcg: 47.05, took: 1.54s
Epoch 2, 70.5%	 loss: 4.108 acc@1: 27.66 mrr: 41.10, ndcg: 46.46, took: 1.52s
Epoch 2, 79.3%	 loss: 3.955 acc@1: 29.22 mrr: 43.07, ndcg: 48.31, took: 1.52s
Epoch 2, 88.1%	 loss: 3.642 acc@1: 33.59 mrr: 47.21, ndcg: 52.61, took: 1.56s
Epoch 2, 96.9%	 loss: 3.785 acc@1: 30.16 mrr: 44.31, ndcg: 49.72, took: 1.50s
Validation - loss: 4.9909, acc@1: 22.45%, f1: 12.97%, mrr: 35.00%, ndcg: 40.09%
Current learning rate: 0.002000

=== Epoch 3 ===
Epoch 3, 8.8%	 loss: 3.572 acc@1: 30.16 mrr: 45.22, ndcg: 50.78, took: 1.49s
Epoch 3, 17.6%	 loss: 3.592 acc@1: 30.00 mrr: 44.88, ndcg: 50.24, took: 1.51s
Epoch 3, 26.4%	 loss: 3.619 acc@1: 32.66 mrr: 46.15, ndcg: 50.68, took: 1.33s
Epoch 3, 35.2%	 loss: 3.617 acc@1: 33.28 mrr: 46.89, ndcg: 51.61, took: 1.34s
Epoch 3, 44.1%	 loss: 3.525 acc@1: 35.16 mrr: 48.41, ndcg: 53.22, took: 1.35s
Epoch 3, 52.9%	 loss: 3.566 acc@1: 36.72 mrr: 49.19, ndcg: 53.58, took: 1.35s
Epoch 3, 61.7%	 loss: 3.704 acc@1: 31.56 mrr: 45.35, ndcg: 50.47, took: 1.53s
Epoch 3, 70.5%	 loss: 3.601 acc@1: 30.16 mrr: 45.83, ndcg: 51.44, took: 1.56s
Epoch 3, 79.3%	 loss: 3.576 acc@1: 30.31 mrr: 45.88, ndcg: 51.36, took: 1.51s
Epoch 3, 88.1%	 loss: 3.523 acc@1: 31.56 mrr: 46.75, ndcg: 52.11, took: 1.49s
Epoch 3, 96.9%	 loss: 3.626 acc@1: 30.31 mrr: 45.35, ndcg: 50.82, took: 1.36s
Validation - loss: 4.4968, acc@1: 33.79%, f1: 22.30%, mrr: 45.95%, ndcg: 50.43%
Current learning rate: 0.001958

=== Epoch 4 ===
Epoch 4, 8.8%	 loss: 2.992 acc@1: 37.97 mrr: 53.09, ndcg: 58.19, took: 1.44s
Epoch 4, 17.6%	 loss: 3.374 acc@1: 35.47 mrr: 48.94, ndcg: 53.51, took: 1.56s
Epoch 4, 26.4%	 loss: 3.245 acc@1: 33.44 mrr: 48.34, ndcg: 53.87, took: 1.54s
Epoch 4, 35.2%	 loss: 3.138 acc@1: 33.59 mrr: 49.37, ndcg: 54.87, took: 1.44s
Epoch 4, 44.1%	 loss: 3.248 acc@1: 31.25 mrr: 47.99, ndcg: 53.67, took: 1.55s
Epoch 4, 52.9%	 loss: 3.443 acc@1: 27.97 mrr: 45.07, ndcg: 51.06, took: 1.39s
Epoch 4, 61.7%	 loss: 3.310 acc@1: 30.62 mrr: 46.96, ndcg: 52.63, took: 1.33s
Epoch 4, 70.5%	 loss: 3.379 acc@1: 30.94 mrr: 47.01, ndcg: 52.46, took: 1.32s
Epoch 4, 79.3%	 loss: 3.378 acc@1: 30.94 mrr: 46.51, ndcg: 51.63, took: 1.30s
Epoch 4, 88.1%	 loss: 3.315 acc@1: 34.53 mrr: 49.06, ndcg: 54.09, took: 1.43s
Epoch 4, 96.9%	 loss: 3.362 acc@1: 30.47 mrr: 47.23, ndcg: 53.00, took: 1.39s
Validation - loss: 4.6684, acc@1: 34.04%, f1: 21.36%, mrr: 46.34%, ndcg: 50.87%
Current learning rate: 0.001917

=== Epoch 5 ===
Epoch 5, 8.8%	 loss: 2.905 acc@1: 34.84 mrr: 51.42, ndcg: 56.97, took: 1.50s
Epoch 5, 17.6%	 loss: 3.131 acc@1: 31.72 mrr: 48.15, ndcg: 53.53, took: 1.45s
Epoch 5, 26.4%	 loss: 3.111 acc@1: 32.19 mrr: 48.82, ndcg: 54.39, took: 1.57s
Epoch 5, 35.2%	 loss: 3.168 acc@1: 32.03 mrr: 47.85, ndcg: 53.36, took: 1.51s
Epoch 5, 44.1%	 loss: 3.107 acc@1: 33.59 mrr: 49.26, ndcg: 54.57, took: 1.53s
Epoch 5, 52.9%	 loss: 3.241 acc@1: 32.03 mrr: 47.39, ndcg: 52.90, took: 1.45s
Epoch 5, 61.7%	 loss: 2.982 acc@1: 37.19 mrr: 52.49, ndcg: 57.80, took: 1.52s
Epoch 5, 70.5%	 loss: 3.022 acc@1: 35.16 mrr: 50.76, ndcg: 56.40, took: 1.48s
Epoch 5, 79.3%	 loss: 2.902 acc@1: 35.31 mrr: 51.52, ndcg: 57.11, took: 1.30s
Epoch 5, 88.1%	 loss: 3.146 acc@1: 35.47 mrr: 49.98, ndcg: 55.12, took: 1.22s
Epoch 5, 96.9%	 loss: 3.029 acc@1: 35.16 mrr: 51.46, ndcg: 57.16, took: 1.16s
Validation - loss: 4.7090, acc@1: 33.41%, f1: 22.70%, mrr: 47.07%, ndcg: 51.74%
Current learning rate: 0.001875

=== Epoch 6 ===
Epoch 6, 8.8%	 loss: 2.642 acc@1: 37.19 mrr: 53.87, ndcg: 59.44, took: 1.42s
Epoch 6, 17.6%	 loss: 2.844 acc@1: 34.38 mrr: 50.97, ndcg: 56.80, took: 1.45s
Epoch 6, 26.4%	 loss: 2.909 acc@1: 35.78 mrr: 51.28, ndcg: 56.38, took: 1.51s
Epoch 6, 35.2%	 loss: 2.949 acc@1: 34.38 mrr: 50.33, ndcg: 55.97, took: 1.55s
Epoch 6, 44.1%	 loss: 2.874 acc@1: 34.06 mrr: 50.45, ndcg: 56.00, took: 1.59s
Epoch 6, 52.9%	 loss: 2.961 acc@1: 36.88 mrr: 51.38, ndcg: 56.08, took: 1.52s
Epoch 6, 61.7%	 loss: 2.985 acc@1: 34.22 mrr: 49.66, ndcg: 55.53, took: 1.64s
Epoch 6, 70.5%	 loss: 2.991 acc@1: 32.97 mrr: 49.67, ndcg: 55.01, took: 1.53s
Epoch 6, 79.3%	 loss: 3.115 acc@1: 33.59 mrr: 49.03, ndcg: 54.04, took: 1.46s
Epoch 6, 88.1%	 loss: 3.024 acc@1: 31.25 mrr: 48.16, ndcg: 53.80, took: 1.44s
Epoch 6, 96.9%	 loss: 2.827 acc@1: 34.84 mrr: 51.38, ndcg: 57.22, took: 1.25s
Validation - loss: 4.7122, acc@1: 31.02%, f1: 21.11%, mrr: 45.27%, ndcg: 50.05%
Current learning rate: 0.001833

=== Epoch 7 ===
Epoch 7, 8.8%	 loss: 2.840 acc@1: 32.50 mrr: 49.51, ndcg: 55.49, took: 1.40s
Epoch 7, 17.6%	 loss: 2.823 acc@1: 32.81 mrr: 49.83, ndcg: 55.54, took: 1.44s
Epoch 7, 26.4%	 loss: 2.875 acc@1: 33.59 mrr: 49.64, ndcg: 55.06, took: 1.45s
Epoch 7, 35.2%	 loss: 2.863 acc@1: 33.12 mrr: 49.58, ndcg: 55.38, took: 1.52s
Epoch 7, 44.1%	 loss: 2.779 acc@1: 36.88 mrr: 51.81, ndcg: 56.82, took: 1.58s
Epoch 7, 52.9%	 loss: 2.690 acc@1: 35.78 mrr: 53.08, ndcg: 58.58, took: 1.54s
Epoch 7, 61.7%	 loss: 2.815 acc@1: 32.97 mrr: 50.52, ndcg: 56.67, took: 1.55s
Epoch 7, 70.5%	 loss: 2.810 acc@1: 34.53 mrr: 51.34, ndcg: 56.65, took: 1.48s
Epoch 7, 79.3%	 loss: 2.959 acc@1: 33.12 mrr: 49.03, ndcg: 54.42, took: 1.44s
Epoch 7, 88.1%	 loss: 2.874 acc@1: 35.00 mrr: 50.79, ndcg: 56.40, took: 1.42s
Epoch 7, 96.9%	 loss: 2.896 acc@1: 37.97 mrr: 52.89, ndcg: 57.53, took: 1.45s
Validation - loss: 4.8391, acc@1: 31.46%, f1: 20.96%, mrr: 45.73%, ndcg: 50.57%
Current learning rate: 0.001792

=== Epoch 8 ===
Epoch 8, 8.8%	 loss: 2.583 acc@1: 34.38 mrr: 52.14, ndcg: 58.55, took: 1.20s
Epoch 8, 17.6%	 loss: 2.647 acc@1: 36.41 mrr: 52.31, ndcg: 57.65, took: 1.26s
Epoch 8, 26.4%	 loss: 2.782 acc@1: 35.00 mrr: 50.63, ndcg: 56.21, took: 1.29s
Epoch 8, 35.2%	 loss: 2.795 acc@1: 34.69 mrr: 51.23, ndcg: 56.67, took: 1.46s
Epoch 8, 44.1%	 loss: 2.668 acc@1: 36.09 mrr: 52.47, ndcg: 58.04, took: 1.59s
Epoch 8, 52.9%	 loss: 2.771 acc@1: 35.00 mrr: 51.47, ndcg: 57.07, took: 1.51s
Epoch 8, 61.7%	 loss: 2.913 acc@1: 32.97 mrr: 49.11, ndcg: 54.55, took: 1.44s
Epoch 8, 70.5%	 loss: 2.868 acc@1: 32.81 mrr: 49.49, ndcg: 54.74, took: 1.46s
Epoch 8, 79.3%	 loss: 2.903 acc@1: 31.09 mrr: 48.94, ndcg: 54.75, took: 1.42s
Epoch 8, 88.1%	 loss: 2.826 acc@1: 35.47 mrr: 50.78, ndcg: 55.65, took: 1.38s
Epoch 8, 96.9%	 loss: 2.689 acc@1: 36.88 mrr: 53.05, ndcg: 58.65, took: 1.53s
Validation - loss: 4.9407, acc@1: 31.40%, f1: 21.51%, mrr: 45.53%, ndcg: 50.33%
Current learning rate: 0.000175

=== Epoch 9 ===
Epoch 9, 8.8%	 loss: 3.352 acc@1: 32.03 mrr: 46.90, ndcg: 52.24, took: 1.32s
Epoch 9, 17.6%	 loss: 2.987 acc@1: 36.56 mrr: 52.06, ndcg: 57.42, took: 1.30s
Epoch 9, 26.4%	 loss: 3.034 acc@1: 35.62 mrr: 50.80, ndcg: 56.42, took: 1.25s
Epoch 9, 35.2%	 loss: 3.138 acc@1: 31.88 mrr: 48.51, ndcg: 53.86, took: 1.25s
Epoch 9, 44.1%	 loss: 3.088 acc@1: 35.31 mrr: 50.47, ndcg: 55.61, took: 1.35s
Epoch 9, 52.9%	 loss: 3.094 acc@1: 33.28 mrr: 49.40, ndcg: 54.96, took: 1.47s
Epoch 9, 61.7%	 loss: 2.882 acc@1: 36.56 mrr: 52.58, ndcg: 58.02, took: 1.43s
Epoch 9, 70.5%	 loss: 3.075 acc@1: 35.31 mrr: 50.58, ndcg: 55.31, took: 1.45s
Epoch 9, 79.3%	 loss: 3.212 acc@1: 31.72 mrr: 48.11, ndcg: 53.16, took: 1.39s
Epoch 9, 88.1%	 loss: 3.131 acc@1: 37.34 mrr: 51.47, ndcg: 55.80, took: 1.46s
Epoch 9, 96.9%	 loss: 3.028 acc@1: 37.19 mrr: 51.61, ndcg: 56.39, took: 1.49s
Validation - loss: 4.3998, acc@1: 34.68%, f1: 20.77%, mrr: 47.61%, ndcg: 51.77%
Current learning rate: 0.000175

=== Epoch 10 ===
Epoch 10, 8.8%	 loss: 3.091 acc@1: 35.31 mrr: 50.15, ndcg: 55.09, took: 1.38s
Epoch 10, 17.6%	 loss: 2.972 acc@1: 37.19 mrr: 52.30, ndcg: 57.19, took: 1.45s
Epoch 10, 26.4%	 loss: 2.876 acc@1: 36.88 mrr: 52.56, ndcg: 58.06, took: 1.46s
Epoch 10, 35.2%	 loss: 3.128 acc@1: 32.34 mrr: 47.99, ndcg: 53.61, took: 1.29s
Epoch 10, 44.1%	 loss: 2.937 acc@1: 35.94 mrr: 51.30, ndcg: 56.25, took: 1.36s
Epoch 10, 52.9%	 loss: 3.021 acc@1: 34.06 mrr: 50.38, ndcg: 55.60, took: 1.23s
Epoch 10, 61.7%	 loss: 2.906 acc@1: 35.47 mrr: 51.49, ndcg: 57.11, took: 1.29s
Epoch 10, 70.5%	 loss: 2.986 acc@1: 34.38 mrr: 50.90, ndcg: 56.30, took: 1.23s
Epoch 10, 79.3%	 loss: 2.944 acc@1: 34.84 mrr: 51.29, ndcg: 56.56, took: 1.32s
Epoch 10, 88.1%	 loss: 3.130 acc@1: 33.75 mrr: 48.82, ndcg: 54.16, took: 1.42s
Epoch 10, 96.9%	 loss: 2.891 acc@1: 36.88 mrr: 52.63, ndcg: 58.04, took: 1.50s
Validation - loss: 4.3905, acc@1: 35.99%, f1: 23.82%, mrr: 48.38%, ndcg: 52.40%
Current learning rate: 0.000175

=== Epoch 11 ===
Epoch 11, 8.8%	 loss: 2.828 acc@1: 37.34 mrr: 52.96, ndcg: 58.41, took: 1.46s
Epoch 11, 17.6%	 loss: 2.850 acc@1: 35.78 mrr: 52.57, ndcg: 58.54, took: 1.41s
Epoch 11, 26.4%	 loss: 2.845 acc@1: 37.50 mrr: 52.92, ndcg: 58.27, took: 1.43s
Epoch 11, 35.2%	 loss: 2.858 acc@1: 36.72 mrr: 52.35, ndcg: 57.60, took: 1.40s
Epoch 11, 44.1%	 loss: 2.878 acc@1: 38.28 mrr: 53.48, ndcg: 58.37, took: 1.47s
Epoch 11, 52.9%	 loss: 2.902 acc@1: 36.09 mrr: 51.55, ndcg: 56.60, took: 1.47s
Epoch 11, 61.7%	 loss: 2.956 acc@1: 33.12 mrr: 50.14, ndcg: 55.82, took: 1.37s
Epoch 11, 70.5%	 loss: 2.906 acc@1: 34.69 mrr: 51.51, ndcg: 57.01, took: 1.27s
Epoch 11, 79.3%	 loss: 2.955 acc@1: 33.75 mrr: 50.29, ndcg: 55.83, took: 1.15s
Epoch 11, 88.1%	 loss: 2.840 acc@1: 37.50 mrr: 53.03, ndcg: 58.12, took: 1.19s
Epoch 11, 96.9%	 loss: 2.949 acc@1: 37.50 mrr: 52.40, ndcg: 57.59, took: 1.28s
Validation - loss: 4.4394, acc@1: 35.96%, f1: 23.27%, mrr: 48.36%, ndcg: 52.41%
Current learning rate: 0.000175

=== Epoch 12 ===
Epoch 12, 8.8%	 loss: 2.866 acc@1: 35.16 mrr: 51.45, ndcg: 57.24, took: 1.48s
Epoch 12, 17.6%	 loss: 2.791 acc@1: 38.28 mrr: 53.89, ndcg: 58.85, took: 1.49s
Epoch 12, 26.4%	 loss: 2.783 acc@1: 39.38 mrr: 54.21, ndcg: 59.28, took: 1.41s
Epoch 12, 35.2%	 loss: 2.792 acc@1: 36.56 mrr: 52.61, ndcg: 58.07, took: 1.46s
Epoch 12, 44.1%	 loss: 2.987 acc@1: 35.16 mrr: 50.69, ndcg: 55.80, took: 1.49s
Epoch 12, 52.9%	 loss: 2.910 acc@1: 38.44 mrr: 52.67, ndcg: 57.17, took: 1.43s
Epoch 12, 61.7%	 loss: 2.724 acc@1: 38.75 mrr: 54.60, ndcg: 59.99, took: 1.48s
Epoch 12, 70.5%	 loss: 2.816 acc@1: 37.66 mrr: 53.67, ndcg: 58.97, took: 1.39s
Epoch 12, 79.3%	 loss: 2.952 acc@1: 34.22 mrr: 50.55, ndcg: 56.03, took: 1.42s
Epoch 12, 88.1%	 loss: 2.896 acc@1: 34.38 mrr: 50.77, ndcg: 56.42, took: 1.31s
Epoch 12, 96.9%	 loss: 2.825 acc@1: 37.66 mrr: 53.21, ndcg: 58.53, took: 1.31s
Validation - loss: 4.4483, acc@1: 36.05%, f1: 23.89%, mrr: 48.34%, ndcg: 52.40%
Current learning rate: 0.000175

=== Epoch 13 ===
Epoch 13, 8.8%	 loss: 2.734 acc@1: 36.88 mrr: 53.23, ndcg: 58.87, took: 1.49s
Epoch 13, 17.6%	 loss: 2.727 acc@1: 35.78 mrr: 52.98, ndcg: 58.95, took: 1.45s
Epoch 13, 26.4%	 loss: 2.842 acc@1: 37.97 mrr: 53.22, ndcg: 58.14, took: 1.39s
Epoch 13, 35.2%	 loss: 2.890 acc@1: 35.00 mrr: 51.13, ndcg: 56.93, took: 1.49s
Epoch 13, 44.1%	 loss: 2.794 acc@1: 37.50 mrr: 52.86, ndcg: 58.09, took: 1.37s
Epoch 13, 52.9%	 loss: 2.711 acc@1: 38.28 mrr: 54.05, ndcg: 59.34, took: 1.40s
Epoch 13, 61.7%	 loss: 2.845 acc@1: 37.19 mrr: 52.29, ndcg: 57.75, took: 1.43s
Epoch 13, 70.5%	 loss: 2.838 acc@1: 37.97 mrr: 52.69, ndcg: 57.77, took: 1.41s
Epoch 13, 79.3%	 loss: 2.709 acc@1: 35.62 mrr: 52.80, ndcg: 58.67, took: 1.47s
Epoch 13, 88.1%	 loss: 2.777 acc@1: 38.75 mrr: 54.04, ndcg: 59.09, took: 1.46s
Epoch 13, 96.9%	 loss: 2.812 acc@1: 35.00 mrr: 51.72, ndcg: 57.17, took: 1.49s
Validation - loss: 4.4720, acc@1: 35.96%, f1: 23.95%, mrr: 48.48%, ndcg: 52.54%
Current learning rate: 0.000175

=== Epoch 14 ===
Epoch 14, 8.8%	 loss: 2.859 acc@1: 34.53 mrr: 51.56, ndcg: 57.08, took: 1.20s
Epoch 14, 17.6%	 loss: 2.548 acc@1: 42.03 mrr: 57.40, ndcg: 62.96, took: 1.34s
Epoch 14, 26.4%	 loss: 2.645 acc@1: 38.28 mrr: 54.44, ndcg: 59.94, took: 1.34s
Epoch 14, 35.2%	 loss: 2.788 acc@1: 38.12 mrr: 53.17, ndcg: 58.40, took: 1.49s
Epoch 14, 44.1%	 loss: 2.682 acc@1: 38.28 mrr: 54.59, ndcg: 60.06, took: 1.43s
Epoch 14, 52.9%	 loss: 2.777 acc@1: 35.62 mrr: 52.01, ndcg: 57.44, took: 1.34s
Epoch 14, 61.7%	 loss: 2.753 acc@1: 38.91 mrr: 53.71, ndcg: 58.51, took: 1.42s
Epoch 14, 70.5%	 loss: 2.711 acc@1: 37.97 mrr: 53.51, ndcg: 58.98, took: 1.45s
Epoch 14, 79.3%	 loss: 2.775 acc@1: 35.78 mrr: 52.52, ndcg: 58.32, took: 1.37s
Epoch 14, 88.1%	 loss: 2.795 acc@1: 38.75 mrr: 53.48, ndcg: 58.57, took: 1.48s
Epoch 14, 96.9%	 loss: 2.713 acc@1: 37.34 mrr: 53.26, ndcg: 58.95, took: 1.52s
Validation - loss: 4.4525, acc@1: 38.22%, f1: 26.22%, mrr: 49.62%, ndcg: 53.30%
Current learning rate: 0.000175

=== Epoch 15 ===
Epoch 15, 8.8%	 loss: 2.705 acc@1: 39.22 mrr: 53.86, ndcg: 58.99, took: 1.32s
Epoch 15, 17.6%	 loss: 2.705 acc@1: 39.53 mrr: 54.42, ndcg: 59.68, took: 1.25s
Epoch 15, 26.4%	 loss: 2.685 acc@1: 38.75 mrr: 54.31, ndcg: 59.50, took: 1.26s
Epoch 15, 35.2%	 loss: 2.667 acc@1: 40.47 mrr: 55.46, ndcg: 60.24, took: 1.18s
Epoch 15, 44.1%	 loss: 2.806 acc@1: 37.34 mrr: 52.37, ndcg: 57.86, took: 1.30s
Epoch 15, 52.9%	 loss: 2.751 acc@1: 40.62 mrr: 54.39, ndcg: 59.14, took: 1.33s
Epoch 15, 61.7%	 loss: 2.577 acc@1: 40.94 mrr: 56.73, ndcg: 62.13, took: 1.29s
Epoch 15, 70.5%	 loss: 2.604 acc@1: 39.38 mrr: 55.45, ndcg: 60.93, took: 1.46s
Epoch 15, 79.3%	 loss: 2.703 acc@1: 40.94 mrr: 55.37, ndcg: 60.23, took: 1.43s
Epoch 15, 88.1%	 loss: 2.583 acc@1: 39.06 mrr: 55.42, ndcg: 61.10, took: 1.50s
Epoch 15, 96.9%	 loss: 2.739 acc@1: 36.09 mrr: 52.67, ndcg: 58.25, took: 1.49s
Validation - loss: 4.4914, acc@1: 37.32%, f1: 27.49%, mrr: 49.28%, ndcg: 53.13%
Current learning rate: 0.000018

=== Epoch 16 ===
Epoch 16, 8.8%	 loss: 3.023 acc@1: 34.22 mrr: 49.89, ndcg: 55.65, took: 1.43s
Epoch 16, 17.6%	 loss: 2.971 acc@1: 32.97 mrr: 49.95, ndcg: 55.47, took: 1.42s
Epoch 16, 26.4%	 loss: 2.672 acc@1: 40.94 mrr: 56.12, ndcg: 61.36, took: 1.34s
Epoch 16, 35.2%	 loss: 2.916 acc@1: 35.62 mrr: 51.73, ndcg: 57.26, took: 1.22s
Epoch 16, 44.1%	 loss: 2.902 acc@1: 37.81 mrr: 52.92, ndcg: 58.09, took: 1.18s
Epoch 16, 52.9%	 loss: 3.026 acc@1: 34.38 mrr: 49.92, ndcg: 55.32, took: 1.18s
Epoch 16, 61.7%	 loss: 2.925 acc@1: 36.25 mrr: 51.66, ndcg: 56.75, took: 1.19s
Epoch 16, 70.5%	 loss: 3.041 acc@1: 32.34 mrr: 48.84, ndcg: 54.53, took: 1.30s
Epoch 16, 79.3%	 loss: 2.624 acc@1: 40.00 mrr: 56.28, ndcg: 61.67, took: 1.38s
Epoch 16, 88.1%	 loss: 2.787 acc@1: 37.97 mrr: 53.45, ndcg: 58.85, took: 1.50s
Epoch 16, 96.9%	 loss: 2.919 acc@1: 37.97 mrr: 52.63, ndcg: 57.46, took: 1.51s
Validation - loss: 4.4052, acc@1: 35.99%, f1: 23.67%, mrr: 48.42%, ndcg: 52.49%
Current learning rate: 0.000018

=== Epoch 17 ===
Epoch 17, 8.8%	 loss: 2.891 acc@1: 34.38 mrr: 51.04, ndcg: 56.55, took: 1.58s
Epoch 17, 17.6%	 loss: 2.812 acc@1: 35.78 mrr: 52.79, ndcg: 58.47, took: 1.51s
Epoch 17, 26.4%	 loss: 2.841 acc@1: 37.97 mrr: 53.16, ndcg: 58.24, took: 1.44s
Epoch 17, 35.2%	 loss: 2.928 acc@1: 37.97 mrr: 52.64, ndcg: 57.41, took: 1.42s
Epoch 17, 44.1%	 loss: 2.854 acc@1: 37.19 mrr: 52.92, ndcg: 58.25, took: 1.28s
Epoch 17, 52.9%	 loss: 2.772 acc@1: 36.09 mrr: 52.68, ndcg: 58.16, took: 1.23s
Epoch 17, 61.7%	 loss: 2.937 acc@1: 36.72 mrr: 51.92, ndcg: 57.23, took: 1.25s
Epoch 17, 70.5%	 loss: 2.974 acc@1: 36.09 mrr: 51.24, ndcg: 56.33, took: 1.22s
Epoch 17, 79.3%	 loss: 3.005 acc@1: 34.53 mrr: 50.40, ndcg: 55.93, took: 1.24s
Epoch 17, 88.1%	 loss: 2.652 acc@1: 41.56 mrr: 56.52, ndcg: 61.70, took: 1.41s
Epoch 17, 96.9%	 loss: 3.021 acc@1: 34.69 mrr: 50.28, ndcg: 55.57, took: 1.42s
Validation - loss: 4.3984, acc@1: 35.80%, f1: 23.67%, mrr: 48.31%, ndcg: 52.41%
Current learning rate: 0.000018

=== Epoch 18 ===
Epoch 18, 8.8%	 loss: 2.920 acc@1: 36.41 mrr: 51.78, ndcg: 56.98, took: 1.48s
Epoch 18, 17.6%	 loss: 2.894 acc@1: 35.00 mrr: 51.41, ndcg: 57.10, took: 1.47s
Epoch 18, 26.4%	 loss: 2.803 acc@1: 40.16 mrr: 54.46, ndcg: 59.21, took: 1.45s
Epoch 18, 35.2%	 loss: 2.770 acc@1: 37.50 mrr: 53.57, ndcg: 58.85, took: 1.40s
Epoch 18, 44.1%	 loss: 2.789 acc@1: 37.50 mrr: 53.08, ndcg: 58.64, took: 1.32s
Epoch 18, 52.9%	 loss: 2.906 acc@1: 37.66 mrr: 52.75, ndcg: 57.85, took: 1.39s
Epoch 18, 61.7%	 loss: 2.916 acc@1: 39.53 mrr: 53.55, ndcg: 58.40, took: 1.31s
Epoch 18, 70.5%	 loss: 2.798 acc@1: 36.25 mrr: 52.78, ndcg: 58.22, took: 1.29s
Epoch 18, 79.3%	 loss: 2.900 acc@1: 36.09 mrr: 51.72, ndcg: 56.84, took: 1.34s
Epoch 18, 88.1%	 loss: 2.903 acc@1: 35.62 mrr: 51.39, ndcg: 57.09, took: 1.43s
Epoch 18, 96.9%	 loss: 2.820 acc@1: 36.72 mrr: 52.79, ndcg: 58.53, took: 1.38s
Validation - loss: 4.3983, acc@1: 35.73%, f1: 23.67%, mrr: 48.26%, ndcg: 52.33%
Current learning rate: 0.000018

=== Epoch 19 ===
Epoch 19, 8.8%	 loss: 2.729 acc@1: 38.75 mrr: 54.62, ndcg: 60.11, took: 1.55s
Epoch 19, 17.6%	 loss: 2.834 acc@1: 38.28 mrr: 53.44, ndcg: 58.56, took: 1.40s
Epoch 19, 26.4%	 loss: 3.078 acc@1: 32.66 mrr: 48.49, ndcg: 53.69, took: 1.43s
Epoch 19, 35.2%	 loss: 2.818 acc@1: 35.94 mrr: 52.22, ndcg: 57.51, took: 1.40s
Epoch 19, 44.1%	 loss: 2.814 acc@1: 38.12 mrr: 53.44, ndcg: 59.09, took: 1.36s
Epoch 19, 52.9%	 loss: 2.840 acc@1: 35.31 mrr: 51.83, ndcg: 57.47, took: 1.38s
Epoch 19, 61.7%	 loss: 2.773 acc@1: 38.28 mrr: 53.53, ndcg: 58.69, took: 1.22s
Epoch 19, 70.5%	 loss: 2.699 acc@1: 38.91 mrr: 54.55, ndcg: 59.82, took: 1.35s
Epoch 19, 79.3%	 loss: 2.894 acc@1: 34.53 mrr: 50.98, ndcg: 56.75, took: 1.38s
Epoch 19, 88.1%	 loss: 2.923 acc@1: 36.88 mrr: 52.04, ndcg: 56.99, took: 1.52s
Epoch 19, 96.9%	 loss: 2.922 acc@1: 35.94 mrr: 51.58, ndcg: 56.55, took: 1.44s
Validation - loss: 4.3949, acc@1: 35.89%, f1: 23.74%, mrr: 48.37%, ndcg: 52.41%
Current learning rate: 0.000018

=== Epoch 20 ===
Epoch 20, 8.8%	 loss: 2.941 acc@1: 33.59 mrr: 49.58, ndcg: 54.90, took: 1.37s
Epoch 20, 17.6%	 loss: 2.761 acc@1: 39.69 mrr: 54.54, ndcg: 59.64, took: 1.35s
Epoch 20, 26.4%	 loss: 3.061 acc@1: 31.25 mrr: 48.51, ndcg: 54.23, took: 1.31s
Epoch 20, 35.2%	 loss: 2.780 acc@1: 39.84 mrr: 54.63, ndcg: 59.90, took: 1.33s
Epoch 20, 44.1%	 loss: 2.773 acc@1: 38.75 mrr: 54.24, ndcg: 59.65, took: 1.35s
Epoch 20, 52.9%	 loss: 2.834 acc@1: 36.41 mrr: 52.59, ndcg: 57.72, took: 1.29s
Epoch 20, 61.7%	 loss: 2.880 acc@1: 33.75 mrr: 50.87, ndcg: 56.71, took: 1.34s
Epoch 20, 70.5%	 loss: 2.924 acc@1: 36.72 mrr: 51.30, ndcg: 55.95, took: 1.37s
Epoch 20, 79.3%	 loss: 2.815 acc@1: 37.97 mrr: 53.32, ndcg: 58.72, took: 1.39s
Epoch 20, 88.1%	 loss: 2.713 acc@1: 40.62 mrr: 55.67, ndcg: 60.64, took: 1.47s
Epoch 20, 96.9%	 loss: 2.758 acc@1: 38.28 mrr: 54.38, ndcg: 60.02, took: 1.46s
Validation - loss: 4.3862, acc@1: 35.67%, f1: 23.57%, mrr: 48.24%, ndcg: 52.32%
Current learning rate: 0.000018

=== Epoch 21 ===
Epoch 21, 8.8%	 loss: 2.849 acc@1: 38.91 mrr: 53.48, ndcg: 58.54, took: 1.18s
Epoch 21, 17.6%	 loss: 2.790 acc@1: 38.28 mrr: 53.78, ndcg: 59.03, took: 1.25s
Epoch 21, 26.4%	 loss: 2.955 acc@1: 34.84 mrr: 50.31, ndcg: 55.66, took: 1.26s
Epoch 21, 35.2%	 loss: 2.878 acc@1: 34.06 mrr: 50.72, ndcg: 56.72, took: 1.17s
Epoch 21, 44.1%	 loss: 2.918 acc@1: 36.25 mrr: 51.88, ndcg: 57.53, took: 1.24s
Epoch 21, 52.9%	 loss: 2.849 acc@1: 37.66 mrr: 53.06, ndcg: 58.21, took: 1.15s
Epoch 21, 61.7%	 loss: 2.888 acc@1: 35.62 mrr: 51.45, ndcg: 57.15, took: 1.28s
Epoch 21, 70.5%	 loss: 2.828 acc@1: 37.97 mrr: 53.50, ndcg: 58.53, took: 1.47s
Epoch 21, 79.3%	 loss: 2.937 acc@1: 35.16 mrr: 51.09, ndcg: 56.87, took: 1.56s
Epoch 21, 88.1%	 loss: 2.611 acc@1: 39.38 mrr: 55.78, ndcg: 61.51, took: 1.53s
Epoch 21, 96.9%	 loss: 2.822 acc@1: 38.28 mrr: 53.44, ndcg: 58.50, took: 1.58s
Validation - loss: 4.4155, acc@1: 35.92%, f1: 23.92%, mrr: 48.43%, ndcg: 52.50%
Current learning rate: 0.000018

=== Epoch 22 ===
Epoch 22, 8.8%	 loss: 2.851 acc@1: 38.75 mrr: 53.27, ndcg: 58.20, took: 1.40s
Epoch 22, 17.6%	 loss: 2.729 acc@1: 38.12 mrr: 54.47, ndcg: 60.05, took: 1.42s
Epoch 22, 26.4%	 loss: 2.872 acc@1: 37.03 mrr: 52.80, ndcg: 58.13, took: 1.34s
Epoch 22, 35.2%	 loss: 2.859 acc@1: 34.38 mrr: 51.06, ndcg: 56.44, took: 1.34s
Epoch 22, 44.1%	 loss: 2.816 acc@1: 36.25 mrr: 52.32, ndcg: 57.86, took: 1.32s
Epoch 22, 52.9%	 loss: 2.902 acc@1: 37.03 mrr: 52.00, ndcg: 57.04, took: 1.29s
Epoch 22, 61.7%	 loss: 2.995 acc@1: 36.25 mrr: 51.23, ndcg: 56.40, took: 1.27s
Epoch 22, 70.5%	 loss: 2.842 acc@1: 35.00 mrr: 51.44, ndcg: 56.97, took: 1.30s
Epoch 22, 79.3%	 loss: 2.947 acc@1: 35.16 mrr: 51.22, ndcg: 56.54, took: 1.30s
Epoch 22, 88.1%	 loss: 2.838 acc@1: 36.56 mrr: 52.54, ndcg: 57.92, took: 1.48s
Epoch 22, 96.9%	 loss: 2.728 acc@1: 37.34 mrr: 53.76, ndcg: 59.45, took: 1.57s
Validation - loss: 4.4273, acc@1: 36.11%, f1: 24.18%, mrr: 48.47%, ndcg: 52.53%
Current learning rate: 0.000018

=== Epoch 23 ===
Epoch 23, 8.8%	 loss: 2.886 acc@1: 33.75 mrr: 50.65, ndcg: 56.66, took: 1.45s
Epoch 23, 17.6%	 loss: 2.858 acc@1: 35.94 mrr: 52.59, ndcg: 58.28, took: 1.32s
Epoch 23, 26.4%	 loss: 2.591 acc@1: 43.12 mrr: 58.05, ndcg: 62.99, took: 1.34s
Epoch 23, 35.2%	 loss: 2.889 acc@1: 38.12 mrr: 53.06, ndcg: 57.85, took: 1.20s
Epoch 23, 44.1%	 loss: 2.833 acc@1: 36.72 mrr: 52.44, ndcg: 57.87, took: 1.27s
Epoch 23, 52.9%	 loss: 2.969 acc@1: 33.91 mrr: 49.83, ndcg: 55.94, took: 1.32s
Epoch 23, 61.7%	 loss: 2.755 acc@1: 39.84 mrr: 54.54, ndcg: 59.42, took: 1.37s
Epoch 23, 70.5%	 loss: 2.816 acc@1: 40.31 mrr: 54.76, ndcg: 59.46, took: 1.55s
Epoch 23, 79.3%	 loss: 2.735 acc@1: 36.88 mrr: 53.48, ndcg: 58.82, took: 1.43s
Epoch 23, 88.1%	 loss: 2.954 acc@1: 34.22 mrr: 50.31, ndcg: 56.26, took: 1.35s
Epoch 23, 96.9%	 loss: 2.953 acc@1: 34.69 mrr: 50.58, ndcg: 56.07, took: 1.29s
Validation - loss: 4.4058, acc@1: 35.96%, f1: 23.68%, mrr: 48.42%, ndcg: 52.51%
Current learning rate: 0.000018

=== Epoch 24 ===
Epoch 24, 8.8%	 loss: 2.879 acc@1: 36.41 mrr: 51.81, ndcg: 57.10, took: 1.54s
Epoch 24, 17.6%	 loss: 2.787 acc@1: 37.50 mrr: 53.57, ndcg: 58.88, took: 1.44s
Epoch 24, 26.4%	 loss: 2.877 acc@1: 34.06 mrr: 51.07, ndcg: 56.66, took: 1.54s
Epoch 24, 35.2%	 loss: 2.844 acc@1: 38.28 mrr: 52.94, ndcg: 58.31, took: 1.60s
Epoch 24, 44.1%	 loss: 2.756 acc@1: 40.31 mrr: 55.15, ndcg: 60.48, took: 1.33s
Epoch 24, 52.9%	 loss: 2.881 acc@1: 35.94 mrr: 52.00, ndcg: 57.16, took: 1.51s
Epoch 24, 61.7%	 loss: 2.779 acc@1: 37.34 mrr: 53.06, ndcg: 58.52, took: 1.45s
Epoch 24, 70.5%	 loss: 2.835 acc@1: 40.78 mrr: 54.75, ndcg: 59.67, took: 1.61s
Epoch 24, 79.3%	 loss: 2.699 acc@1: 36.41 mrr: 53.12, ndcg: 59.13, took: 1.64s
Epoch 24, 88.1%	 loss: 2.961 acc@1: 35.94 mrr: 51.10, ndcg: 55.99, took: 1.60s
Epoch 24, 96.9%	 loss: 2.647 acc@1: 39.69 mrr: 55.11, ndcg: 60.46, took: 1.48s
Validation - loss: 4.4353, acc@1: 36.08%, f1: 24.01%, mrr: 48.48%, ndcg: 52.56%
Current learning rate: 0.000018

=== Epoch 25 ===
Epoch 25, 8.8%	 loss: 2.781 acc@1: 34.84 mrr: 51.60, ndcg: 57.32, took: 1.53s
Epoch 25, 17.6%	 loss: 2.815 acc@1: 37.19 mrr: 52.77, ndcg: 58.06, took: 1.34s
Epoch 25, 26.4%	 loss: 2.715 acc@1: 38.59 mrr: 53.97, ndcg: 59.27, took: 1.42s
Epoch 25, 35.2%	 loss: 2.869 acc@1: 35.78 mrr: 51.67, ndcg: 57.28, took: 1.41s
Epoch 25, 44.1%	 loss: 2.866 acc@1: 35.62 mrr: 51.95, ndcg: 57.09, took: 1.64s
Epoch 25, 52.9%	 loss: 2.768 acc@1: 39.53 mrr: 54.44, ndcg: 59.44, took: 1.70s
Epoch 25, 61.7%	 loss: 2.882 acc@1: 37.34 mrr: 52.47, ndcg: 57.72, took: 1.48s
Epoch 25, 70.5%	 loss: 2.899 acc@1: 36.56 mrr: 52.03, ndcg: 56.99, took: 1.53s
Epoch 25, 79.3%	 loss: 2.824 acc@1: 33.91 mrr: 51.03, ndcg: 56.70, took: 1.55s
Epoch 25, 88.1%	 loss: 2.686 acc@1: 39.38 mrr: 55.34, ndcg: 60.81, took: 1.52s
Epoch 25, 96.9%	 loss: 2.774 acc@1: 35.94 mrr: 52.63, ndcg: 58.08, took: 1.50s
Validation - loss: 4.4133, acc@1: 36.15%, f1: 23.99%, mrr: 48.46%, ndcg: 52.56%
Training finished.	 Time: 517.83s.	 acc@1: 35.67%

=== Test Results ===
Test Results:
  acc@1: 32.10%
  acc@5: 55.17%
  acc@10: 59.22%
  mrr: 43.04%
  ndcg: 46.71%
  f1: 20.07%

=== Training Complete ===
