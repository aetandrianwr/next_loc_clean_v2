Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/config/ht_optuna/optuna_MHSA_geolife_prev7_t3_20251231_152825_0edcc587.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=232, val=105, test=110
Total trainable parameters: 513315

=== Epoch 1 ===
Epoch 1, 8.6%	 loss: 7.147 acc@1: 0.16 mrr: 0.69, ndcg: 0.49, took: 2.70s
Epoch 1, 17.2%	 loss: 7.151 acc@1: 0.16 mrr: 0.61, ndcg: 0.32, took: 1.54s
Epoch 1, 25.9%	 loss: 7.119 acc@1: 0.31 mrr: 0.86, ndcg: 0.62, took: 1.53s
Epoch 1, 34.5%	 loss: 7.121 acc@1: 0.00 mrr: 0.56, ndcg: 0.38, took: 1.52s
Epoch 1, 43.1%	 loss: 7.089 acc@1: 0.00 mrr: 0.69, ndcg: 0.34, took: 1.51s
Epoch 1, 51.7%	 loss: 7.096 acc@1: 0.16 mrr: 0.75, ndcg: 0.42, took: 1.57s
Epoch 1, 60.3%	 loss: 7.054 acc@1: 0.00 mrr: 1.01, ndcg: 0.82, took: 1.51s
Epoch 1, 69.0%	 loss: 7.031 acc@1: 0.47 mrr: 1.49, ndcg: 1.31, took: 1.51s
Epoch 1, 77.6%	 loss: 7.011 acc@1: 0.94 mrr: 2.65, ndcg: 2.72, took: 1.60s
Epoch 1, 86.2%	 loss: 6.948 acc@1: 2.34 mrr: 4.34, ndcg: 4.66, took: 1.53s
Epoch 1, 94.8%	 loss: 6.904 acc@1: 3.59 mrr: 7.66, ndcg: 8.83, took: 1.46s
Validation - loss: 6.7731, acc@1: 15.00%, f1: 10.04%, mrr: 19.08%, ndcg: 20.21%
Current learning rate: 0.000250

=== Epoch 2 ===
Epoch 2, 8.6%	 loss: 6.696 acc@1: 14.84 mrr: 19.69, ndcg: 20.52, took: 1.24s
Epoch 2, 17.2%	 loss: 6.579 acc@1: 18.59 mrr: 24.22, ndcg: 25.44, took: 1.35s
Epoch 2, 25.9%	 loss: 6.474 acc@1: 17.97 mrr: 24.08, ndcg: 25.91, took: 1.53s
Epoch 2, 34.5%	 loss: 6.342 acc@1: 21.25 mrr: 27.15, ndcg: 28.96, took: 1.55s
Epoch 2, 43.1%	 loss: 6.180 acc@1: 21.25 mrr: 28.40, ndcg: 30.50, took: 1.55s
Epoch 2, 51.7%	 loss: 6.055 acc@1: 21.09 mrr: 28.31, ndcg: 30.60, took: 1.54s
Epoch 2, 60.3%	 loss: 5.827 acc@1: 21.41 mrr: 30.75, ndcg: 34.01, took: 1.56s
Epoch 2, 69.0%	 loss: 5.621 acc@1: 23.59 mrr: 32.74, ndcg: 36.40, took: 1.56s
Epoch 2, 77.6%	 loss: 5.681 acc@1: 22.66 mrr: 31.41, ndcg: 35.01, took: 1.53s
Epoch 2, 86.2%	 loss: 5.471 acc@1: 23.12 mrr: 33.58, ndcg: 37.39, took: 1.45s
Epoch 2, 94.8%	 loss: 5.407 acc@1: 22.81 mrr: 33.27, ndcg: 37.46, took: 1.42s
Validation - loss: 5.2914, acc@1: 24.51%, f1: 16.64%, mrr: 35.35%, ndcg: 39.99%
Current learning rate: 0.000500

=== Epoch 3 ===
Epoch 3, 8.6%	 loss: 5.168 acc@1: 24.84 mrr: 35.59, ndcg: 40.03, took: 1.32s
Epoch 3, 17.2%	 loss: 5.087 acc@1: 21.88 mrr: 34.42, ndcg: 39.67, took: 1.22s
Epoch 3, 25.9%	 loss: 4.856 acc@1: 28.44 mrr: 39.91, ndcg: 45.04, took: 1.22s
Epoch 3, 34.5%	 loss: 4.805 acc@1: 23.44 mrr: 36.58, ndcg: 42.12, took: 1.27s
Epoch 3, 43.1%	 loss: 4.635 acc@1: 28.75 mrr: 39.92, ndcg: 44.54, took: 1.37s
Epoch 3, 51.7%	 loss: 4.644 acc@1: 28.12 mrr: 39.65, ndcg: 44.20, took: 1.54s
Epoch 3, 60.3%	 loss: 4.724 acc@1: 25.16 mrr: 37.21, ndcg: 42.06, took: 1.57s
Epoch 3, 69.0%	 loss: 4.383 acc@1: 31.25 mrr: 42.72, ndcg: 47.33, took: 1.57s
Epoch 3, 77.6%	 loss: 4.391 acc@1: 32.19 mrr: 43.05, ndcg: 47.37, took: 1.50s
Epoch 3, 86.2%	 loss: 4.388 acc@1: 27.66 mrr: 40.14, ndcg: 45.21, took: 1.53s
Epoch 3, 94.8%	 loss: 4.085 acc@1: 34.06 mrr: 45.29, ndcg: 49.84, took: 1.36s
Validation - loss: 4.4605, acc@1: 30.20%, f1: 19.79%, mrr: 41.10%, ndcg: 45.31%
Current learning rate: 0.000490

=== Epoch 4 ===
Epoch 4, 8.6%	 loss: 4.054 acc@1: 32.66 mrr: 44.87, ndcg: 49.41, took: 1.52s
Epoch 4, 17.2%	 loss: 3.995 acc@1: 32.97 mrr: 44.81, ndcg: 49.27, took: 1.43s
Epoch 4, 25.9%	 loss: 4.029 acc@1: 30.31 mrr: 43.23, ndcg: 48.08, took: 1.35s
Epoch 4, 34.5%	 loss: 3.960 acc@1: 32.66 mrr: 44.59, ndcg: 48.83, took: 1.23s
Epoch 4, 43.1%	 loss: 3.976 acc@1: 36.72 mrr: 46.43, ndcg: 49.52, took: 1.27s
Epoch 4, 51.7%	 loss: 3.826 acc@1: 34.84 mrr: 46.76, ndcg: 51.17, took: 1.29s
Epoch 4, 60.3%	 loss: 3.924 acc@1: 33.12 mrr: 45.11, ndcg: 49.47, took: 1.32s
Epoch 4, 69.0%	 loss: 3.700 acc@1: 34.84 mrr: 47.28, ndcg: 51.33, took: 1.45s
Epoch 4, 77.6%	 loss: 3.798 acc@1: 32.81 mrr: 45.35, ndcg: 49.95, took: 1.50s
Epoch 4, 86.2%	 loss: 3.721 acc@1: 36.72 mrr: 48.20, ndcg: 52.20, took: 1.45s
Epoch 4, 94.8%	 loss: 3.845 acc@1: 32.34 mrr: 45.26, ndcg: 49.63, took: 1.28s
Validation - loss: 4.2516, acc@1: 35.87%, f1: 22.67%, mrr: 46.21%, ndcg: 49.88%
Current learning rate: 0.000479

=== Epoch 5 ===
Epoch 5, 8.6%	 loss: 3.601 acc@1: 35.31 mrr: 47.69, ndcg: 51.49, took: 1.57s
Epoch 5, 17.2%	 loss: 3.340 acc@1: 39.22 mrr: 51.79, ndcg: 56.14, took: 1.56s
Epoch 5, 25.9%	 loss: 3.658 acc@1: 33.12 mrr: 46.34, ndcg: 51.18, took: 1.55s
Epoch 5, 34.5%	 loss: 3.348 acc@1: 37.50 mrr: 50.51, ndcg: 55.04, took: 1.41s
Epoch 5, 43.1%	 loss: 3.548 acc@1: 36.88 mrr: 48.93, ndcg: 53.39, took: 1.42s
Epoch 5, 51.7%	 loss: 3.829 acc@1: 32.66 mrr: 44.85, ndcg: 48.98, took: 1.28s
Epoch 5, 60.3%	 loss: 3.614 acc@1: 33.44 mrr: 46.93, ndcg: 51.74, took: 1.21s
Epoch 5, 69.0%	 loss: 3.617 acc@1: 35.94 mrr: 48.12, ndcg: 52.32, took: 1.24s
Epoch 5, 77.6%	 loss: 3.363 acc@1: 40.00 mrr: 52.42, ndcg: 56.76, took: 1.30s
Epoch 5, 86.2%	 loss: 3.531 acc@1: 35.62 mrr: 48.54, ndcg: 52.76, took: 1.22s
Epoch 5, 94.8%	 loss: 3.570 acc@1: 35.94 mrr: 48.58, ndcg: 52.87, took: 1.27s
Validation - loss: 4.3089, acc@1: 36.29%, f1: 24.37%, mrr: 46.43%, ndcg: 50.12%
Current learning rate: 0.000469

=== Epoch 6 ===
Epoch 6, 8.6%	 loss: 3.395 acc@1: 39.53 mrr: 51.07, ndcg: 54.56, took: 1.58s
Epoch 6, 17.2%	 loss: 3.438 acc@1: 36.72 mrr: 48.99, ndcg: 53.11, took: 1.57s
Epoch 6, 25.9%	 loss: 3.045 acc@1: 39.84 mrr: 54.22, ndcg: 59.19, took: 1.58s
Epoch 6, 34.5%	 loss: 3.407 acc@1: 36.88 mrr: 49.28, ndcg: 53.74, took: 1.58s
Epoch 6, 43.1%	 loss: 3.468 acc@1: 38.44 mrr: 50.08, ndcg: 54.15, took: 1.53s
Epoch 6, 51.7%	 loss: 3.237 acc@1: 38.75 mrr: 51.94, ndcg: 56.25, took: 1.43s
Epoch 6, 60.3%	 loss: 3.446 acc@1: 38.75 mrr: 50.05, ndcg: 53.50, took: 1.38s
Epoch 6, 69.0%	 loss: 3.408 acc@1: 37.03 mrr: 50.00, ndcg: 54.21, took: 1.35s
Epoch 6, 77.6%	 loss: 3.207 acc@1: 41.88 mrr: 53.51, ndcg: 57.57, took: 1.24s
Epoch 6, 86.2%	 loss: 3.396 acc@1: 36.72 mrr: 49.38, ndcg: 53.75, took: 1.18s
Epoch 6, 94.8%	 loss: 3.259 acc@1: 39.84 mrr: 52.01, ndcg: 56.36, took: 1.19s
Validation - loss: 4.2742, acc@1: 37.22%, f1: 25.50%, mrr: 47.93%, ndcg: 51.69%
Current learning rate: 0.000458

=== Epoch 7 ===
Epoch 7, 8.6%	 loss: 3.040 acc@1: 45.94 mrr: 56.31, ndcg: 59.61, took: 1.53s
Epoch 7, 17.2%	 loss: 3.236 acc@1: 37.81 mrr: 51.07, ndcg: 55.18, took: 1.61s
Epoch 7, 25.9%	 loss: 3.182 acc@1: 40.47 mrr: 52.59, ndcg: 56.46, took: 1.58s
Epoch 7, 34.5%	 loss: 3.216 acc@1: 39.38 mrr: 51.98, ndcg: 56.19, took: 1.58s
Epoch 7, 43.1%	 loss: 3.273 acc@1: 40.47 mrr: 51.96, ndcg: 55.55, took: 1.55s
Epoch 7, 51.7%	 loss: 3.211 acc@1: 39.22 mrr: 51.97, ndcg: 56.22, took: 1.50s
Epoch 7, 60.3%	 loss: 3.098 acc@1: 41.72 mrr: 54.00, ndcg: 57.96, took: 1.49s
Epoch 7, 69.0%	 loss: 3.046 acc@1: 42.03 mrr: 53.90, ndcg: 58.29, took: 1.40s
Epoch 7, 77.6%	 loss: 3.112 acc@1: 42.19 mrr: 53.70, ndcg: 57.46, took: 1.33s
Epoch 7, 86.2%	 loss: 3.049 acc@1: 39.53 mrr: 53.28, ndcg: 57.85, took: 1.24s
Epoch 7, 94.8%	 loss: 3.128 acc@1: 38.59 mrr: 52.41, ndcg: 56.62, took: 1.16s
Validation - loss: 4.2727, acc@1: 37.97%, f1: 26.98%, mrr: 48.35%, ndcg: 52.08%
Current learning rate: 0.000448

=== Epoch 8 ===
Epoch 8, 8.6%	 loss: 2.896 acc@1: 45.94 mrr: 57.03, ndcg: 60.57, took: 1.61s
Epoch 8, 17.2%	 loss: 2.929 acc@1: 41.72 mrr: 55.09, ndcg: 59.65, took: 1.57s
Epoch 8, 25.9%	 loss: 3.061 acc@1: 40.31 mrr: 52.99, ndcg: 57.09, took: 1.54s
Epoch 8, 34.5%	 loss: 3.133 acc@1: 38.44 mrr: 51.32, ndcg: 56.03, took: 1.53s
Epoch 8, 43.1%	 loss: 2.888 acc@1: 42.50 mrr: 55.64, ndcg: 60.00, took: 1.46s
Epoch 8, 51.7%	 loss: 2.927 acc@1: 42.97 mrr: 55.66, ndcg: 59.87, took: 1.49s
Epoch 8, 60.3%	 loss: 3.192 acc@1: 41.09 mrr: 52.58, ndcg: 56.44, took: 1.55s
Epoch 8, 69.0%	 loss: 2.838 acc@1: 45.31 mrr: 57.56, ndcg: 61.59, took: 1.49s
Epoch 8, 77.6%	 loss: 3.037 acc@1: 40.47 mrr: 53.17, ndcg: 57.25, took: 1.35s
Epoch 8, 86.2%	 loss: 2.803 acc@1: 46.09 mrr: 57.72, ndcg: 61.76, took: 1.22s
Epoch 8, 94.8%	 loss: 3.146 acc@1: 40.62 mrr: 52.49, ndcg: 56.42, took: 1.25s
Validation - loss: 4.3397, acc@1: 36.74%, f1: 25.68%, mrr: 47.72%, ndcg: 51.60%
Current learning rate: 0.000438

=== Epoch 9 ===
Epoch 9, 8.6%	 loss: 2.819 acc@1: 45.16 mrr: 57.09, ndcg: 60.89, took: 1.49s
Epoch 9, 17.2%	 loss: 2.721 acc@1: 45.47 mrr: 58.07, ndcg: 62.09, took: 1.55s
Epoch 9, 25.9%	 loss: 2.678 acc@1: 47.66 mrr: 59.36, ndcg: 63.26, took: 1.53s
Epoch 9, 34.5%	 loss: 2.990 acc@1: 40.00 mrr: 53.16, ndcg: 57.90, took: 1.54s
Epoch 9, 43.1%	 loss: 2.829 acc@1: 44.22 mrr: 56.54, ndcg: 61.01, took: 1.54s
Epoch 9, 51.7%	 loss: 2.931 acc@1: 44.38 mrr: 55.19, ndcg: 58.90, took: 1.48s
Epoch 9, 60.3%	 loss: 2.828 acc@1: 44.38 mrr: 56.97, ndcg: 61.51, took: 1.55s
Epoch 9, 69.0%	 loss: 3.009 acc@1: 43.12 mrr: 54.26, ndcg: 57.83, took: 1.48s
Epoch 9, 77.6%	 loss: 2.765 acc@1: 47.50 mrr: 58.60, ndcg: 62.47, took: 1.31s
Epoch 9, 86.2%	 loss: 2.896 acc@1: 44.38 mrr: 55.57, ndcg: 59.55, took: 1.30s
Epoch 9, 94.8%	 loss: 2.901 acc@1: 43.12 mrr: 55.18, ndcg: 59.32, took: 1.19s
Validation - loss: 4.3124, acc@1: 41.27%, f1: 30.57%, mrr: 50.40%, ndcg: 53.71%
Current learning rate: 0.000043

=== Epoch 10 ===
Epoch 10, 8.6%	 loss: 3.690 acc@1: 33.59 mrr: 46.25, ndcg: 50.47, took: 1.31s
Epoch 10, 17.2%	 loss: 3.652 acc@1: 35.62 mrr: 47.54, ndcg: 51.50, took: 1.25s
Epoch 10, 25.9%	 loss: 3.603 acc@1: 33.91 mrr: 46.86, ndcg: 51.27, took: 1.39s
Epoch 10, 34.5%	 loss: 3.624 acc@1: 34.22 mrr: 47.10, ndcg: 51.46, took: 1.51s
Epoch 10, 43.1%	 loss: 3.575 acc@1: 36.56 mrr: 48.61, ndcg: 52.53, took: 1.51s
Epoch 10, 51.7%	 loss: 3.520 acc@1: 36.41 mrr: 49.22, ndcg: 53.45, took: 1.50s
Epoch 10, 60.3%	 loss: 3.593 acc@1: 36.41 mrr: 48.45, ndcg: 52.49, took: 1.53s
Epoch 10, 69.0%	 loss: 3.637 acc@1: 34.53 mrr: 47.34, ndcg: 51.68, took: 1.44s
Epoch 10, 77.6%	 loss: 3.622 acc@1: 37.97 mrr: 49.44, ndcg: 53.33, took: 1.40s
Epoch 10, 86.2%	 loss: 3.325 acc@1: 38.91 mrr: 51.55, ndcg: 56.08, took: 1.30s
Epoch 10, 94.8%	 loss: 3.433 acc@1: 38.59 mrr: 50.82, ndcg: 55.05, took: 1.34s
Validation - loss: 4.1963, acc@1: 37.04%, f1: 23.81%, mrr: 47.17%, ndcg: 50.76%
Current learning rate: 0.000043

=== Epoch 11 ===
Epoch 11, 8.6%	 loss: 3.699 acc@1: 33.44 mrr: 46.41, ndcg: 50.54, took: 1.33s
Epoch 11, 17.2%	 loss: 3.506 acc@1: 36.09 mrr: 48.76, ndcg: 52.84, took: 1.22s
Epoch 11, 25.9%	 loss: 3.327 acc@1: 39.53 mrr: 51.51, ndcg: 55.30, took: 1.25s
Epoch 11, 34.5%	 loss: 3.497 acc@1: 37.81 mrr: 49.74, ndcg: 53.73, took: 1.29s
Epoch 11, 43.1%	 loss: 3.479 acc@1: 38.59 mrr: 50.14, ndcg: 54.12, took: 1.29s
Epoch 11, 51.7%	 loss: 3.487 acc@1: 34.84 mrr: 48.27, ndcg: 52.79, took: 1.47s
Epoch 11, 60.3%	 loss: 3.524 acc@1: 37.81 mrr: 49.40, ndcg: 53.61, took: 1.48s
Epoch 11, 69.0%	 loss: 3.416 acc@1: 39.53 mrr: 51.55, ndcg: 55.38, took: 1.46s
Epoch 11, 77.6%	 loss: 3.413 acc@1: 38.91 mrr: 50.84, ndcg: 54.82, took: 1.40s
Epoch 11, 86.2%	 loss: 3.758 acc@1: 32.66 mrr: 45.22, ndcg: 49.46, took: 1.34s
Epoch 11, 94.8%	 loss: 3.655 acc@1: 33.28 mrr: 45.97, ndcg: 50.18, took: 1.38s
Validation - loss: 4.2136, acc@1: 37.25%, f1: 24.13%, mrr: 47.37%, ndcg: 50.93%
Current learning rate: 0.000043

=== Epoch 12 ===
Epoch 12, 8.6%	 loss: 3.551 acc@1: 36.72 mrr: 48.74, ndcg: 52.84, took: 1.44s
Epoch 12, 17.2%	 loss: 3.401 acc@1: 40.62 mrr: 51.91, ndcg: 55.65, took: 1.36s
Epoch 12, 25.9%	 loss: 3.397 acc@1: 37.97 mrr: 50.74, ndcg: 54.62, took: 1.41s
Epoch 12, 34.5%	 loss: 3.449 acc@1: 36.56 mrr: 49.51, ndcg: 53.88, took: 1.25s
Epoch 12, 43.1%	 loss: 3.474 acc@1: 36.25 mrr: 48.90, ndcg: 52.89, took: 1.29s
Epoch 12, 51.7%	 loss: 3.715 acc@1: 34.22 mrr: 46.48, ndcg: 50.79, took: 1.32s
Epoch 12, 60.3%	 loss: 3.431 acc@1: 38.28 mrr: 50.60, ndcg: 54.73, took: 1.26s
Epoch 12, 69.0%	 loss: 3.633 acc@1: 36.56 mrr: 47.82, ndcg: 51.66, took: 1.17s
Epoch 12, 77.6%	 loss: 3.629 acc@1: 33.75 mrr: 46.52, ndcg: 51.04, took: 1.30s
Epoch 12, 86.2%	 loss: 3.381 acc@1: 38.75 mrr: 51.36, ndcg: 55.52, took: 1.36s
Epoch 12, 94.8%	 loss: 3.390 acc@1: 38.75 mrr: 51.15, ndcg: 55.00, took: 1.42s
Validation - loss: 4.2061, acc@1: 37.49%, f1: 24.49%, mrr: 47.59%, ndcg: 51.16%
Current learning rate: 0.000043

=== Epoch 13 ===
Epoch 13, 8.6%	 loss: 3.361 acc@1: 39.22 mrr: 51.31, ndcg: 55.47, took: 1.56s
Epoch 13, 17.2%	 loss: 3.538 acc@1: 37.50 mrr: 49.24, ndcg: 53.06, took: 1.48s
Epoch 13, 25.9%	 loss: 3.336 acc@1: 39.69 mrr: 51.95, ndcg: 56.03, took: 1.40s
Epoch 13, 34.5%	 loss: 3.328 acc@1: 39.38 mrr: 51.93, ndcg: 55.84, took: 1.41s
Epoch 13, 43.1%	 loss: 3.570 acc@1: 33.75 mrr: 46.89, ndcg: 51.36, took: 1.41s
Epoch 13, 51.7%	 loss: 3.471 acc@1: 37.19 mrr: 49.74, ndcg: 54.19, took: 1.42s
Epoch 13, 60.3%	 loss: 3.495 acc@1: 35.47 mrr: 48.79, ndcg: 53.20, took: 1.22s
Epoch 13, 69.0%	 loss: 3.584 acc@1: 36.41 mrr: 48.20, ndcg: 52.14, took: 1.13s
Epoch 13, 77.6%	 loss: 3.505 acc@1: 35.00 mrr: 48.05, ndcg: 52.18, took: 1.13s
Epoch 13, 86.2%	 loss: 3.422 acc@1: 39.06 mrr: 50.70, ndcg: 54.57, took: 1.24s
Epoch 13, 94.8%	 loss: 3.355 acc@1: 39.38 mrr: 50.95, ndcg: 54.81, took: 1.28s
Validation - loss: 4.2067, acc@1: 37.43%, f1: 24.48%, mrr: 47.62%, ndcg: 51.18%
Current learning rate: 0.000043

=== Epoch 14 ===
Epoch 14, 8.6%	 loss: 3.501 acc@1: 35.94 mrr: 48.31, ndcg: 52.58, took: 1.59s
Epoch 14, 17.2%	 loss: 3.509 acc@1: 36.56 mrr: 48.64, ndcg: 52.86, took: 1.54s
Epoch 14, 25.9%	 loss: 3.493 acc@1: 38.91 mrr: 50.53, ndcg: 54.20, took: 1.54s
Epoch 14, 34.5%	 loss: 3.441 acc@1: 40.31 mrr: 51.37, ndcg: 54.83, took: 1.55s
Epoch 14, 43.1%	 loss: 3.317 acc@1: 38.59 mrr: 51.15, ndcg: 55.13, took: 1.48s
Epoch 14, 51.7%	 loss: 3.373 acc@1: 39.84 mrr: 51.91, ndcg: 56.19, took: 1.39s
Epoch 14, 60.3%	 loss: 3.311 acc@1: 39.22 mrr: 51.79, ndcg: 55.83, took: 1.32s
Epoch 14, 69.0%	 loss: 3.274 acc@1: 42.34 mrr: 53.47, ndcg: 57.09, took: 1.22s
Epoch 14, 77.6%	 loss: 3.373 acc@1: 36.72 mrr: 49.50, ndcg: 53.97, took: 1.20s
Epoch 14, 86.2%	 loss: 3.409 acc@1: 36.72 mrr: 49.53, ndcg: 53.78, took: 1.20s
Epoch 14, 94.8%	 loss: 3.536 acc@1: 37.66 mrr: 49.03, ndcg: 52.57, took: 1.22s
Validation - loss: 4.2012, acc@1: 37.85%, f1: 24.79%, mrr: 47.96%, ndcg: 51.50%
Current learning rate: 0.000043

=== Epoch 15 ===
Epoch 15, 8.6%	 loss: 3.601 acc@1: 37.50 mrr: 48.33, ndcg: 51.85, took: 1.49s
Epoch 15, 17.2%	 loss: 3.363 acc@1: 37.66 mrr: 50.80, ndcg: 55.09, took: 1.56s
Epoch 15, 25.9%	 loss: 3.454 acc@1: 39.84 mrr: 51.04, ndcg: 54.96, took: 1.60s
Epoch 15, 34.5%	 loss: 3.470 acc@1: 34.69 mrr: 48.53, ndcg: 52.96, took: 1.53s
Epoch 15, 43.1%	 loss: 3.356 acc@1: 37.81 mrr: 50.64, ndcg: 55.07, took: 1.54s
Epoch 15, 51.7%	 loss: 3.468 acc@1: 39.38 mrr: 50.72, ndcg: 54.15, took: 1.53s
Epoch 15, 60.3%	 loss: 3.507 acc@1: 37.34 mrr: 49.26, ndcg: 53.27, took: 1.42s
Epoch 15, 69.0%	 loss: 3.402 acc@1: 37.66 mrr: 50.35, ndcg: 54.61, took: 1.27s
Epoch 15, 77.6%	 loss: 3.434 acc@1: 40.00 mrr: 50.89, ndcg: 54.78, took: 1.28s
Epoch 15, 86.2%	 loss: 3.229 acc@1: 40.00 mrr: 52.74, ndcg: 56.87, took: 1.27s
Epoch 15, 94.8%	 loss: 3.326 acc@1: 41.09 mrr: 52.23, ndcg: 55.91, took: 1.35s
Validation - loss: 4.2272, acc@1: 37.67%, f1: 24.69%, mrr: 47.81%, ndcg: 51.40%
Current learning rate: 0.000004

=== Epoch 16 ===
Epoch 16, 8.6%	 loss: 3.549 acc@1: 36.88 mrr: 48.49, ndcg: 52.70, took: 1.58s
Epoch 16, 17.2%	 loss: 3.480 acc@1: 37.03 mrr: 49.75, ndcg: 53.77, took: 1.52s
Epoch 16, 25.9%	 loss: 3.711 acc@1: 33.28 mrr: 45.68, ndcg: 49.87, took: 1.59s
Epoch 16, 34.5%	 loss: 3.564 acc@1: 36.88 mrr: 49.08, ndcg: 52.93, took: 1.59s
Epoch 16, 43.1%	 loss: 3.477 acc@1: 39.53 mrr: 51.00, ndcg: 54.55, took: 1.54s
Epoch 16, 51.7%	 loss: 3.369 acc@1: 40.00 mrr: 52.37, ndcg: 56.48, took: 1.50s
Epoch 16, 60.3%	 loss: 3.521 acc@1: 38.28 mrr: 49.84, ndcg: 53.68, took: 1.45s
Epoch 16, 69.0%	 loss: 3.662 acc@1: 35.94 mrr: 47.84, ndcg: 51.63, took: 1.34s
Epoch 16, 77.6%	 loss: 3.480 acc@1: 36.41 mrr: 49.18, ndcg: 53.41, took: 1.40s
Epoch 16, 86.2%	 loss: 3.413 acc@1: 38.28 mrr: 50.38, ndcg: 54.47, took: 1.40s
Epoch 16, 94.8%	 loss: 3.563 acc@1: 34.84 mrr: 47.82, ndcg: 52.23, took: 1.36s
Validation - loss: 4.1977, acc@1: 37.16%, f1: 23.99%, mrr: 47.22%, ndcg: 50.75%
Current learning rate: 0.000004

=== Epoch 17 ===
Epoch 17, 8.6%	 loss: 3.377 acc@1: 37.50 mrr: 50.28, ndcg: 54.71, took: 1.39s
Epoch 17, 17.2%	 loss: 3.532 acc@1: 36.72 mrr: 48.82, ndcg: 53.11, took: 1.31s
Epoch 17, 25.9%	 loss: 3.476 acc@1: 39.38 mrr: 50.74, ndcg: 54.27, took: 1.51s
Epoch 17, 34.5%	 loss: 3.635 acc@1: 34.53 mrr: 46.90, ndcg: 51.24, took: 1.52s
Epoch 17, 43.1%	 loss: 3.579 acc@1: 34.06 mrr: 47.13, ndcg: 51.38, took: 1.54s
Epoch 17, 51.7%	 loss: 3.249 acc@1: 40.62 mrr: 53.02, ndcg: 57.09, took: 1.47s
Epoch 17, 60.3%	 loss: 3.555 acc@1: 35.78 mrr: 48.87, ndcg: 52.95, took: 1.39s
Epoch 17, 69.0%	 loss: 3.625 acc@1: 36.09 mrr: 48.17, ndcg: 52.08, took: 1.41s
Epoch 17, 77.6%	 loss: 3.609 acc@1: 36.09 mrr: 47.86, ndcg: 51.57, took: 1.38s
Epoch 17, 86.2%	 loss: 3.668 acc@1: 35.00 mrr: 46.90, ndcg: 50.76, took: 1.41s
Epoch 17, 94.8%	 loss: 3.418 acc@1: 39.53 mrr: 51.20, ndcg: 55.29, took: 1.48s
Validation - loss: 4.2026, acc@1: 37.28%, f1: 24.06%, mrr: 47.29%, ndcg: 50.82%
Current learning rate: 0.000004

=== Epoch 18 ===
Epoch 18, 8.6%	 loss: 3.357 acc@1: 38.91 mrr: 51.13, ndcg: 55.35, took: 1.27s
Epoch 18, 17.2%	 loss: 3.595 acc@1: 34.38 mrr: 47.05, ndcg: 51.58, took: 1.38s
Epoch 18, 25.9%	 loss: 3.391 acc@1: 38.75 mrr: 51.03, ndcg: 54.98, took: 1.30s
Epoch 18, 34.5%	 loss: 3.526 acc@1: 36.72 mrr: 48.65, ndcg: 52.46, took: 1.26s
Epoch 18, 43.1%	 loss: 3.596 acc@1: 35.31 mrr: 47.58, ndcg: 51.87, took: 1.33s
Epoch 18, 51.7%	 loss: 3.406 acc@1: 38.91 mrr: 51.37, ndcg: 55.69, took: 1.56s
Epoch 18, 60.3%	 loss: 3.523 acc@1: 36.56 mrr: 48.74, ndcg: 52.98, took: 1.44s
Epoch 18, 69.0%	 loss: 3.405 acc@1: 37.66 mrr: 50.52, ndcg: 54.75, took: 1.50s
Epoch 18, 77.6%	 loss: 3.655 acc@1: 33.75 mrr: 46.24, ndcg: 50.20, took: 1.35s
Epoch 18, 86.2%	 loss: 3.563 acc@1: 37.34 mrr: 49.95, ndcg: 53.93, took: 1.36s
Epoch 18, 94.8%	 loss: 3.490 acc@1: 38.44 mrr: 50.12, ndcg: 53.88, took: 1.46s
Validation - loss: 4.2039, acc@1: 37.22%, f1: 23.94%, mrr: 47.31%, ndcg: 50.88%
Current learning rate: 0.000004

=== Epoch 19 ===
Epoch 19, 8.6%	 loss: 3.369 acc@1: 38.44 mrr: 51.32, ndcg: 55.65, took: 1.40s
Epoch 19, 17.2%	 loss: 3.365 acc@1: 40.62 mrr: 52.44, ndcg: 56.13, took: 1.47s
Epoch 19, 25.9%	 loss: 3.674 acc@1: 35.62 mrr: 47.17, ndcg: 51.17, took: 1.29s
Epoch 19, 34.5%	 loss: 3.514 acc@1: 36.88 mrr: 48.97, ndcg: 53.38, took: 1.32s
Epoch 19, 43.1%	 loss: 3.606 acc@1: 36.09 mrr: 48.33, ndcg: 52.17, took: 1.27s
Epoch 19, 51.7%	 loss: 3.437 acc@1: 37.34 mrr: 50.09, ndcg: 54.41, took: 1.28s
Epoch 19, 60.3%	 loss: 3.537 acc@1: 37.19 mrr: 49.15, ndcg: 52.98, took: 1.24s
Epoch 19, 69.0%	 loss: 3.519 acc@1: 36.72 mrr: 48.91, ndcg: 52.62, took: 1.37s
Epoch 19, 77.6%	 loss: 3.512 acc@1: 38.28 mrr: 49.99, ndcg: 53.98, took: 1.39s
Epoch 19, 86.2%	 loss: 3.504 acc@1: 36.72 mrr: 49.01, ndcg: 53.15, took: 1.32s
Epoch 19, 94.8%	 loss: 3.519 acc@1: 36.72 mrr: 48.99, ndcg: 52.87, took: 1.41s
Validation - loss: 4.1954, acc@1: 37.37%, f1: 24.12%, mrr: 47.44%, ndcg: 51.00%
Current learning rate: 0.000004

=== Epoch 20 ===
Epoch 20, 8.6%	 loss: 3.461 acc@1: 36.72 mrr: 49.77, ndcg: 53.90, took: 1.56s
Epoch 20, 17.2%	 loss: 3.513 acc@1: 35.62 mrr: 48.37, ndcg: 52.50, took: 1.46s
Epoch 20, 25.9%	 loss: 3.614 acc@1: 37.50 mrr: 48.81, ndcg: 52.31, took: 1.35s
Epoch 20, 34.5%	 loss: 3.491 acc@1: 38.44 mrr: 49.84, ndcg: 53.74, took: 1.41s
Epoch 20, 43.1%	 loss: 3.580 acc@1: 34.22 mrr: 47.29, ndcg: 51.63, took: 1.37s
Epoch 20, 51.7%	 loss: 3.569 acc@1: 38.59 mrr: 49.43, ndcg: 52.96, took: 1.20s
Epoch 20, 60.3%	 loss: 3.556 acc@1: 37.97 mrr: 49.34, ndcg: 52.89, took: 1.14s
Epoch 20, 69.0%	 loss: 3.404 acc@1: 37.97 mrr: 50.66, ndcg: 54.97, took: 1.05s
Epoch 20, 77.6%	 loss: 3.485 acc@1: 37.66 mrr: 50.02, ndcg: 54.31, took: 1.12s
Epoch 20, 86.2%	 loss: 3.456 acc@1: 35.94 mrr: 49.07, ndcg: 53.30, took: 1.11s
Epoch 20, 94.8%	 loss: 3.308 acc@1: 39.38 mrr: 51.95, ndcg: 56.20, took: 1.33s
Validation - loss: 4.2045, acc@1: 37.25%, f1: 24.02%, mrr: 47.35%, ndcg: 50.90%
Training finished.	 Time: 431.56s.	 acc@1: 37.04%

=== Test Results ===
Test Results:
  acc@1: 30.67%
  acc@5: 49.34%
  acc@10: 55.37%
  mrr: 39.57%
  ndcg: 42.98%
  f1: 18.36%

=== Training Complete ===
