Training LSTM model
Dataset: diy
Config: /data/next_loc_clean_v2/config/ht_grid_search/optuna_LSTM_diy_prev3_emb64_h32_l4_ff512_lr0.001_t0.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=599, val=60, test=69
Total trainable parameters: 785438

=== Epoch 1 ===
Epoch 1, 1.7%	 loss: 9.124 acc@1: 0.00 mrr: 0.06, ndcg: 0.02, took: 0.82s
Epoch 1, 3.3%	 loss: 9.137 acc@1: 0.00 mrr: 0.06, ndcg: 0.02, took: 0.48s
Epoch 1, 5.0%	 loss: 9.123 acc@1: 0.00 mrr: 0.07, ndcg: 0.04, took: 0.47s
Epoch 1, 6.7%	 loss: 9.127 acc@1: 0.00 mrr: 0.08, ndcg: 0.02, took: 0.46s
Epoch 1, 8.3%	 loss: 9.120 acc@1: 0.00 mrr: 0.09, ndcg: 0.03, took: 0.47s
Epoch 1, 10.0%	 loss: 9.119 acc@1: 0.04 mrr: 0.11, ndcg: 0.06, took: 0.46s
Epoch 1, 11.7%	 loss: 9.113 acc@1: 0.00 mrr: 0.08, ndcg: 0.04, took: 0.47s
Epoch 1, 13.4%	 loss: 9.104 acc@1: 0.00 mrr: 0.09, ndcg: 0.05, took: 0.47s
Epoch 1, 15.0%	 loss: 9.119 acc@1: 0.08 mrr: 0.15, ndcg: 0.10, took: 0.52s
Epoch 1, 16.7%	 loss: 9.079 acc@1: 0.04 mrr: 0.16, ndcg: 0.12, took: 0.52s
Epoch 1, 18.4%	 loss: 9.075 acc@1: 0.04 mrr: 0.15, ndcg: 0.10, took: 0.47s
Epoch 1, 20.0%	 loss: 9.071 acc@1: 0.00 mrr: 0.12, ndcg: 0.06, took: 0.49s
Epoch 1, 21.7%	 loss: 9.052 acc@1: 0.00 mrr: 0.14, ndcg: 0.10, took: 0.48s
Epoch 1, 23.4%	 loss: 9.048 acc@1: 0.04 mrr: 0.20, ndcg: 0.17, took: 0.46s
Epoch 1, 25.0%	 loss: 9.026 acc@1: 0.00 mrr: 0.17, ndcg: 0.13, took: 0.45s
Epoch 1, 26.7%	 loss: 9.003 acc@1: 0.00 mrr: 0.17, ndcg: 0.10, took: 0.45s
Epoch 1, 28.4%	 loss: 9.004 acc@1: 0.04 mrr: 0.34, ndcg: 0.29, took: 0.46s
Epoch 1, 30.1%	 loss: 8.984 acc@1: 0.04 mrr: 0.23, ndcg: 0.17, took: 0.46s
Epoch 1, 31.7%	 loss: 8.973 acc@1: 0.08 mrr: 0.35, ndcg: 0.30, took: 0.46s
Epoch 1, 33.4%	 loss: 8.937 acc@1: 0.04 mrr: 0.25, ndcg: 0.18, took: 0.44s
Epoch 1, 35.1%	 loss: 8.933 acc@1: 0.20 mrr: 0.44, ndcg: 0.41, took: 0.45s
Epoch 1, 36.7%	 loss: 8.893 acc@1: 0.23 mrr: 0.67, ndcg: 0.63, took: 0.45s
Epoch 1, 38.4%	 loss: 8.857 acc@1: 1.13 mrr: 1.98, ndcg: 2.09, took: 0.45s
Epoch 1, 40.1%	 loss: 8.816 acc@1: 4.06 mrr: 4.79, ndcg: 4.92, took: 0.45s
Epoch 1, 41.7%	 loss: 8.786 acc@1: 5.12 mrr: 5.83, ndcg: 5.91, took: 0.45s
Epoch 1, 43.4%	 loss: 8.740 acc@1: 7.07 mrr: 8.03, ndcg: 8.20, took: 0.45s
Epoch 1, 45.1%	 loss: 8.681 acc@1: 8.91 mrr: 9.67, ndcg: 9.81, took: 0.45s
Epoch 1, 46.7%	 loss: 8.657 acc@1: 10.70 mrr: 11.53, ndcg: 11.70, took: 0.45s
Epoch 1, 48.4%	 loss: 8.576 acc@1: 11.72 mrr: 12.51, ndcg: 12.62, took: 0.45s
Epoch 1, 50.1%	 loss: 8.538 acc@1: 13.01 mrr: 13.64, ndcg: 13.67, took: 0.45s
Epoch 1, 51.8%	 loss: 8.491 acc@1: 13.83 mrr: 14.68, ndcg: 14.82, took: 0.45s
Epoch 1, 53.4%	 loss: 8.463 acc@1: 13.52 mrr: 14.43, ndcg: 14.67, took: 0.45s
Epoch 1, 55.1%	 loss: 8.390 acc@1: 15.27 mrr: 16.01, ndcg: 16.09, took: 0.44s
Epoch 1, 56.8%	 loss: 8.305 acc@1: 17.27 mrr: 18.10, ndcg: 18.27, took: 0.44s
Epoch 1, 58.4%	 loss: 8.287 acc@1: 17.15 mrr: 17.79, ndcg: 17.85, took: 0.45s
Epoch 1, 60.1%	 loss: 8.186 acc@1: 17.85 mrr: 18.73, ndcg: 18.91, took: 0.45s
Epoch 1, 61.8%	 loss: 8.151 acc@1: 18.32 mrr: 19.17, ndcg: 19.38, took: 0.46s
Epoch 1, 63.4%	 loss: 8.073 acc@1: 19.84 mrr: 20.65, ndcg: 20.77, took: 0.45s
Epoch 1, 65.1%	 loss: 8.019 acc@1: 19.80 mrr: 20.63, ndcg: 20.76, took: 0.46s
Epoch 1, 66.8%	 loss: 7.961 acc@1: 19.57 mrr: 20.44, ndcg: 20.55, took: 0.47s
Epoch 1, 68.4%	 loss: 7.882 acc@1: 21.52 mrr: 22.52, ndcg: 22.69, took: 0.46s
Epoch 1, 70.1%	 loss: 7.847 acc@1: 20.55 mrr: 21.56, ndcg: 21.78, took: 0.46s
Epoch 1, 71.8%	 loss: 7.730 acc@1: 21.72 mrr: 22.63, ndcg: 22.75, took: 0.46s
Epoch 1, 73.5%	 loss: 7.698 acc@1: 23.09 mrr: 24.01, ndcg: 24.14, took: 0.48s
Epoch 1, 75.1%	 loss: 7.605 acc@1: 23.83 mrr: 24.95, ndcg: 25.15, took: 0.45s
Epoch 1, 76.8%	 loss: 7.577 acc@1: 23.44 mrr: 24.57, ndcg: 24.70, took: 0.45s
Epoch 1, 78.5%	 loss: 7.492 acc@1: 23.75 mrr: 24.88, ndcg: 25.12, took: 0.46s
Epoch 1, 80.1%	 loss: 7.426 acc@1: 23.75 mrr: 25.04, ndcg: 25.32, took: 0.47s
Epoch 1, 81.8%	 loss: 7.346 acc@1: 24.69 mrr: 25.83, ndcg: 25.88, took: 0.46s
Epoch 1, 83.5%	 loss: 7.232 acc@1: 24.96 mrr: 26.32, ndcg: 26.64, took: 0.46s
Epoch 1, 85.1%	 loss: 7.186 acc@1: 25.82 mrr: 27.11, ndcg: 27.39, took: 0.46s
Epoch 1, 86.8%	 loss: 7.083 acc@1: 26.64 mrr: 28.23, ndcg: 28.49, took: 0.46s
Epoch 1, 88.5%	 loss: 6.949 acc@1: 27.89 mrr: 29.40, ndcg: 29.55, took: 0.46s
Epoch 1, 90.2%	 loss: 6.926 acc@1: 27.58 mrr: 29.19, ndcg: 29.38, took: 0.45s
Epoch 1, 91.8%	 loss: 6.937 acc@1: 26.05 mrr: 27.69, ndcg: 27.95, took: 0.46s
Epoch 1, 93.5%	 loss: 6.814 acc@1: 26.37 mrr: 28.07, ndcg: 28.26, took: 0.45s
Epoch 1, 95.2%	 loss: 6.740 acc@1: 27.54 mrr: 29.24, ndcg: 29.59, took: 0.46s
Epoch 1, 96.8%	 loss: 6.657 acc@1: 26.84 mrr: 28.72, ndcg: 29.15, took: 0.45s
Epoch 1, 98.5%	 loss: 6.548 acc@1: 28.55 mrr: 30.33, ndcg: 30.72, took: 0.45s
Validation - loss: 6.4726, acc@1: 27.77%, f1: 16.45%, mrr: 29.84%, ndcg: 30.30%
Current learning rate: 0.000500

=== Epoch 2 ===
Epoch 2, 1.7%	 loss: 6.403 acc@1: 28.05 mrr: 30.11, ndcg: 30.65, took: 0.46s
Epoch 2, 3.3%	 loss: 6.322 acc@1: 28.05 mrr: 30.18, ndcg: 30.59, took: 0.44s
Epoch 2, 5.0%	 loss: 6.263 acc@1: 27.42 mrr: 29.69, ndcg: 29.98, took: 0.44s
Epoch 2, 6.7%	 loss: 6.262 acc@1: 27.42 mrr: 29.80, ndcg: 30.27, took: 0.45s
Epoch 2, 8.3%	 loss: 6.101 acc@1: 29.69 mrr: 31.94, ndcg: 32.32, took: 0.46s
Epoch 2, 10.0%	 loss: 6.034 acc@1: 29.41 mrr: 31.65, ndcg: 32.01, took: 0.45s
Epoch 2, 11.7%	 loss: 6.006 acc@1: 28.98 mrr: 31.35, ndcg: 31.87, took: 0.44s
Epoch 2, 13.4%	 loss: 6.023 acc@1: 28.40 mrr: 30.82, ndcg: 31.22, took: 0.44s
Epoch 2, 15.0%	 loss: 5.821 acc@1: 29.77 mrr: 32.34, ndcg: 32.85, took: 0.45s
Epoch 2, 16.7%	 loss: 5.892 acc@1: 28.98 mrr: 31.57, ndcg: 32.16, took: 0.44s
Epoch 2, 18.4%	 loss: 5.804 acc@1: 28.95 mrr: 31.81, ndcg: 32.42, took: 0.44s
Epoch 2, 20.0%	 loss: 5.891 acc@1: 27.30 mrr: 30.08, ndcg: 30.63, took: 0.47s
Epoch 2, 21.7%	 loss: 5.703 acc@1: 29.61 mrr: 32.37, ndcg: 32.95, took: 0.46s
Epoch 2, 23.4%	 loss: 5.778 acc@1: 28.52 mrr: 31.28, ndcg: 31.87, took: 0.47s
Epoch 2, 25.0%	 loss: 5.748 acc@1: 28.01 mrr: 31.10, ndcg: 31.83, took: 0.44s
Epoch 2, 26.7%	 loss: 5.800 acc@1: 27.15 mrr: 29.86, ndcg: 30.41, took: 0.46s
Epoch 2, 28.4%	 loss: 5.540 acc@1: 30.04 mrr: 33.14, ndcg: 33.90, took: 0.46s
Epoch 2, 30.1%	 loss: 5.515 acc@1: 30.35 mrr: 33.22, ndcg: 33.92, took: 0.46s
Epoch 2, 31.7%	 loss: 5.603 acc@1: 29.34 mrr: 32.38, ndcg: 33.04, took: 0.46s
Epoch 2, 33.4%	 loss: 5.595 acc@1: 28.52 mrr: 31.72, ndcg: 32.47, took: 0.45s
Epoch 2, 35.1%	 loss: 5.510 acc@1: 29.45 mrr: 32.69, ndcg: 33.54, took: 0.45s
Epoch 2, 36.7%	 loss: 5.522 acc@1: 28.67 mrr: 32.03, ndcg: 32.76, took: 0.47s
Epoch 2, 38.4%	 loss: 5.443 acc@1: 28.79 mrr: 32.28, ndcg: 33.03, took: 0.47s
Epoch 2, 40.1%	 loss: 5.411 acc@1: 30.47 mrr: 33.66, ndcg: 34.43, took: 0.45s
Epoch 2, 41.7%	 loss: 5.562 acc@1: 28.48 mrr: 31.53, ndcg: 32.27, took: 0.45s
Epoch 2, 43.4%	 loss: 5.435 acc@1: 29.84 mrr: 33.14, ndcg: 34.08, took: 0.45s
Epoch 2, 45.1%	 loss: 5.463 acc@1: 29.38 mrr: 32.74, ndcg: 33.51, took: 0.46s
Epoch 2, 46.7%	 loss: 5.361 acc@1: 29.53 mrr: 33.12, ndcg: 34.16, took: 0.45s
Epoch 2, 48.4%	 loss: 5.442 acc@1: 29.69 mrr: 32.90, ndcg: 33.80, took: 0.45s
Epoch 2, 50.1%	 loss: 5.324 acc@1: 30.08 mrr: 33.54, ndcg: 34.36, took: 0.45s
Epoch 2, 51.8%	 loss: 5.342 acc@1: 29.22 mrr: 32.84, ndcg: 33.71, took: 0.46s
Epoch 2, 53.4%	 loss: 5.303 acc@1: 30.35 mrr: 33.70, ndcg: 34.47, took: 0.46s
Epoch 2, 55.1%	 loss: 5.358 acc@1: 28.79 mrr: 32.48, ndcg: 33.52, took: 0.46s
Epoch 2, 56.8%	 loss: 5.375 acc@1: 29.61 mrr: 33.18, ndcg: 34.19, took: 0.47s
Epoch 2, 58.4%	 loss: 5.235 acc@1: 30.51 mrr: 34.13, ndcg: 35.31, took: 0.45s
Epoch 2, 60.1%	 loss: 5.241 acc@1: 30.47 mrr: 34.06, ndcg: 34.98, took: 0.44s
Epoch 2, 61.8%	 loss: 5.191 acc@1: 31.41 mrr: 35.28, ndcg: 36.46, took: 0.45s
Epoch 2, 63.4%	 loss: 5.251 acc@1: 30.70 mrr: 34.23, ndcg: 35.04, took: 0.45s
Epoch 2, 65.1%	 loss: 5.347 acc@1: 29.30 mrr: 32.85, ndcg: 33.76, took: 0.45s
Epoch 2, 66.8%	 loss: 5.097 acc@1: 31.25 mrr: 34.90, ndcg: 35.95, took: 0.45s
Epoch 2, 68.4%	 loss: 5.274 acc@1: 30.20 mrr: 33.78, ndcg: 34.72, took: 0.45s
Epoch 2, 70.1%	 loss: 5.189 acc@1: 30.66 mrr: 34.55, ndcg: 35.65, took: 0.46s
Epoch 2, 71.8%	 loss: 5.151 acc@1: 30.00 mrr: 34.06, ndcg: 35.23, took: 0.45s
Epoch 2, 73.5%	 loss: 5.163 acc@1: 30.31 mrr: 34.42, ndcg: 35.69, took: 0.45s
Epoch 2, 75.1%	 loss: 5.107 acc@1: 31.45 mrr: 35.21, ndcg: 36.26, took: 0.45s
Epoch 2, 76.8%	 loss: 5.010 acc@1: 31.99 mrr: 36.01, ndcg: 37.25, took: 0.45s
Epoch 2, 78.5%	 loss: 5.104 acc@1: 30.39 mrr: 34.65, ndcg: 35.82, took: 0.45s
Epoch 2, 80.1%	 loss: 5.064 acc@1: 31.48 mrr: 35.61, ndcg: 36.78, took: 0.46s
Epoch 2, 81.8%	 loss: 5.065 acc@1: 32.15 mrr: 36.03, ndcg: 36.97, took: 0.47s
Epoch 2, 83.5%	 loss: 4.963 acc@1: 32.11 mrr: 36.59, ndcg: 37.93, took: 0.47s
Epoch 2, 85.1%	 loss: 5.051 acc@1: 31.56 mrr: 35.81, ndcg: 37.14, took: 0.45s
Epoch 2, 86.8%	 loss: 4.835 acc@1: 34.88 mrr: 39.00, ndcg: 40.16, took: 0.46s
Epoch 2, 88.5%	 loss: 5.027 acc@1: 31.05 mrr: 35.51, ndcg: 36.96, took: 0.45s
Epoch 2, 90.2%	 loss: 4.915 acc@1: 32.50 mrr: 37.37, ndcg: 38.90, took: 0.45s
Epoch 2, 91.8%	 loss: 5.008 acc@1: 31.80 mrr: 36.61, ndcg: 38.10, took: 0.47s
Epoch 2, 93.5%	 loss: 4.875 acc@1: 32.50 mrr: 37.79, ndcg: 39.55, took: 0.46s
Epoch 2, 95.2%	 loss: 5.003 acc@1: 31.21 mrr: 36.37, ndcg: 37.90, took: 0.45s
Epoch 2, 96.8%	 loss: 4.971 acc@1: 32.23 mrr: 37.60, ndcg: 39.23, took: 0.46s
Epoch 2, 98.5%	 loss: 4.840 acc@1: 32.34 mrr: 38.31, ndcg: 40.31, took: 0.45s
Validation - loss: 4.9692, acc@1: 34.00%, f1: 19.39%, mrr: 39.70%, ndcg: 41.53%
Current learning rate: 0.000000

=== Test Results ===
Test Results:
  acc@1: 33.73%
  acc@5: 43.92%
  acc@10: 49.05%
  mrr: 39.15%
  ndcg: 40.92%
  f1: 19.11%

=== Training Complete ===
