Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/scripts/sci_hyperparam_tuning/configs/mhsa_geolife_trial05.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=58, val=27, test=28
Total trainable parameters: 137731

=== Epoch 1 ===
Epoch 1, 34.5%	 loss: 7.119 acc@1: 0.08 mrr: 0.63, ndcg: 0.38, took: 1.76s
Epoch 1, 69.0%	 loss: 7.091 acc@1: 0.12 mrr: 0.80, ndcg: 0.49, took: 0.98s
Validation - loss: 6.9549, acc@1: 4.92%, f1: 5.43%, mrr: 7.56%, ndcg: 8.07%
Current learning rate: 0.001000

=== Epoch 2 ===
Epoch 2, 34.5%	 loss: 6.835 acc@1: 11.41 mrr: 14.59, ndcg: 15.24, took: 1.09s
Epoch 2, 69.0%	 loss: 6.458 acc@1: 17.81 mrr: 25.24, ndcg: 27.76, took: 1.02s
Validation - loss: 5.5433, acc@1: 17.46%, f1: 9.45%, mrr: 30.03%, ndcg: 35.26%
Current learning rate: 0.002000

=== Epoch 3 ===
Epoch 3, 34.5%	 loss: 5.149 acc@1: 23.16 mrr: 34.21, ndcg: 39.10, took: 0.95s
Epoch 3, 69.0%	 loss: 4.802 acc@1: 22.03 mrr: 33.79, ndcg: 39.05, took: 0.94s
Validation - loss: 4.7198, acc@1: 23.37%, f1: 13.45%, mrr: 35.45%, ndcg: 40.40%
Current learning rate: 0.001958

=== Epoch 4 ===
Epoch 4, 34.5%	 loss: 4.046 acc@1: 31.09 mrr: 42.87, ndcg: 47.31, took: 1.02s
Epoch 4, 69.0%	 loss: 3.788 acc@1: 32.77 mrr: 45.43, ndcg: 50.03, took: 0.99s
Validation - loss: 4.4246, acc@1: 33.92%, f1: 21.95%, mrr: 45.15%, ndcg: 48.85%
Current learning rate: 0.001917

=== Epoch 5 ===
Epoch 5, 34.5%	 loss: 3.512 acc@1: 35.00 mrr: 48.02, ndcg: 52.39, took: 1.11s
Epoch 5, 69.0%	 loss: 3.491 acc@1: 34.65 mrr: 48.11, ndcg: 52.51, took: 1.15s
Validation - loss: 4.4120, acc@1: 34.25%, f1: 22.28%, mrr: 45.88%, ndcg: 49.83%
Current learning rate: 0.001875

=== Epoch 6 ===
Epoch 6, 34.5%	 loss: 3.234 acc@1: 37.38 mrr: 50.99, ndcg: 55.23, took: 1.17s
Epoch 6, 69.0%	 loss: 3.199 acc@1: 37.70 mrr: 51.21, ndcg: 55.81, took: 1.15s
Validation - loss: 4.3934, acc@1: 36.68%, f1: 24.35%, mrr: 47.95%, ndcg: 51.82%
Current learning rate: 0.001833

=== Epoch 7 ===
Epoch 7, 34.5%	 loss: 3.016 acc@1: 37.70 mrr: 52.09, ndcg: 56.83, took: 1.06s
Epoch 7, 69.0%	 loss: 3.006 acc@1: 40.12 mrr: 53.58, ndcg: 57.92, took: 1.06s
Validation - loss: 4.3497, acc@1: 37.85%, f1: 25.71%, mrr: 48.95%, ndcg: 52.77%
Current learning rate: 0.001792

=== Epoch 8 ===
Epoch 8, 34.5%	 loss: 2.786 acc@1: 41.91 mrr: 55.58, ndcg: 60.16, took: 1.11s
Epoch 8, 69.0%	 loss: 2.868 acc@1: 42.30 mrr: 55.01, ndcg: 59.34, took: 1.08s
Validation - loss: 4.3420, acc@1: 37.67%, f1: 26.00%, mrr: 49.05%, ndcg: 53.04%
Current learning rate: 0.001750

=== Epoch 9 ===
Epoch 9, 34.5%	 loss: 2.650 acc@1: 45.62 mrr: 58.06, ndcg: 62.45, took: 1.18s
Epoch 9, 69.0%	 loss: 2.691 acc@1: 43.71 mrr: 56.82, ndcg: 61.15, took: 1.00s
Validation - loss: 4.3637, acc@1: 38.03%, f1: 28.52%, mrr: 49.10%, ndcg: 53.08%
Current learning rate: 0.001708

=== Epoch 10 ===
Epoch 10, 34.5%	 loss: 2.533 acc@1: 45.51 mrr: 58.62, ndcg: 63.41, took: 1.12s
Epoch 10, 69.0%	 loss: 2.507 acc@1: 45.31 mrr: 58.75, ndcg: 63.29, took: 1.04s
Validation - loss: 4.3264, acc@1: 39.71%, f1: 31.49%, mrr: 50.13%, ndcg: 53.86%
Current learning rate: 0.001667

=== Epoch 11 ===
Epoch 11, 34.5%	 loss: 2.349 acc@1: 49.53 mrr: 61.84, ndcg: 66.37, took: 1.13s
Epoch 11, 69.0%	 loss: 2.450 acc@1: 47.58 mrr: 60.12, ndcg: 64.74, took: 1.09s
Validation - loss: 4.3199, acc@1: 40.01%, f1: 31.94%, mrr: 50.36%, ndcg: 54.12%
Current learning rate: 0.001625

=== Epoch 12 ===
Epoch 12, 34.5%	 loss: 2.300 acc@1: 50.12 mrr: 62.28, ndcg: 66.92, took: 0.99s
Epoch 12, 69.0%	 loss: 2.265 acc@1: 49.69 mrr: 62.47, ndcg: 67.28, took: 1.00s
Validation - loss: 4.4115, acc@1: 38.99%, f1: 31.56%, mrr: 49.64%, ndcg: 53.51%
Current learning rate: 0.001583

=== Epoch 13 ===
Epoch 13, 34.5%	 loss: 2.227 acc@1: 50.04 mrr: 62.86, ndcg: 67.85, took: 0.98s
Epoch 13, 69.0%	 loss: 2.190 acc@1: 51.76 mrr: 64.00, ndcg: 68.56, took: 0.86s
Validation - loss: 4.4221, acc@1: 40.43%, f1: 32.63%, mrr: 50.59%, ndcg: 54.24%
Current learning rate: 0.001542

=== Epoch 14 ===
Epoch 14, 34.5%	 loss: 2.119 acc@1: 52.30 mrr: 64.84, ndcg: 69.73, took: 0.97s
Epoch 14, 69.0%	 loss: 2.030 acc@1: 53.87 mrr: 66.18, ndcg: 70.94, took: 1.01s
Validation - loss: 4.4783, acc@1: 40.61%, f1: 33.19%, mrr: 50.56%, ndcg: 54.19%
Current learning rate: 0.001500

=== Epoch 15 ===
Epoch 15, 34.5%	 loss: 2.002 acc@1: 53.87 mrr: 66.60, ndcg: 71.67, took: 0.89s
Epoch 15, 69.0%	 loss: 2.004 acc@1: 54.10 mrr: 66.61, ndcg: 71.46, took: 0.91s
Validation - loss: 4.4575, acc@1: 39.98%, f1: 33.02%, mrr: 49.96%, ndcg: 53.57%
Current learning rate: 0.001458

=== Epoch 16 ===
Epoch 16, 34.5%	 loss: 1.885 acc@1: 56.05 mrr: 68.26, ndcg: 73.31, took: 0.91s
Epoch 16, 69.0%	 loss: 1.930 acc@1: 54.30 mrr: 67.29, ndcg: 72.25, took: 0.92s
Validation - loss: 4.5266, acc@1: 40.64%, f1: 33.53%, mrr: 50.49%, ndcg: 54.09%
Current learning rate: 0.000142

=== Epoch 17 ===
Epoch 17, 34.5%	 loss: 2.276 acc@1: 50.00 mrr: 62.54, ndcg: 67.17, took: 0.89s
Epoch 17, 69.0%	 loss: 2.253 acc@1: 50.90 mrr: 63.25, ndcg: 67.81, took: 1.00s
Validation - loss: 4.3477, acc@1: 40.40%, f1: 32.01%, mrr: 50.63%, ndcg: 54.33%
Current learning rate: 0.000142

=== Epoch 18 ===
Epoch 18, 34.5%	 loss: 2.289 acc@1: 50.86 mrr: 63.10, ndcg: 67.50, took: 0.92s
Epoch 18, 69.0%	 loss: 2.218 acc@1: 51.09 mrr: 63.62, ndcg: 68.43, took: 0.96s
Validation - loss: 4.3634, acc@1: 40.64%, f1: 32.25%, mrr: 50.74%, ndcg: 54.44%
Current learning rate: 0.000142

=== Epoch 19 ===
Epoch 19, 34.5%	 loss: 2.232 acc@1: 50.39 mrr: 63.34, ndcg: 68.07, took: 0.87s
Epoch 19, 69.0%	 loss: 2.207 acc@1: 51.76 mrr: 63.74, ndcg: 68.36, took: 0.86s
Validation - loss: 4.3632, acc@1: 40.64%, f1: 32.34%, mrr: 50.71%, ndcg: 54.39%
Current learning rate: 0.000142

=== Epoch 20 ===
Epoch 20, 34.5%	 loss: 2.237 acc@1: 51.13 mrr: 63.58, ndcg: 68.23, took: 0.85s
Epoch 20, 69.0%	 loss: 2.247 acc@1: 49.96 mrr: 62.71, ndcg: 67.43, took: 0.87s
Validation - loss: 4.3479, acc@1: 40.55%, f1: 32.27%, mrr: 50.59%, ndcg: 54.30%
Current learning rate: 0.000142

=== Epoch 21 ===
Epoch 21, 34.5%	 loss: 2.245 acc@1: 49.77 mrr: 62.61, ndcg: 67.51, took: 0.87s
Epoch 21, 69.0%	 loss: 2.209 acc@1: 52.27 mrr: 63.97, ndcg: 68.38, took: 0.83s
Validation - loss: 4.3691, acc@1: 40.58%, f1: 32.34%, mrr: 50.63%, ndcg: 54.33%
Current learning rate: 0.000014

=== Epoch 22 ===
Epoch 22, 34.5%	 loss: 2.321 acc@1: 48.36 mrr: 61.21, ndcg: 65.94, took: 0.78s
Epoch 22, 69.0%	 loss: 2.261 acc@1: 50.39 mrr: 62.99, ndcg: 67.77, took: 0.80s
Validation - loss: 4.3395, acc@1: 39.98%, f1: 31.89%, mrr: 50.39%, ndcg: 54.09%
Current learning rate: 0.000014

=== Epoch 23 ===
Epoch 23, 34.5%	 loss: 2.325 acc@1: 49.61 mrr: 62.04, ndcg: 66.79, took: 0.87s
Epoch 23, 69.0%	 loss: 2.212 acc@1: 51.21 mrr: 63.88, ndcg: 68.55, took: 0.82s
Validation - loss: 4.3483, acc@1: 40.19%, f1: 32.05%, mrr: 50.49%, ndcg: 54.19%
Current learning rate: 0.000014

=== Epoch 24 ===
Epoch 24, 34.5%	 loss: 2.250 acc@1: 50.35 mrr: 63.11, ndcg: 67.93, took: 0.84s
Epoch 24, 69.0%	 loss: 2.231 acc@1: 50.94 mrr: 63.29, ndcg: 68.00, took: 0.82s
Validation - loss: 4.3569, acc@1: 40.25%, f1: 32.05%, mrr: 50.54%, ndcg: 54.20%
Current learning rate: 0.000014

=== Epoch 25 ===
Epoch 25, 34.5%	 loss: 2.280 acc@1: 50.31 mrr: 62.67, ndcg: 67.36, took: 0.88s
Epoch 25, 69.0%	 loss: 2.284 acc@1: 50.04 mrr: 62.54, ndcg: 67.06, took: 0.85s
Validation - loss: 4.3511, acc@1: 40.34%, f1: 31.96%, mrr: 50.57%, ndcg: 54.29%
Current learning rate: 0.000014

=== Epoch 26 ===
Epoch 26, 34.5%	 loss: 2.262 acc@1: 51.60 mrr: 63.48, ndcg: 68.03, took: 0.88s
Epoch 26, 69.0%	 loss: 2.272 acc@1: 50.12 mrr: 62.61, ndcg: 67.25, took: 0.82s
Validation - loss: 4.3471, acc@1: 40.31%, f1: 32.04%, mrr: 50.53%, ndcg: 54.22%
Training finished.	 Time: 93.38s.	 acc@1: 40.01%

=== Test Results ===
Test Results:
  acc@1: 30.01%
  acc@5: 56.57%
  acc@10: 59.57%
  mrr: 41.87%
  ndcg: 45.97%
  f1: 22.75%

=== Training Complete ===
