Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/scripts/sci_hyperparam_tuning/configs/mhsa_geolife_trial12.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=116, val=53, test=55
Total trainable parameters: 248227

=== Epoch 1 ===
Epoch 1, 17.2%	 loss: 7.107 acc@1: 0.08 mrr: 0.66, ndcg: 0.40, took: 1.93s
Epoch 1, 34.5%	 loss: 7.115 acc@1: 0.31 mrr: 0.85, ndcg: 0.58, took: 1.00s
Epoch 1, 51.7%	 loss: 7.093 acc@1: 0.16 mrr: 1.21, ndcg: 1.06, took: 0.82s
Epoch 1, 69.0%	 loss: 7.031 acc@1: 0.47 mrr: 1.77, ndcg: 1.60, took: 0.91s
Epoch 1, 86.2%	 loss: 6.974 acc@1: 2.81 mrr: 4.89, ndcg: 5.18, took: 0.89s
Validation - loss: 6.7350, acc@1: 13.71%, f1: 9.49%, mrr: 18.34%, ndcg: 19.80%
Current learning rate: 0.000667

=== Epoch 2 ===
Epoch 2, 17.2%	 loss: 6.557 acc@1: 15.55 mrr: 20.38, ndcg: 21.60, took: 0.85s
Epoch 2, 34.5%	 loss: 6.260 acc@1: 18.83 mrr: 25.34, ndcg: 27.40, took: 0.89s
Epoch 2, 51.7%	 loss: 5.738 acc@1: 20.94 mrr: 29.78, ndcg: 32.91, took: 0.78s
Epoch 2, 69.0%	 loss: 5.369 acc@1: 21.64 mrr: 31.42, ndcg: 35.65, took: 0.97s
Epoch 2, 86.2%	 loss: 5.075 acc@1: 22.42 mrr: 32.50, ndcg: 36.79, took: 0.89s
Validation - loss: 4.8013, acc@1: 20.67%, f1: 11.56%, mrr: 34.06%, ndcg: 39.61%
Current learning rate: 0.001333

=== Epoch 3 ===
Epoch 3, 17.2%	 loss: 4.534 acc@1: 24.22 mrr: 36.26, ndcg: 41.47, took: 0.83s
Epoch 3, 34.5%	 loss: 4.378 acc@1: 24.53 mrr: 37.09, ndcg: 42.02, took: 0.84s
Epoch 3, 51.7%	 loss: 4.085 acc@1: 30.94 mrr: 42.85, ndcg: 47.51, took: 0.80s
Epoch 3, 69.0%	 loss: 3.998 acc@1: 32.73 mrr: 44.50, ndcg: 48.86, took: 0.74s
Epoch 3, 86.2%	 loss: 3.847 acc@1: 32.66 mrr: 45.21, ndcg: 49.82, took: 0.85s
Validation - loss: 4.4362, acc@1: 33.53%, f1: 21.74%, mrr: 44.65%, ndcg: 48.51%
Current learning rate: 0.002000

=== Epoch 4 ===
Epoch 4, 17.2%	 loss: 3.438 acc@1: 36.64 mrr: 48.91, ndcg: 53.45, took: 0.86s
Epoch 4, 34.5%	 loss: 3.306 acc@1: 38.12 mrr: 51.12, ndcg: 55.47, took: 0.78s
Epoch 4, 51.7%	 loss: 3.410 acc@1: 37.50 mrr: 50.37, ndcg: 54.88, took: 0.85s
Epoch 4, 69.0%	 loss: 3.361 acc@1: 38.44 mrr: 51.15, ndcg: 55.28, took: 0.86s
Epoch 4, 86.2%	 loss: 3.451 acc@1: 36.64 mrr: 49.07, ndcg: 53.40, took: 0.79s
Validation - loss: 4.3049, acc@1: 37.52%, f1: 25.20%, mrr: 48.25%, ndcg: 51.99%
Current learning rate: 0.001957

=== Epoch 5 ===
Epoch 5, 17.2%	 loss: 3.117 acc@1: 40.23 mrr: 52.75, ndcg: 56.80, took: 0.89s
Epoch 5, 34.5%	 loss: 2.962 acc@1: 41.48 mrr: 54.83, ndcg: 59.33, took: 1.02s
Epoch 5, 51.7%	 loss: 3.093 acc@1: 42.03 mrr: 53.94, ndcg: 57.85, took: 0.82s
Epoch 5, 69.0%	 loss: 2.950 acc@1: 42.73 mrr: 55.03, ndcg: 59.39, took: 0.80s
Epoch 5, 86.2%	 loss: 2.908 acc@1: 44.38 mrr: 56.51, ndcg: 60.58, took: 0.80s
Validation - loss: 4.3625, acc@1: 38.51%, f1: 29.06%, mrr: 49.01%, ndcg: 52.68%
Current learning rate: 0.001915

=== Epoch 6 ===
Epoch 6, 17.2%	 loss: 2.720 acc@1: 44.14 mrr: 57.31, ndcg: 61.90, took: 0.85s
Epoch 6, 34.5%	 loss: 2.731 acc@1: 46.80 mrr: 58.30, ndcg: 62.36, took: 0.90s
Epoch 6, 51.7%	 loss: 2.695 acc@1: 46.25 mrr: 58.51, ndcg: 63.10, took: 0.95s
Epoch 6, 69.0%	 loss: 2.670 acc@1: 46.80 mrr: 58.91, ndcg: 63.23, took: 0.78s
Epoch 6, 86.2%	 loss: 2.715 acc@1: 45.70 mrr: 57.67, ndcg: 62.03, took: 0.82s
Validation - loss: 4.3178, acc@1: 41.03%, f1: 31.68%, mrr: 51.05%, ndcg: 54.50%
Current learning rate: 0.001872

=== Epoch 7 ===
Epoch 7, 17.2%	 loss: 2.331 acc@1: 51.33 mrr: 63.05, ndcg: 67.57, took: 0.90s
Epoch 7, 34.5%	 loss: 2.388 acc@1: 50.94 mrr: 62.37, ndcg: 66.63, took: 0.93s
Epoch 7, 51.7%	 loss: 2.428 acc@1: 49.61 mrr: 61.54, ndcg: 66.00, took: 0.84s
Epoch 7, 69.0%	 loss: 2.497 acc@1: 48.05 mrr: 60.13, ndcg: 64.36, took: 0.81s
Epoch 7, 86.2%	 loss: 2.335 acc@1: 51.17 mrr: 63.01, ndcg: 67.57, took: 0.74s
Validation - loss: 4.3062, acc@1: 40.97%, f1: 32.59%, mrr: 50.62%, ndcg: 54.12%
Current learning rate: 0.001830

=== Epoch 8 ===
Epoch 8, 17.2%	 loss: 2.013 acc@1: 54.22 mrr: 66.48, ndcg: 71.09, took: 0.69s
Epoch 8, 34.5%	 loss: 2.119 acc@1: 54.38 mrr: 66.21, ndcg: 70.81, took: 0.72s
Epoch 8, 51.7%	 loss: 2.129 acc@1: 52.97 mrr: 65.16, ndcg: 70.05, took: 0.82s
Epoch 8, 69.0%	 loss: 2.159 acc@1: 51.33 mrr: 64.05, ndcg: 69.08, took: 0.85s
Epoch 8, 86.2%	 loss: 2.145 acc@1: 53.59 mrr: 65.16, ndcg: 69.76, took: 0.81s
Validation - loss: 4.3696, acc@1: 40.67%, f1: 32.79%, mrr: 50.63%, ndcg: 54.26%
Current learning rate: 0.001787

=== Epoch 9 ===
Epoch 9, 17.2%	 loss: 1.822 acc@1: 57.27 mrr: 69.45, ndcg: 74.37, took: 0.82s
Epoch 9, 34.5%	 loss: 1.847 acc@1: 58.52 mrr: 70.02, ndcg: 74.67, took: 0.84s
Epoch 9, 51.7%	 loss: 1.814 acc@1: 57.58 mrr: 69.59, ndcg: 74.15, took: 0.89s
Epoch 9, 69.0%	 loss: 1.947 acc@1: 54.53 mrr: 67.44, ndcg: 72.91, took: 0.85s
Epoch 9, 86.2%	 loss: 1.876 acc@1: 55.31 mrr: 68.06, ndcg: 72.99, took: 0.73s
Validation - loss: 4.4242, acc@1: 39.68%, f1: 33.15%, mrr: 49.69%, ndcg: 53.35%
Current learning rate: 0.000174

=== Epoch 10 ===
Epoch 10, 17.2%	 loss: 3.049 acc@1: 41.56 mrr: 53.94, ndcg: 57.91, took: 0.77s
Epoch 10, 34.5%	 loss: 3.039 acc@1: 42.42 mrr: 54.02, ndcg: 57.87, took: 0.82s
Epoch 10, 51.7%	 loss: 2.992 acc@1: 42.34 mrr: 54.63, ndcg: 58.76, took: 0.83s
Epoch 10, 69.0%	 loss: 2.993 acc@1: 41.25 mrr: 54.07, ndcg: 58.06, took: 0.93s
Epoch 10, 86.2%	 loss: 2.971 acc@1: 42.11 mrr: 54.70, ndcg: 58.95, took: 0.95s
Validation - loss: 4.2974, acc@1: 37.73%, f1: 25.58%, mrr: 48.66%, ndcg: 52.44%
Current learning rate: 0.000174

=== Epoch 11 ===
Epoch 11, 17.2%	 loss: 3.011 acc@1: 42.27 mrr: 54.35, ndcg: 58.40, took: 0.79s
Epoch 11, 34.5%	 loss: 2.908 acc@1: 43.05 mrr: 55.33, ndcg: 59.25, took: 0.71s
Epoch 11, 51.7%	 loss: 2.890 acc@1: 42.73 mrr: 55.38, ndcg: 59.63, took: 0.67s
Epoch 11, 69.0%	 loss: 2.886 acc@1: 41.48 mrr: 55.00, ndcg: 59.58, took: 0.64s
Epoch 11, 86.2%	 loss: 2.876 acc@1: 44.06 mrr: 56.06, ndcg: 60.00, took: 0.65s
Validation - loss: 4.3125, acc@1: 38.15%, f1: 26.59%, mrr: 48.90%, ndcg: 52.69%
Current learning rate: 0.000174

=== Epoch 12 ===
Epoch 12, 17.2%	 loss: 2.934 acc@1: 40.78 mrr: 54.10, ndcg: 58.62, took: 0.69s
Epoch 12, 34.5%	 loss: 2.936 acc@1: 41.48 mrr: 54.37, ndcg: 58.55, took: 0.67s
Epoch 12, 51.7%	 loss: 2.867 acc@1: 43.59 mrr: 55.74, ndcg: 59.92, took: 0.69s
Epoch 12, 69.0%	 loss: 2.855 acc@1: 45.23 mrr: 56.83, ndcg: 60.69, took: 0.71s
Epoch 12, 86.2%	 loss: 2.704 acc@1: 46.64 mrr: 58.68, ndcg: 62.65, took: 0.72s
Validation - loss: 4.3143, acc@1: 38.81%, f1: 27.55%, mrr: 49.20%, ndcg: 52.87%
Current learning rate: 0.000174

=== Epoch 13 ===
Epoch 13, 17.2%	 loss: 2.813 acc@1: 44.22 mrr: 56.42, ndcg: 60.39, took: 0.83s
Epoch 13, 34.5%	 loss: 2.797 acc@1: 44.61 mrr: 56.92, ndcg: 61.05, took: 0.80s
Epoch 13, 51.7%	 loss: 2.807 acc@1: 44.22 mrr: 56.40, ndcg: 60.29, took: 0.79s
Epoch 13, 69.0%	 loss: 2.784 acc@1: 43.67 mrr: 56.14, ndcg: 60.28, took: 0.78s
Epoch 13, 86.2%	 loss: 2.764 acc@1: 44.06 mrr: 56.84, ndcg: 61.05, took: 0.80s
Validation - loss: 4.3187, acc@1: 38.90%, f1: 28.22%, mrr: 49.24%, ndcg: 52.87%
Current learning rate: 0.000174

=== Epoch 14 ===
Epoch 14, 17.2%	 loss: 2.794 acc@1: 45.47 mrr: 57.10, ndcg: 60.83, took: 0.83s
Epoch 14, 34.5%	 loss: 2.782 acc@1: 45.39 mrr: 56.96, ndcg: 60.80, took: 0.80s
Epoch 14, 51.7%	 loss: 2.733 acc@1: 46.17 mrr: 57.81, ndcg: 61.91, took: 0.91s
Epoch 14, 69.0%	 loss: 2.741 acc@1: 46.33 mrr: 57.83, ndcg: 61.80, took: 0.87s
Epoch 14, 86.2%	 loss: 2.812 acc@1: 44.53 mrr: 56.87, ndcg: 60.84, took: 0.87s
Validation - loss: 4.3272, acc@1: 39.44%, f1: 29.05%, mrr: 49.51%, ndcg: 53.10%
Current learning rate: 0.000174

=== Epoch 15 ===
Epoch 15, 17.2%	 loss: 2.749 acc@1: 43.59 mrr: 56.50, ndcg: 61.04, took: 0.79s
Epoch 15, 34.5%	 loss: 2.801 acc@1: 43.83 mrr: 56.26, ndcg: 60.32, took: 0.79s
Epoch 15, 51.7%	 loss: 2.729 acc@1: 45.23 mrr: 57.54, ndcg: 61.82, took: 0.83s
Epoch 15, 69.0%	 loss: 2.773 acc@1: 44.84 mrr: 57.07, ndcg: 61.37, took: 0.81s
Epoch 15, 86.2%	 loss: 2.648 acc@1: 47.89 mrr: 59.55, ndcg: 63.33, took: 0.80s
Validation - loss: 4.3275, acc@1: 39.68%, f1: 29.24%, mrr: 49.59%, ndcg: 53.12%
Current learning rate: 0.000017

=== Epoch 16 ===
Epoch 16, 17.2%	 loss: 2.980 acc@1: 40.16 mrr: 53.20, ndcg: 57.38, took: 0.81s
Epoch 16, 34.5%	 loss: 2.813 acc@1: 45.55 mrr: 57.76, ndcg: 61.63, took: 0.83s
Epoch 16, 51.7%	 loss: 2.936 acc@1: 42.97 mrr: 55.19, ndcg: 59.23, took: 0.83s
Epoch 16, 69.0%	 loss: 3.027 acc@1: 40.00 mrr: 53.25, ndcg: 57.78, took: 0.78s
Epoch 16, 86.2%	 loss: 3.020 acc@1: 41.09 mrr: 53.58, ndcg: 57.68, took: 0.83s
Validation - loss: 4.2979, acc@1: 38.06%, f1: 26.13%, mrr: 48.84%, ndcg: 52.55%
Current learning rate: 0.000017

=== Epoch 17 ===
Epoch 17, 17.2%	 loss: 3.003 acc@1: 42.81 mrr: 54.60, ndcg: 58.52, took: 0.80s
Epoch 17, 34.5%	 loss: 2.918 acc@1: 43.05 mrr: 55.40, ndcg: 59.35, took: 0.80s
Epoch 17, 51.7%	 loss: 2.891 acc@1: 41.80 mrr: 54.85, ndcg: 59.34, took: 0.82s
Epoch 17, 69.0%	 loss: 2.836 acc@1: 44.53 mrr: 56.91, ndcg: 61.00, took: 0.87s
Epoch 17, 86.2%	 loss: 2.898 acc@1: 43.98 mrr: 55.94, ndcg: 59.98, took: 0.85s
Validation - loss: 4.2963, acc@1: 38.06%, f1: 26.23%, mrr: 48.81%, ndcg: 52.55%
Current learning rate: 0.000017

=== Epoch 18 ===
Epoch 18, 17.2%	 loss: 2.889 acc@1: 44.84 mrr: 56.19, ndcg: 59.88, took: 0.83s
Epoch 18, 34.5%	 loss: 2.921 acc@1: 41.41 mrr: 54.40, ndcg: 58.64, took: 0.83s
Epoch 18, 51.7%	 loss: 2.886 acc@1: 43.67 mrr: 55.86, ndcg: 60.06, took: 0.81s
Epoch 18, 69.0%	 loss: 2.856 acc@1: 44.06 mrr: 56.02, ndcg: 59.93, took: 0.90s
Epoch 18, 86.2%	 loss: 2.966 acc@1: 42.11 mrr: 54.49, ndcg: 58.67, took: 0.81s
Validation - loss: 4.2880, acc@1: 38.30%, f1: 26.55%, mrr: 48.91%, ndcg: 52.63%
Current learning rate: 0.000017

=== Epoch 19 ===
Epoch 19, 17.2%	 loss: 2.941 acc@1: 42.89 mrr: 54.72, ndcg: 58.75, took: 0.82s
Epoch 19, 34.5%	 loss: 2.844 acc@1: 42.58 mrr: 55.94, ndcg: 60.19, took: 0.85s
Epoch 19, 51.7%	 loss: 2.924 acc@1: 43.59 mrr: 55.33, ndcg: 59.11, took: 0.82s
Epoch 19, 69.0%	 loss: 2.859 acc@1: 44.06 mrr: 56.50, ndcg: 60.81, took: 0.82s
Epoch 19, 86.2%	 loss: 3.030 acc@1: 41.56 mrr: 53.48, ndcg: 57.43, took: 0.77s
Validation - loss: 4.2965, acc@1: 37.79%, f1: 26.05%, mrr: 48.70%, ndcg: 52.49%
Current learning rate: 0.000017

=== Epoch 20 ===
Epoch 20, 17.2%	 loss: 2.821 acc@1: 43.20 mrr: 55.89, ndcg: 60.00, took: 0.79s
Epoch 20, 34.5%	 loss: 2.911 acc@1: 43.83 mrr: 55.68, ndcg: 59.53, took: 0.86s
Epoch 20, 51.7%	 loss: 2.847 acc@1: 45.39 mrr: 56.83, ndcg: 60.52, took: 0.84s
Epoch 20, 69.0%	 loss: 2.893 acc@1: 42.42 mrr: 55.11, ndcg: 59.36, took: 0.75s
Epoch 20, 86.2%	 loss: 2.954 acc@1: 41.80 mrr: 54.38, ndcg: 58.62, took: 0.78s
Validation - loss: 4.2972, acc@1: 38.06%, f1: 26.28%, mrr: 48.85%, ndcg: 52.64%
Current learning rate: 0.000017

=== Epoch 21 ===
Epoch 21, 17.2%	 loss: 2.823 acc@1: 44.22 mrr: 56.47, ndcg: 60.57, took: 0.80s
Epoch 21, 34.5%	 loss: 3.011 acc@1: 40.00 mrr: 52.87, ndcg: 57.30, took: 0.80s
Epoch 21, 51.7%	 loss: 2.947 acc@1: 42.03 mrr: 54.34, ndcg: 58.49, took: 0.81s
Epoch 21, 69.0%	 loss: 2.944 acc@1: 43.83 mrr: 55.34, ndcg: 59.12, took: 0.80s
Epoch 21, 86.2%	 loss: 2.855 acc@1: 42.58 mrr: 55.34, ndcg: 59.53, took: 0.79s
Validation - loss: 4.2962, acc@1: 38.33%, f1: 26.57%, mrr: 48.98%, ndcg: 52.69%
Current learning rate: 0.000017

=== Epoch 22 ===
Epoch 22, 17.2%	 loss: 2.890 acc@1: 42.89 mrr: 55.31, ndcg: 59.45, took: 0.84s
Epoch 22, 34.5%	 loss: 2.889 acc@1: 44.30 mrr: 56.15, ndcg: 60.05, took: 0.82s
Epoch 22, 51.7%	 loss: 2.944 acc@1: 41.64 mrr: 54.33, ndcg: 58.36, took: 0.80s
Epoch 22, 69.0%	 loss: 2.856 acc@1: 43.67 mrr: 56.05, ndcg: 60.09, took: 0.83s
Epoch 22, 86.2%	 loss: 2.863 acc@1: 42.58 mrr: 55.09, ndcg: 59.24, took: 0.84s
Validation - loss: 4.3126, acc@1: 37.82%, f1: 26.08%, mrr: 48.74%, ndcg: 52.55%
Current learning rate: 0.000017

=== Epoch 23 ===
Epoch 23, 17.2%	 loss: 2.866 acc@1: 44.77 mrr: 56.59, ndcg: 60.36, took: 0.79s
Epoch 23, 34.5%	 loss: 2.963 acc@1: 42.97 mrr: 54.85, ndcg: 58.83, took: 0.85s
Epoch 23, 51.7%	 loss: 2.810 acc@1: 43.36 mrr: 56.40, ndcg: 60.76, took: 0.85s
Epoch 23, 69.0%	 loss: 2.928 acc@1: 42.58 mrr: 55.00, ndcg: 59.17, took: 0.81s
Epoch 23, 86.2%	 loss: 2.840 acc@1: 43.83 mrr: 56.29, ndcg: 60.26, took: 0.74s
Validation - loss: 4.2946, acc@1: 38.09%, f1: 26.55%, mrr: 48.88%, ndcg: 52.61%
Training finished.	 Time: 140.84s.	 acc@1: 38.30%

=== Test Results ===
Test Results:
  acc@1: 28.90%
  acc@5: 53.23%
  acc@10: 58.71%
  mrr: 40.09%
  ndcg: 44.35%
  f1: 18.08%

=== Training Complete ===
