Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/config/ht_optuna/optuna_MHSA_geolife_prev14_t13_20251231_161349_3fb2f29c.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=215, val=90, test=96
Total trainable parameters: 383321

=== Epoch 1 ===
Epoch 1, 9.3%	 loss: 7.067 acc@1: 0.00 mrr: 0.55, ndcg: 0.40, took: 3.26s
Epoch 1, 18.6%	 loss: 7.073 acc@1: 0.00 mrr: 0.51, ndcg: 0.29, took: 1.66s
Epoch 1, 27.9%	 loss: 7.049 acc@1: 0.16 mrr: 0.66, ndcg: 0.28, took: 1.82s
Epoch 1, 37.2%	 loss: 7.049 acc@1: 0.16 mrr: 0.67, ndcg: 0.35, took: 1.87s
Epoch 1, 46.5%	 loss: 7.028 acc@1: 0.00 mrr: 0.77, ndcg: 0.56, took: 1.73s
Epoch 1, 55.8%	 loss: 7.021 acc@1: 0.16 mrr: 0.78, ndcg: 0.47, took: 1.95s
Epoch 1, 65.1%	 loss: 6.988 acc@1: 0.16 mrr: 1.24, ndcg: 1.06, took: 1.88s
Epoch 1, 74.4%	 loss: 6.963 acc@1: 0.94 mrr: 2.19, ndcg: 1.87, took: 1.92s
Epoch 1, 83.7%	 loss: 6.930 acc@1: 2.50 mrr: 4.03, ndcg: 3.80, took: 2.06s
Epoch 1, 93.0%	 loss: 6.879 acc@1: 6.72 mrr: 8.85, ndcg: 9.09, took: 1.91s
Validation - loss: 6.7337, acc@1: 16.68%, f1: 8.07%, mrr: 20.61%, ndcg: 21.92%
Current learning rate: 0.000250

=== Epoch 2 ===
Epoch 2, 9.3%	 loss: 6.745 acc@1: 15.31 mrr: 18.78, ndcg: 19.51, took: 1.82s
Epoch 2, 18.6%	 loss: 6.677 acc@1: 17.19 mrr: 21.17, ndcg: 22.44, took: 1.66s
Epoch 2, 27.9%	 loss: 6.643 acc@1: 17.50 mrr: 22.13, ndcg: 23.68, took: 1.70s
Epoch 2, 37.2%	 loss: 6.572 acc@1: 16.25 mrr: 23.14, ndcg: 25.53, took: 1.57s
Epoch 2, 46.5%	 loss: 6.469 acc@1: 17.81 mrr: 25.37, ndcg: 27.83, took: 1.79s
Epoch 2, 55.8%	 loss: 6.438 acc@1: 16.56 mrr: 23.98, ndcg: 26.65, took: 1.72s
Epoch 2, 65.1%	 loss: 6.369 acc@1: 16.25 mrr: 23.24, ndcg: 25.64, took: 1.64s
Epoch 2, 74.4%	 loss: 6.113 acc@1: 22.03 mrr: 30.05, ndcg: 33.66, took: 1.73s
Epoch 2, 83.7%	 loss: 6.039 acc@1: 20.16 mrr: 28.16, ndcg: 31.68, took: 1.85s
Epoch 2, 93.0%	 loss: 5.902 acc@1: 20.62 mrr: 29.46, ndcg: 33.30, took: 1.70s
Validation - loss: 5.6029, acc@1: 19.65%, f1: 7.26%, mrr: 29.81%, ndcg: 33.92%
Current learning rate: 0.000500

=== Epoch 3 ===
Epoch 3, 9.3%	 loss: 5.587 acc@1: 23.12 mrr: 33.14, ndcg: 37.60, took: 1.79s
Epoch 3, 18.6%	 loss: 5.630 acc@1: 20.00 mrr: 29.56, ndcg: 34.10, took: 1.64s
Epoch 3, 27.9%	 loss: 5.677 acc@1: 16.88 mrr: 26.87, ndcg: 31.51, took: 1.63s
Epoch 3, 37.2%	 loss: 5.508 acc@1: 20.47 mrr: 30.46, ndcg: 35.45, took: 1.57s
Epoch 3, 46.5%	 loss: 5.326 acc@1: 21.41 mrr: 31.97, ndcg: 36.52, took: 1.85s
Epoch 3, 55.8%	 loss: 5.247 acc@1: 21.88 mrr: 32.16, ndcg: 36.85, took: 1.70s
Epoch 3, 65.1%	 loss: 5.140 acc@1: 22.50 mrr: 33.11, ndcg: 38.26, took: 1.59s
Epoch 3, 74.4%	 loss: 5.023 acc@1: 24.06 mrr: 34.04, ndcg: 38.69, took: 1.70s
Epoch 3, 83.7%	 loss: 5.064 acc@1: 22.81 mrr: 32.44, ndcg: 36.67, took: 1.83s
Epoch 3, 93.0%	 loss: 5.000 acc@1: 20.47 mrr: 30.98, ndcg: 36.61, took: 1.81s
Validation - loss: 5.1164, acc@1: 19.62%, f1: 7.88%, mrr: 31.22%, ndcg: 36.65%
Current learning rate: 0.000490

=== Epoch 4 ===
Epoch 4, 9.3%	 loss: 4.836 acc@1: 20.16 mrr: 31.68, ndcg: 36.62, took: 1.72s
Epoch 4, 18.6%	 loss: 4.911 acc@1: 19.84 mrr: 31.20, ndcg: 35.93, took: 1.73s
Epoch 4, 27.9%	 loss: 4.614 acc@1: 24.06 mrr: 34.96, ndcg: 40.36, took: 1.66s
Epoch 4, 37.2%	 loss: 4.585 acc@1: 22.81 mrr: 34.26, ndcg: 39.50, took: 1.67s
Epoch 4, 46.5%	 loss: 4.704 acc@1: 20.78 mrr: 31.88, ndcg: 36.75, took: 1.59s
Epoch 4, 55.8%	 loss: 4.534 acc@1: 23.59 mrr: 35.26, ndcg: 40.02, took: 1.70s
Epoch 4, 65.1%	 loss: 4.813 acc@1: 20.62 mrr: 31.49, ndcg: 36.20, took: 1.68s
Epoch 4, 74.4%	 loss: 4.518 acc@1: 25.16 mrr: 36.44, ndcg: 40.84, took: 1.64s
Epoch 4, 83.7%	 loss: 4.468 acc@1: 25.00 mrr: 36.42, ndcg: 41.32, took: 1.62s
Epoch 4, 93.0%	 loss: 4.411 acc@1: 26.56 mrr: 37.82, ndcg: 42.49, took: 1.72s
Validation - loss: 4.8047, acc@1: 21.33%, f1: 10.49%, mrr: 33.73%, ndcg: 39.06%
Current learning rate: 0.000479

=== Epoch 5 ===
Epoch 5, 9.3%	 loss: 4.349 acc@1: 23.12 mrr: 36.22, ndcg: 41.67, took: 1.71s
Epoch 5, 18.6%	 loss: 4.204 acc@1: 27.81 mrr: 40.06, ndcg: 44.75, took: 1.67s
Epoch 5, 27.9%	 loss: 4.381 acc@1: 23.59 mrr: 36.40, ndcg: 41.29, took: 1.68s
Epoch 5, 37.2%	 loss: 4.595 acc@1: 23.12 mrr: 34.80, ndcg: 39.21, took: 1.62s
Epoch 5, 46.5%	 loss: 4.252 acc@1: 24.84 mrr: 38.05, ndcg: 43.06, took: 1.60s
Epoch 5, 55.8%	 loss: 4.293 acc@1: 23.75 mrr: 36.98, ndcg: 41.84, took: 1.71s
Epoch 5, 65.1%	 loss: 4.305 acc@1: 27.81 mrr: 39.32, ndcg: 44.02, took: 1.56s
Epoch 5, 74.4%	 loss: 4.227 acc@1: 28.91 mrr: 40.78, ndcg: 45.17, took: 1.71s
Epoch 5, 83.7%	 loss: 4.312 acc@1: 27.66 mrr: 39.27, ndcg: 43.53, took: 1.67s
Epoch 5, 93.0%	 loss: 4.241 acc@1: 27.19 mrr: 39.31, ndcg: 43.93, took: 1.53s
Validation - loss: 4.6899, acc@1: 25.91%, f1: 13.25%, mrr: 37.46%, ndcg: 41.87%
Current learning rate: 0.000469

=== Epoch 6 ===
Epoch 6, 9.3%	 loss: 4.099 acc@1: 27.97 mrr: 40.73, ndcg: 44.97, took: 1.63s
Epoch 6, 18.6%	 loss: 4.076 acc@1: 27.34 mrr: 41.08, ndcg: 45.77, took: 1.64s
Epoch 6, 27.9%	 loss: 4.214 acc@1: 26.88 mrr: 39.32, ndcg: 43.56, took: 1.63s
Epoch 6, 37.2%	 loss: 4.002 acc@1: 29.69 mrr: 42.40, ndcg: 46.86, took: 1.69s
Epoch 6, 46.5%	 loss: 4.057 acc@1: 27.34 mrr: 41.12, ndcg: 45.79, took: 1.79s
Epoch 6, 55.8%	 loss: 4.029 acc@1: 30.94 mrr: 43.37, ndcg: 47.81, took: 1.74s
Epoch 6, 65.1%	 loss: 3.818 acc@1: 31.88 mrr: 45.25, ndcg: 49.96, took: 1.82s
Epoch 6, 74.4%	 loss: 3.944 acc@1: 32.34 mrr: 44.55, ndcg: 48.51, took: 1.89s
Epoch 6, 83.7%	 loss: 3.979 acc@1: 31.09 mrr: 43.34, ndcg: 47.50, took: 1.68s
Epoch 6, 93.0%	 loss: 4.033 acc@1: 29.38 mrr: 41.71, ndcg: 46.25, took: 1.67s
Validation - loss: 4.5863, acc@1: 31.92%, f1: 20.38%, mrr: 42.95%, ndcg: 46.53%
Current learning rate: 0.000458

=== Epoch 7 ===
Epoch 7, 9.3%	 loss: 3.675 acc@1: 34.38 mrr: 46.69, ndcg: 51.02, took: 1.72s
Epoch 7, 18.6%	 loss: 3.699 acc@1: 33.28 mrr: 46.44, ndcg: 50.75, took: 1.75s
Epoch 7, 27.9%	 loss: 3.828 acc@1: 32.50 mrr: 45.05, ndcg: 49.17, took: 1.60s
Epoch 7, 37.2%	 loss: 3.723 acc@1: 31.25 mrr: 45.66, ndcg: 50.53, took: 1.68s
Epoch 7, 46.5%	 loss: 3.583 acc@1: 36.09 mrr: 49.24, ndcg: 53.54, took: 1.58s
Epoch 7, 55.8%	 loss: 3.775 acc@1: 31.41 mrr: 44.50, ndcg: 48.92, took: 1.61s
Epoch 7, 65.1%	 loss: 3.920 acc@1: 31.72 mrr: 44.06, ndcg: 48.15, took: 1.90s
Epoch 7, 74.4%	 loss: 3.884 acc@1: 32.34 mrr: 44.90, ndcg: 48.45, took: 1.69s
Epoch 7, 83.7%	 loss: 3.767 acc@1: 32.81 mrr: 45.82, ndcg: 49.85, took: 1.68s
Epoch 7, 93.0%	 loss: 3.676 acc@1: 33.75 mrr: 47.13, ndcg: 51.54, took: 1.90s
Validation - loss: 4.5086, acc@1: 35.17%, f1: 22.34%, mrr: 45.90%, ndcg: 49.47%
Current learning rate: 0.000448

=== Epoch 8 ===
Epoch 8, 9.3%	 loss: 3.595 acc@1: 33.91 mrr: 47.53, ndcg: 51.71, took: 1.71s
Epoch 8, 18.6%	 loss: 3.533 acc@1: 33.44 mrr: 47.82, ndcg: 52.45, took: 1.71s
Epoch 8, 27.9%	 loss: 3.539 acc@1: 36.09 mrr: 49.59, ndcg: 53.87, took: 1.84s
Epoch 8, 37.2%	 loss: 3.723 acc@1: 34.06 mrr: 46.63, ndcg: 50.80, took: 1.79s
Epoch 8, 46.5%	 loss: 3.710 acc@1: 35.31 mrr: 46.99, ndcg: 51.00, took: 1.64s
Epoch 8, 55.8%	 loss: 3.424 acc@1: 37.19 mrr: 50.07, ndcg: 54.38, took: 1.69s
Epoch 8, 65.1%	 loss: 3.442 acc@1: 34.22 mrr: 48.98, ndcg: 53.84, took: 1.73s
Epoch 8, 74.4%	 loss: 3.578 acc@1: 33.28 mrr: 47.46, ndcg: 52.23, took: 1.71s
Epoch 8, 83.7%	 loss: 3.517 acc@1: 35.78 mrr: 48.74, ndcg: 52.61, took: 1.70s
Epoch 8, 93.0%	 loss: 3.426 acc@1: 36.41 mrr: 49.34, ndcg: 53.74, took: 1.84s
Validation - loss: 4.3899, acc@1: 36.50%, f1: 23.88%, mrr: 47.46%, ndcg: 51.21%
Current learning rate: 0.000438

=== Epoch 9 ===
Epoch 9, 9.3%	 loss: 3.462 acc@1: 35.47 mrr: 49.16, ndcg: 53.48, took: 1.61s
Epoch 9, 18.6%	 loss: 3.224 acc@1: 39.22 mrr: 52.47, ndcg: 57.00, took: 1.69s
Epoch 9, 27.9%	 loss: 3.414 acc@1: 36.88 mrr: 50.16, ndcg: 54.39, took: 1.64s
Epoch 9, 37.2%	 loss: 3.487 acc@1: 34.69 mrr: 48.31, ndcg: 52.63, took: 1.65s
Epoch 9, 46.5%	 loss: 3.460 acc@1: 36.88 mrr: 50.20, ndcg: 54.57, took: 1.64s
Epoch 9, 55.8%	 loss: 3.541 acc@1: 34.38 mrr: 47.99, ndcg: 52.60, took: 1.68s
Epoch 9, 65.1%	 loss: 3.422 acc@1: 35.31 mrr: 48.79, ndcg: 53.12, took: 1.72s
Epoch 9, 74.4%	 loss: 3.266 acc@1: 37.66 mrr: 51.71, ndcg: 56.20, took: 1.74s
Epoch 9, 83.7%	 loss: 3.389 acc@1: 36.09 mrr: 49.40, ndcg: 53.75, took: 1.75s
Epoch 9, 93.0%	 loss: 3.516 acc@1: 33.44 mrr: 47.74, ndcg: 52.35, took: 1.74s
Validation - loss: 4.4321, acc@1: 36.50%, f1: 24.39%, mrr: 47.16%, ndcg: 50.97%
Current learning rate: 0.000427

=== Epoch 10 ===
Epoch 10, 9.3%	 loss: 3.295 acc@1: 37.19 mrr: 51.19, ndcg: 55.47, took: 1.80s
Epoch 10, 18.6%	 loss: 3.303 acc@1: 38.59 mrr: 51.08, ndcg: 54.51, took: 1.65s
Epoch 10, 27.9%	 loss: 3.303 acc@1: 37.81 mrr: 51.19, ndcg: 55.40, took: 1.65s
Epoch 10, 37.2%	 loss: 3.300 acc@1: 37.66 mrr: 50.77, ndcg: 55.12, took: 1.61s
Epoch 10, 46.5%	 loss: 3.332 acc@1: 35.78 mrr: 49.75, ndcg: 54.06, took: 1.77s
Epoch 10, 55.8%	 loss: 3.268 acc@1: 35.94 mrr: 50.68, ndcg: 55.52, took: 1.59s
Epoch 10, 65.1%	 loss: 3.192 acc@1: 40.78 mrr: 53.25, ndcg: 57.22, took: 1.80s
Epoch 10, 74.4%	 loss: 3.350 acc@1: 36.56 mrr: 50.73, ndcg: 55.13, took: 1.81s
Epoch 10, 83.7%	 loss: 3.328 acc@1: 35.78 mrr: 49.76, ndcg: 54.24, took: 1.64s
Epoch 10, 93.0%	 loss: 3.336 acc@1: 35.94 mrr: 49.82, ndcg: 54.25, took: 1.77s
Validation - loss: 4.3429, acc@1: 37.97%, f1: 25.33%, mrr: 48.73%, ndcg: 52.44%
Current learning rate: 0.000417

=== Epoch 11 ===
Epoch 11, 9.3%	 loss: 3.365 acc@1: 35.31 mrr: 49.10, ndcg: 53.31, took: 1.78s
Epoch 11, 18.6%	 loss: 3.244 acc@1: 36.88 mrr: 50.62, ndcg: 55.36, took: 1.58s
Epoch 11, 27.9%	 loss: 3.108 acc@1: 40.47 mrr: 53.29, ndcg: 57.13, took: 1.81s
Epoch 11, 37.2%	 loss: 3.188 acc@1: 40.16 mrr: 52.52, ndcg: 56.58, took: 1.76s
Epoch 11, 46.5%	 loss: 3.195 acc@1: 37.34 mrr: 50.90, ndcg: 55.36, took: 1.82s
Epoch 11, 55.8%	 loss: 3.367 acc@1: 37.19 mrr: 49.72, ndcg: 53.54, took: 1.78s
Epoch 11, 65.1%	 loss: 3.265 acc@1: 37.50 mrr: 50.94, ndcg: 55.02, took: 1.70s
Epoch 11, 74.4%	 loss: 3.222 acc@1: 39.69 mrr: 52.05, ndcg: 56.18, took: 1.64s
Epoch 11, 83.7%	 loss: 3.002 acc@1: 40.31 mrr: 54.25, ndcg: 59.03, took: 1.57s
Epoch 11, 93.0%	 loss: 3.110 acc@1: 40.62 mrr: 53.65, ndcg: 57.91, took: 1.74s
Validation - loss: 4.3844, acc@1: 38.46%, f1: 26.26%, mrr: 49.23%, ndcg: 52.89%
Current learning rate: 0.000406

=== Epoch 12 ===
Epoch 12, 9.3%	 loss: 3.211 acc@1: 38.44 mrr: 51.63, ndcg: 55.88, took: 1.67s
Epoch 12, 18.6%	 loss: 2.995 acc@1: 40.62 mrr: 53.79, ndcg: 58.44, took: 1.77s
Epoch 12, 27.9%	 loss: 2.847 acc@1: 40.94 mrr: 55.29, ndcg: 59.76, took: 1.62s
Epoch 12, 37.2%	 loss: 3.044 acc@1: 39.53 mrr: 53.48, ndcg: 58.09, took: 1.66s
Epoch 12, 46.5%	 loss: 3.261 acc@1: 37.34 mrr: 50.37, ndcg: 54.66, took: 1.63s
Epoch 12, 55.8%	 loss: 3.120 acc@1: 37.66 mrr: 51.97, ndcg: 56.36, took: 1.57s
Epoch 12, 65.1%	 loss: 3.089 acc@1: 37.34 mrr: 51.84, ndcg: 56.58, took: 1.78s
Epoch 12, 74.4%	 loss: 3.166 acc@1: 38.59 mrr: 52.22, ndcg: 56.68, took: 1.84s
Epoch 12, 83.7%	 loss: 3.233 acc@1: 37.66 mrr: 50.83, ndcg: 55.12, took: 1.83s
Epoch 12, 93.0%	 loss: 3.236 acc@1: 35.94 mrr: 50.14, ndcg: 54.46, took: 1.70s
Validation - loss: 4.3708, acc@1: 38.57%, f1: 26.01%, mrr: 49.71%, ndcg: 53.39%
Current learning rate: 0.000396

=== Epoch 13 ===
Epoch 13, 9.3%	 loss: 3.033 acc@1: 42.03 mrr: 54.65, ndcg: 58.50, took: 1.76s
Epoch 13, 18.6%	 loss: 2.880 acc@1: 41.09 mrr: 55.57, ndcg: 60.11, took: 1.73s
Epoch 13, 27.9%	 loss: 2.890 acc@1: 41.56 mrr: 55.65, ndcg: 60.12, took: 1.70s
Epoch 13, 37.2%	 loss: 3.206 acc@1: 36.41 mrr: 50.33, ndcg: 54.85, took: 1.70s
Epoch 13, 46.5%	 loss: 3.043 acc@1: 39.06 mrr: 52.36, ndcg: 57.07, took: 1.66s
Epoch 13, 55.8%	 loss: 3.178 acc@1: 37.97 mrr: 51.46, ndcg: 55.51, took: 1.62s
Epoch 13, 65.1%	 loss: 3.181 acc@1: 38.91 mrr: 51.78, ndcg: 55.99, took: 1.71s
Epoch 13, 74.4%	 loss: 3.136 acc@1: 39.69 mrr: 52.03, ndcg: 55.95, took: 1.59s
Epoch 13, 83.7%	 loss: 2.881 acc@1: 43.28 mrr: 56.38, ndcg: 60.83, took: 1.71s
Epoch 13, 93.0%	 loss: 3.091 acc@1: 38.91 mrr: 52.32, ndcg: 56.92, took: 1.64s
Validation - loss: 4.3803, acc@1: 38.04%, f1: 25.50%, mrr: 49.56%, ndcg: 53.28%
Current learning rate: 0.000385

=== Epoch 14 ===
Epoch 14, 9.3%	 loss: 2.994 acc@1: 38.75 mrr: 53.07, ndcg: 57.34, took: 1.82s
Epoch 14, 18.6%	 loss: 3.033 acc@1: 39.84 mrr: 53.01, ndcg: 57.44, took: 1.68s
Epoch 14, 27.9%	 loss: 3.150 acc@1: 37.97 mrr: 51.38, ndcg: 56.00, took: 1.59s
Epoch 14, 37.2%	 loss: 2.940 acc@1: 40.00 mrr: 54.06, ndcg: 58.99, took: 1.64s
Epoch 14, 46.5%	 loss: 2.894 acc@1: 42.97 mrr: 55.61, ndcg: 59.61, took: 1.76s
Epoch 14, 55.8%	 loss: 2.963 acc@1: 42.81 mrr: 54.80, ndcg: 58.74, took: 1.77s
Epoch 14, 65.1%	 loss: 2.972 acc@1: 41.41 mrr: 54.20, ndcg: 58.43, took: 1.68s
Epoch 14, 74.4%	 loss: 2.933 acc@1: 40.94 mrr: 54.15, ndcg: 58.53, took: 1.76s
Epoch 14, 83.7%	 loss: 2.877 acc@1: 41.88 mrr: 55.31, ndcg: 59.66, took: 1.60s
Epoch 14, 93.0%	 loss: 3.023 acc@1: 37.97 mrr: 53.01, ndcg: 57.56, took: 1.58s
Validation - loss: 4.3424, acc@1: 37.87%, f1: 25.61%, mrr: 49.46%, ndcg: 53.22%
Current learning rate: 0.000375

=== Epoch 15 ===
Epoch 15, 9.3%	 loss: 2.795 acc@1: 45.00 mrr: 57.58, ndcg: 61.63, took: 1.54s
Epoch 15, 18.6%	 loss: 3.003 acc@1: 38.75 mrr: 52.67, ndcg: 57.19, took: 1.71s
Epoch 15, 27.9%	 loss: 2.880 acc@1: 41.25 mrr: 54.81, ndcg: 59.11, took: 1.59s
Epoch 15, 37.2%	 loss: 2.854 acc@1: 41.88 mrr: 54.85, ndcg: 59.38, took: 1.63s
Epoch 15, 46.5%	 loss: 3.065 acc@1: 39.06 mrr: 52.67, ndcg: 56.81, took: 1.71s
Epoch 15, 55.8%	 loss: 2.844 acc@1: 41.25 mrr: 55.38, ndcg: 59.62, took: 1.81s
Epoch 15, 65.1%	 loss: 2.897 acc@1: 39.53 mrr: 53.50, ndcg: 58.36, took: 1.59s
Epoch 15, 74.4%	 loss: 2.911 acc@1: 41.88 mrr: 54.57, ndcg: 58.89, took: 1.61s
Epoch 15, 83.7%	 loss: 2.896 acc@1: 40.16 mrr: 54.19, ndcg: 58.72, took: 1.62s
Epoch 15, 93.0%	 loss: 2.902 acc@1: 41.88 mrr: 55.16, ndcg: 59.32, took: 1.58s
Validation - loss: 4.4614, acc@1: 38.78%, f1: 27.32%, mrr: 49.95%, ndcg: 53.63%
Current learning rate: 0.000036

=== Epoch 16 ===
Epoch 16, 9.3%	 loss: 3.119 acc@1: 40.16 mrr: 53.27, ndcg: 57.72, took: 1.55s
Epoch 16, 18.6%	 loss: 3.143 acc@1: 40.00 mrr: 53.22, ndcg: 57.47, took: 1.56s
Epoch 16, 27.9%	 loss: 3.300 acc@1: 36.25 mrr: 49.53, ndcg: 53.92, took: 1.64s
Epoch 16, 37.2%	 loss: 3.213 acc@1: 38.91 mrr: 51.44, ndcg: 55.55, took: 1.53s
Epoch 16, 46.5%	 loss: 3.038 acc@1: 38.44 mrr: 52.69, ndcg: 57.43, took: 1.66s
Epoch 16, 55.8%	 loss: 3.051 acc@1: 38.59 mrr: 52.77, ndcg: 57.08, took: 1.63s
Epoch 16, 65.1%	 loss: 3.173 acc@1: 37.81 mrr: 51.49, ndcg: 55.58, took: 1.61s
Epoch 16, 74.4%	 loss: 3.267 acc@1: 37.81 mrr: 50.96, ndcg: 54.98, took: 1.55s
Epoch 16, 83.7%	 loss: 3.193 acc@1: 38.28 mrr: 51.63, ndcg: 55.58, took: 1.52s
Epoch 16, 93.0%	 loss: 3.164 acc@1: 37.97 mrr: 52.10, ndcg: 56.42, took: 1.57s
Validation - loss: 4.3388, acc@1: 38.46%, f1: 25.85%, mrr: 49.22%, ndcg: 52.86%
Current learning rate: 0.000036

=== Epoch 17 ===
Epoch 17, 9.3%	 loss: 3.051 acc@1: 36.09 mrr: 51.31, ndcg: 56.72, took: 1.74s
Epoch 17, 18.6%	 loss: 3.200 acc@1: 39.38 mrr: 52.25, ndcg: 56.56, took: 1.56s
Epoch 17, 27.9%	 loss: 3.228 acc@1: 37.81 mrr: 50.85, ndcg: 54.55, took: 1.63s
Epoch 17, 37.2%	 loss: 3.138 acc@1: 42.50 mrr: 54.32, ndcg: 57.98, took: 1.72s
Epoch 17, 46.5%	 loss: 3.146 acc@1: 37.66 mrr: 51.60, ndcg: 56.05, took: 1.68s
Epoch 17, 55.8%	 loss: 3.306 acc@1: 38.59 mrr: 50.44, ndcg: 54.03, took: 1.61s
Epoch 17, 65.1%	 loss: 3.139 acc@1: 36.88 mrr: 51.81, ndcg: 56.48, took: 1.59s
Epoch 17, 74.4%	 loss: 3.142 acc@1: 41.25 mrr: 53.16, ndcg: 56.96, took: 1.59s
Epoch 17, 83.7%	 loss: 3.292 acc@1: 37.03 mrr: 50.13, ndcg: 54.12, took: 1.45s
Epoch 17, 93.0%	 loss: 3.072 acc@1: 42.03 mrr: 54.38, ndcg: 58.24, took: 1.57s
Validation - loss: 4.3546, acc@1: 38.57%, f1: 25.94%, mrr: 49.26%, ndcg: 52.87%
Current learning rate: 0.000036

=== Epoch 18 ===
Epoch 18, 9.3%	 loss: 2.898 acc@1: 42.66 mrr: 56.17, ndcg: 60.63, took: 1.64s
Epoch 18, 18.6%	 loss: 3.067 acc@1: 40.47 mrr: 53.66, ndcg: 57.90, took: 1.80s
Epoch 18, 27.9%	 loss: 3.249 acc@1: 40.16 mrr: 52.25, ndcg: 56.20, took: 1.47s
Epoch 18, 37.2%	 loss: 3.091 acc@1: 37.97 mrr: 52.14, ndcg: 56.67, took: 1.49s
Epoch 18, 46.5%	 loss: 3.171 acc@1: 38.91 mrr: 52.38, ndcg: 56.39, took: 1.42s
Epoch 18, 55.8%	 loss: 3.258 acc@1: 36.88 mrr: 50.34, ndcg: 54.38, took: 1.55s
Epoch 18, 65.1%	 loss: 3.272 acc@1: 37.03 mrr: 50.84, ndcg: 55.16, took: 1.55s
Epoch 18, 74.4%	 loss: 3.142 acc@1: 37.50 mrr: 51.45, ndcg: 55.92, took: 1.40s
Epoch 18, 83.7%	 loss: 3.114 acc@1: 40.16 mrr: 53.04, ndcg: 57.17, took: 1.52s
Epoch 18, 93.0%	 loss: 3.207 acc@1: 38.12 mrr: 51.45, ndcg: 55.47, took: 1.31s
Validation - loss: 4.3270, acc@1: 38.64%, f1: 26.06%, mrr: 49.31%, ndcg: 52.89%
Current learning rate: 0.000036

=== Epoch 19 ===
Epoch 19, 9.3%	 loss: 3.074 acc@1: 39.53 mrr: 52.67, ndcg: 57.00, took: 1.57s
Epoch 19, 18.6%	 loss: 3.226 acc@1: 38.44 mrr: 51.77, ndcg: 56.13, took: 1.44s
Epoch 19, 27.9%	 loss: 3.068 acc@1: 40.16 mrr: 53.61, ndcg: 57.92, took: 1.37s
Epoch 19, 37.2%	 loss: 3.079 acc@1: 40.78 mrr: 54.14, ndcg: 58.53, took: 1.43s
Epoch 19, 46.5%	 loss: 3.150 acc@1: 36.72 mrr: 51.18, ndcg: 55.43, took: 1.36s
Epoch 19, 55.8%	 loss: 3.080 acc@1: 39.06 mrr: 52.92, ndcg: 57.66, took: 1.40s
Epoch 19, 65.1%	 loss: 3.117 acc@1: 40.47 mrr: 53.37, ndcg: 57.53, took: 1.47s
Epoch 19, 74.4%	 loss: 3.312 acc@1: 35.62 mrr: 49.24, ndcg: 53.60, took: 1.40s
Epoch 19, 83.7%	 loss: 3.275 acc@1: 36.56 mrr: 49.84, ndcg: 54.17, took: 1.40s
Epoch 19, 93.0%	 loss: 3.265 acc@1: 39.22 mrr: 51.84, ndcg: 55.63, took: 1.37s
Validation - loss: 4.3181, acc@1: 38.81%, f1: 26.18%, mrr: 49.47%, ndcg: 53.05%
Current learning rate: 0.000036

=== Epoch 20 ===
Epoch 20, 9.3%	 loss: 3.144 acc@1: 39.69 mrr: 52.67, ndcg: 56.74, took: 1.33s
Epoch 20, 18.6%	 loss: 3.203 acc@1: 37.03 mrr: 51.04, ndcg: 55.30, took: 1.39s
Epoch 20, 27.9%	 loss: 3.215 acc@1: 37.03 mrr: 50.58, ndcg: 55.12, took: 1.44s
Epoch 20, 37.2%	 loss: 2.999 acc@1: 42.34 mrr: 54.80, ndcg: 58.83, took: 1.34s
Epoch 20, 46.5%	 loss: 3.206 acc@1: 38.28 mrr: 51.27, ndcg: 55.51, took: 1.30s
Epoch 20, 55.8%	 loss: 3.156 acc@1: 39.22 mrr: 52.41, ndcg: 56.51, took: 1.34s
Epoch 20, 65.1%	 loss: 3.139 acc@1: 38.91 mrr: 52.36, ndcg: 56.27, took: 1.29s
Epoch 20, 74.4%	 loss: 3.058 acc@1: 40.00 mrr: 53.14, ndcg: 57.54, took: 1.39s
Epoch 20, 83.7%	 loss: 3.123 acc@1: 39.84 mrr: 53.15, ndcg: 57.40, took: 1.47s
Epoch 20, 93.0%	 loss: 3.181 acc@1: 37.97 mrr: 51.40, ndcg: 55.55, took: 1.25s
Validation - loss: 4.3542, acc@1: 38.43%, f1: 26.05%, mrr: 49.18%, ndcg: 52.82%
Current learning rate: 0.000036

=== Epoch 21 ===
Epoch 21, 9.3%	 loss: 3.198 acc@1: 38.44 mrr: 51.70, ndcg: 55.97, took: 1.38s
Epoch 21, 18.6%	 loss: 3.264 acc@1: 38.75 mrr: 51.75, ndcg: 55.55, took: 1.35s
Epoch 21, 27.9%	 loss: 3.060 acc@1: 39.53 mrr: 52.82, ndcg: 56.99, took: 1.35s
Epoch 21, 37.2%	 loss: 3.129 acc@1: 40.00 mrr: 52.98, ndcg: 57.13, took: 1.29s
Epoch 21, 46.5%	 loss: 3.061 acc@1: 38.75 mrr: 52.90, ndcg: 57.52, took: 1.21s
Epoch 21, 55.8%	 loss: 3.138 acc@1: 41.41 mrr: 53.80, ndcg: 57.40, took: 1.21s
Epoch 21, 65.1%	 loss: 3.115 acc@1: 40.00 mrr: 52.79, ndcg: 57.07, took: 1.23s
Epoch 21, 74.4%	 loss: 3.081 acc@1: 37.34 mrr: 52.00, ndcg: 56.61, took: 1.31s
Epoch 21, 83.7%	 loss: 3.240 acc@1: 36.88 mrr: 50.07, ndcg: 54.37, took: 1.30s
Epoch 21, 93.0%	 loss: 3.168 acc@1: 40.16 mrr: 52.61, ndcg: 56.56, took: 1.27s
Validation - loss: 4.3336, acc@1: 38.67%, f1: 26.10%, mrr: 49.44%, ndcg: 53.05%
Current learning rate: 0.000036

=== Epoch 22 ===
Epoch 22, 9.3%	 loss: 3.048 acc@1: 42.03 mrr: 54.97, ndcg: 58.83, took: 1.15s
Epoch 22, 18.6%	 loss: 3.146 acc@1: 36.09 mrr: 50.83, ndcg: 55.58, took: 1.08s
Epoch 22, 27.9%	 loss: 3.160 acc@1: 38.12 mrr: 51.94, ndcg: 56.54, took: 1.13s
Epoch 22, 37.2%	 loss: 3.140 acc@1: 40.78 mrr: 52.87, ndcg: 56.69, took: 1.16s
Epoch 22, 46.5%	 loss: 3.086 acc@1: 39.38 mrr: 52.35, ndcg: 56.51, took: 1.10s
Epoch 22, 55.8%	 loss: 3.023 acc@1: 39.38 mrr: 53.16, ndcg: 57.78, took: 1.10s
Epoch 22, 65.1%	 loss: 2.900 acc@1: 41.72 mrr: 55.64, ndcg: 59.83, took: 0.99s
Epoch 22, 74.4%	 loss: 3.215 acc@1: 38.28 mrr: 51.48, ndcg: 55.55, took: 0.99s
Epoch 22, 83.7%	 loss: 3.205 acc@1: 37.03 mrr: 50.68, ndcg: 54.87, took: 0.99s
Epoch 22, 93.0%	 loss: 3.202 acc@1: 39.22 mrr: 51.85, ndcg: 55.80, took: 1.01s
Validation - loss: 4.3419, acc@1: 38.50%, f1: 26.01%, mrr: 49.32%, ndcg: 52.94%
Current learning rate: 0.000036

=== Epoch 23 ===
Epoch 23, 9.3%	 loss: 3.066 acc@1: 38.28 mrr: 52.55, ndcg: 57.13, took: 1.02s
Epoch 23, 18.6%	 loss: 3.126 acc@1: 38.75 mrr: 52.16, ndcg: 56.61, took: 1.02s
Epoch 23, 27.9%	 loss: 3.295 acc@1: 38.28 mrr: 50.28, ndcg: 53.82, took: 1.03s
Epoch 23, 37.2%	 loss: 3.071 acc@1: 40.00 mrr: 53.50, ndcg: 57.78, took: 1.03s
Epoch 23, 46.5%	 loss: 3.205 acc@1: 37.97 mrr: 51.46, ndcg: 55.55, took: 0.99s
Epoch 23, 55.8%	 loss: 3.084 acc@1: 38.28 mrr: 51.89, ndcg: 55.94, took: 1.03s
Epoch 23, 65.1%	 loss: 3.156 acc@1: 40.16 mrr: 52.95, ndcg: 57.00, took: 0.93s
Epoch 23, 74.4%	 loss: 3.120 acc@1: 40.00 mrr: 53.18, ndcg: 56.64, took: 0.90s
Epoch 23, 83.7%	 loss: 2.949 acc@1: 41.72 mrr: 55.04, ndcg: 59.56, took: 0.85s
Epoch 23, 93.0%	 loss: 3.127 acc@1: 38.28 mrr: 52.31, ndcg: 56.78, took: 0.80s
Validation - loss: 4.3426, acc@1: 38.78%, f1: 26.14%, mrr: 49.50%, ndcg: 53.12%
Current learning rate: 0.000036

=== Epoch 24 ===
Epoch 24, 9.3%	 loss: 3.134 acc@1: 40.78 mrr: 53.24, ndcg: 57.23, took: 0.82s
Epoch 24, 18.6%	 loss: 2.980 acc@1: 40.31 mrr: 54.02, ndcg: 58.37, took: 0.82s
Epoch 24, 27.9%	 loss: 2.959 acc@1: 42.50 mrr: 55.47, ndcg: 59.92, took: 0.83s
Epoch 24, 37.2%	 loss: 3.134 acc@1: 37.34 mrr: 51.18, ndcg: 55.39, took: 0.83s
Epoch 24, 46.5%	 loss: 3.123 acc@1: 38.28 mrr: 51.88, ndcg: 56.13, took: 0.83s
Epoch 24, 55.8%	 loss: 3.197 acc@1: 36.72 mrr: 50.72, ndcg: 55.12, took: 0.82s
Epoch 24, 65.1%	 loss: 3.059 acc@1: 39.69 mrr: 53.11, ndcg: 57.38, took: 0.84s
Epoch 24, 74.4%	 loss: 3.083 acc@1: 41.41 mrr: 54.16, ndcg: 58.40, took: 0.83s
Epoch 24, 83.7%	 loss: 3.108 acc@1: 40.00 mrr: 53.13, ndcg: 56.98, took: 0.82s
Epoch 24, 93.0%	 loss: 3.095 acc@1: 39.06 mrr: 52.33, ndcg: 56.45, took: 0.82s
Validation - loss: 4.3432, acc@1: 38.39%, f1: 26.03%, mrr: 49.29%, ndcg: 52.96%
Current learning rate: 0.000004

=== Epoch 25 ===
Epoch 25, 9.3%	 loss: 3.268 acc@1: 37.34 mrr: 50.26, ndcg: 54.28, took: 0.81s
Epoch 25, 18.6%	 loss: 3.008 acc@1: 40.00 mrr: 53.81, ndcg: 58.33, took: 0.83s
Epoch 25, 27.9%	 loss: 3.186 acc@1: 37.03 mrr: 50.98, ndcg: 55.61, took: 0.84s
Epoch 25, 37.2%	 loss: 3.116 acc@1: 40.47 mrr: 53.46, ndcg: 57.51, took: 0.84s
Epoch 25, 46.5%	 loss: 3.256 acc@1: 35.94 mrr: 49.98, ndcg: 54.04, took: 0.82s
Epoch 25, 55.8%	 loss: 3.112 acc@1: 39.22 mrr: 52.46, ndcg: 56.64, took: 0.82s
Epoch 25, 65.1%	 loss: 3.318 acc@1: 39.84 mrr: 50.82, ndcg: 54.01, took: 0.82s
Epoch 25, 74.4%	 loss: 2.861 acc@1: 42.66 mrr: 56.55, ndcg: 61.13, took: 0.81s
Epoch 25, 83.7%	 loss: 3.230 acc@1: 36.88 mrr: 50.42, ndcg: 54.58, took: 0.83s
Epoch 25, 93.0%	 loss: 2.934 acc@1: 42.19 mrr: 55.70, ndcg: 59.97, took: 0.82s
Validation - loss: 4.3425, acc@1: 38.60%, f1: 26.13%, mrr: 49.33%, ndcg: 52.94%
Current learning rate: 0.000004

=== Epoch 26 ===
Epoch 26, 9.3%	 loss: 3.196 acc@1: 37.50 mrr: 51.20, ndcg: 55.60, took: 0.81s
Epoch 26, 18.6%	 loss: 2.961 acc@1: 42.19 mrr: 55.27, ndcg: 59.62, took: 0.82s
Epoch 26, 27.9%	 loss: 3.272 acc@1: 37.19 mrr: 50.47, ndcg: 54.55, took: 0.84s
Epoch 26, 37.2%	 loss: 3.098 acc@1: 41.56 mrr: 54.43, ndcg: 58.63, took: 0.81s
Epoch 26, 46.5%	 loss: 3.260 acc@1: 36.25 mrr: 49.91, ndcg: 54.05, took: 0.82s
Epoch 26, 55.8%	 loss: 3.083 acc@1: 38.91 mrr: 52.42, ndcg: 56.78, took: 0.82s
Epoch 26, 65.1%	 loss: 3.179 acc@1: 41.25 mrr: 52.90, ndcg: 56.99, took: 0.81s
Epoch 26, 74.4%	 loss: 3.142 acc@1: 38.91 mrr: 52.24, ndcg: 56.53, took: 0.82s
Epoch 26, 83.7%	 loss: 3.155 acc@1: 35.78 mrr: 50.34, ndcg: 55.10, took: 0.80s
Epoch 26, 93.0%	 loss: 3.062 acc@1: 42.03 mrr: 54.78, ndcg: 58.66, took: 0.81s
Validation - loss: 4.3437, acc@1: 38.60%, f1: 25.94%, mrr: 49.37%, ndcg: 52.97%
Current learning rate: 0.000004

=== Epoch 27 ===
Epoch 27, 9.3%	 loss: 3.261 acc@1: 39.84 mrr: 52.06, ndcg: 56.03, took: 0.82s
Epoch 27, 18.6%	 loss: 3.103 acc@1: 41.09 mrr: 53.88, ndcg: 57.95, took: 0.81s
Epoch 27, 27.9%	 loss: 3.164 acc@1: 37.50 mrr: 51.52, ndcg: 55.95, took: 0.82s
Epoch 27, 37.2%	 loss: 3.110 acc@1: 39.22 mrr: 52.40, ndcg: 56.40, took: 0.83s
Epoch 27, 46.5%	 loss: 3.190 acc@1: 37.50 mrr: 50.94, ndcg: 55.47, took: 0.81s
Epoch 27, 55.8%	 loss: 3.075 acc@1: 39.53 mrr: 52.86, ndcg: 57.19, took: 0.82s
Epoch 27, 65.1%	 loss: 2.975 acc@1: 39.69 mrr: 53.49, ndcg: 58.02, took: 0.84s
Epoch 27, 74.4%	 loss: 3.076 acc@1: 40.47 mrr: 53.60, ndcg: 57.88, took: 0.82s
Epoch 27, 83.7%	 loss: 3.113 acc@1: 36.56 mrr: 51.39, ndcg: 56.07, took: 0.81s
Epoch 27, 93.0%	 loss: 3.186 acc@1: 38.59 mrr: 51.38, ndcg: 55.07, took: 0.84s
Validation - loss: 4.3375, acc@1: 38.67%, f1: 26.18%, mrr: 49.37%, ndcg: 52.95%
Current learning rate: 0.000004

=== Epoch 28 ===
Epoch 28, 9.3%	 loss: 3.313 acc@1: 35.31 mrr: 49.11, ndcg: 53.44, took: 0.81s
Epoch 28, 18.6%	 loss: 3.005 acc@1: 42.34 mrr: 54.98, ndcg: 59.19, took: 0.83s
Epoch 28, 27.9%	 loss: 3.223 acc@1: 40.31 mrr: 52.38, ndcg: 56.11, took: 0.83s
Epoch 28, 37.2%	 loss: 2.973 acc@1: 38.91 mrr: 53.06, ndcg: 57.61, took: 0.81s
Epoch 28, 46.5%	 loss: 3.365 acc@1: 36.72 mrr: 49.36, ndcg: 53.12, took: 0.81s
Epoch 28, 55.8%	 loss: 3.060 acc@1: 39.53 mrr: 53.31, ndcg: 57.73, took: 0.81s
Epoch 28, 65.1%	 loss: 3.085 acc@1: 42.19 mrr: 54.28, ndcg: 58.32, took: 0.81s
Epoch 28, 74.4%	 loss: 3.146 acc@1: 38.44 mrr: 51.65, ndcg: 55.78, took: 0.81s
Epoch 28, 83.7%	 loss: 3.032 acc@1: 39.06 mrr: 53.61, ndcg: 58.40, took: 0.81s
Epoch 28, 93.0%	 loss: 3.122 acc@1: 38.59 mrr: 52.34, ndcg: 57.09, took: 0.81s
Validation - loss: 4.3420, acc@1: 38.71%, f1: 26.16%, mrr: 49.38%, ndcg: 52.97%
Current learning rate: 0.000004

=== Epoch 29 ===
Epoch 29, 9.3%	 loss: 3.128 acc@1: 38.28 mrr: 51.95, ndcg: 56.22, took: 0.84s
Epoch 29, 18.6%	 loss: 3.305 acc@1: 36.72 mrr: 49.57, ndcg: 53.72, took: 0.82s
Epoch 29, 27.9%	 loss: 3.047 acc@1: 40.62 mrr: 54.11, ndcg: 58.27, took: 0.84s
Epoch 29, 37.2%	 loss: 3.176 acc@1: 40.16 mrr: 52.69, ndcg: 56.87, took: 0.82s
Epoch 29, 46.5%	 loss: 3.196 acc@1: 40.31 mrr: 52.94, ndcg: 57.14, took: 0.82s
Epoch 29, 55.8%	 loss: 3.121 acc@1: 36.88 mrr: 51.42, ndcg: 55.95, took: 0.81s
Epoch 29, 65.1%	 loss: 3.054 acc@1: 40.94 mrr: 54.38, ndcg: 58.54, took: 0.82s
Epoch 29, 74.4%	 loss: 3.029 acc@1: 38.75 mrr: 52.69, ndcg: 57.21, took: 0.80s
Epoch 29, 83.7%	 loss: 3.078 acc@1: 40.62 mrr: 53.36, ndcg: 57.39, took: 0.81s
Epoch 29, 93.0%	 loss: 3.175 acc@1: 40.47 mrr: 52.64, ndcg: 56.22, took: 0.81s
Validation - loss: 4.3476, acc@1: 38.60%, f1: 26.01%, mrr: 49.37%, ndcg: 53.00%
Training finished.	 Time: 551.51s.	 acc@1: 38.81%

=== Test Results ===
Test Results:
  acc@1: 30.40%
  acc@5: 53.52%
  acc@10: 57.55%
  mrr: 40.72%
  ndcg: 44.47%
  f1: 18.80%

=== Training Complete ===
