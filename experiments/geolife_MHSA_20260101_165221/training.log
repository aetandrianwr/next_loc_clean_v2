Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/scripts/sci_hyperparam_tuning/configs/mhsa_geolife_trial04.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=58, val=27, test=28
Total trainable parameters: 202147

=== Epoch 1 ===
Epoch 1, 34.5%	 loss: 7.106 acc@1: 0.20 mrr: 0.89, ndcg: 0.70, took: 2.13s
Epoch 1, 69.0%	 loss: 7.006 acc@1: 1.52 mrr: 3.44, ndcg: 3.69, took: 0.99s
Validation - loss: 6.0821, acc@1: 16.29%, f1: 9.62%, mrr: 27.30%, ndcg: 31.09%
Current learning rate: 0.002000

=== Epoch 2 ===
Epoch 2, 34.5%	 loss: 5.811 acc@1: 19.92 mrr: 30.52, ndcg: 34.33, took: 1.03s
Epoch 2, 69.0%	 loss: 5.018 acc@1: 22.70 mrr: 34.01, ndcg: 38.55, took: 1.01s
Validation - loss: 4.6218, acc@1: 25.73%, f1: 17.54%, mrr: 36.97%, ndcg: 42.01%
Current learning rate: 0.001959

=== Epoch 3 ===
Epoch 3, 34.5%	 loss: 4.100 acc@1: 28.28 mrr: 40.41, ndcg: 45.16, took: 0.97s
Epoch 3, 69.0%	 loss: 4.054 acc@1: 29.88 mrr: 41.64, ndcg: 46.05, took: 1.03s
Validation - loss: 4.4907, acc@1: 30.71%, f1: 20.77%, mrr: 42.77%, ndcg: 47.23%
Current learning rate: 0.001918

=== Epoch 4 ===
Epoch 4, 34.5%	 loss: 3.643 acc@1: 32.93 mrr: 45.72, ndcg: 50.13, took: 0.88s
Epoch 4, 69.0%	 loss: 3.487 acc@1: 37.03 mrr: 49.33, ndcg: 53.45, took: 0.90s
Validation - loss: 4.3037, acc@1: 38.00%, f1: 27.83%, mrr: 48.12%, ndcg: 51.80%
Current learning rate: 0.001878

=== Epoch 5 ===
Epoch 5, 34.5%	 loss: 3.175 acc@1: 40.47 mrr: 52.76, ndcg: 56.66, took: 1.03s
Epoch 5, 69.0%	 loss: 3.063 acc@1: 41.21 mrr: 53.88, ndcg: 57.90, took: 0.96s
Validation - loss: 4.2993, acc@1: 37.40%, f1: 27.31%, mrr: 48.44%, ndcg: 52.30%
Current learning rate: 0.001837

=== Epoch 6 ===
Epoch 6, 34.5%	 loss: 2.983 acc@1: 40.82 mrr: 53.56, ndcg: 57.84, took: 1.01s
Epoch 6, 69.0%	 loss: 2.897 acc@1: 42.27 mrr: 55.14, ndcg: 59.38, took: 0.98s
Validation - loss: 4.3060, acc@1: 40.67%, f1: 30.28%, mrr: 50.40%, ndcg: 53.87%
Current learning rate: 0.001796

=== Epoch 7 ===
Epoch 7, 34.5%	 loss: 2.698 acc@1: 46.33 mrr: 58.14, ndcg: 62.22, took: 0.97s
Epoch 7, 69.0%	 loss: 2.680 acc@1: 46.33 mrr: 58.35, ndcg: 62.66, took: 0.97s
Validation - loss: 4.3223, acc@1: 40.91%, f1: 31.71%, mrr: 50.71%, ndcg: 54.18%
Current learning rate: 0.001755

=== Epoch 8 ===
Epoch 8, 34.5%	 loss: 2.510 acc@1: 48.63 mrr: 60.47, ndcg: 64.91, took: 1.00s
Epoch 8, 69.0%	 loss: 2.498 acc@1: 48.05 mrr: 60.26, ndcg: 64.73, took: 1.04s
Validation - loss: 4.3547, acc@1: 40.70%, f1: 32.24%, mrr: 50.44%, ndcg: 53.89%
Current learning rate: 0.001714

=== Epoch 9 ===
Epoch 9, 34.5%	 loss: 2.308 acc@1: 51.13 mrr: 63.14, ndcg: 67.63, took: 1.09s
Epoch 9, 69.0%	 loss: 2.308 acc@1: 50.86 mrr: 62.96, ndcg: 67.52, took: 1.01s
Validation - loss: 4.3963, acc@1: 41.45%, f1: 33.17%, mrr: 51.02%, ndcg: 54.55%
Current learning rate: 0.001673

=== Epoch 10 ===
Epoch 10, 34.5%	 loss: 2.095 acc@1: 54.34 mrr: 66.20, ndcg: 70.82, took: 1.04s
Epoch 10, 69.0%	 loss: 2.165 acc@1: 51.88 mrr: 64.26, ndcg: 68.90, took: 0.99s
Validation - loss: 4.3655, acc@1: 41.45%, f1: 33.39%, mrr: 51.06%, ndcg: 54.61%
Current learning rate: 0.000163

=== Epoch 11 ===
Epoch 11, 34.5%	 loss: 2.907 acc@1: 42.07 mrr: 54.66, ndcg: 58.84, took: 1.14s
Epoch 11, 69.0%	 loss: 2.906 acc@1: 42.85 mrr: 55.43, ndcg: 59.51, took: 1.05s
Validation - loss: 4.2554, acc@1: 40.13%, f1: 30.05%, mrr: 49.94%, ndcg: 53.44%
Current learning rate: 0.000163

=== Epoch 12 ===
Epoch 12, 34.5%	 loss: 2.878 acc@1: 43.98 mrr: 55.86, ndcg: 59.64, took: 1.08s
Epoch 12, 69.0%	 loss: 2.908 acc@1: 42.97 mrr: 55.21, ndcg: 59.26, took: 1.05s
Validation - loss: 4.2575, acc@1: 40.28%, f1: 30.30%, mrr: 50.06%, ndcg: 53.57%
Current learning rate: 0.000163

=== Epoch 13 ===
Epoch 13, 34.5%	 loss: 2.883 acc@1: 43.24 mrr: 55.38, ndcg: 59.24, took: 1.00s
Epoch 13, 69.0%	 loss: 2.813 acc@1: 44.96 mrr: 57.02, ndcg: 61.11, took: 1.01s
Validation - loss: 4.2462, acc@1: 40.58%, f1: 30.44%, mrr: 50.22%, ndcg: 53.69%
Current learning rate: 0.000163

=== Epoch 14 ===
Epoch 14, 34.5%	 loss: 2.796 acc@1: 44.84 mrr: 56.99, ndcg: 60.92, took: 0.96s
Epoch 14, 69.0%	 loss: 2.872 acc@1: 43.16 mrr: 55.50, ndcg: 59.49, took: 0.99s
Validation - loss: 4.2706, acc@1: 40.16%, f1: 30.34%, mrr: 50.00%, ndcg: 53.50%
Current learning rate: 0.000163

=== Epoch 15 ===
Epoch 15, 34.5%	 loss: 2.785 acc@1: 45.16 mrr: 57.12, ndcg: 61.11, took: 0.89s
Epoch 15, 69.0%	 loss: 2.750 acc@1: 45.82 mrr: 57.75, ndcg: 61.60, took: 0.86s
Validation - loss: 4.2511, acc@1: 40.61%, f1: 30.68%, mrr: 50.25%, ndcg: 53.69%
Current learning rate: 0.000163

=== Epoch 16 ===
Epoch 16, 34.5%	 loss: 2.802 acc@1: 44.53 mrr: 56.54, ndcg: 60.60, took: 0.98s
Epoch 16, 69.0%	 loss: 2.725 acc@1: 45.82 mrr: 57.85, ndcg: 61.76, took: 1.02s
Validation - loss: 4.2518, acc@1: 40.52%, f1: 30.75%, mrr: 50.25%, ndcg: 53.70%
Current learning rate: 0.000163

=== Epoch 17 ===
Epoch 17, 34.5%	 loss: 2.764 acc@1: 45.74 mrr: 57.52, ndcg: 61.42, took: 0.96s
Epoch 17, 69.0%	 loss: 2.765 acc@1: 45.62 mrr: 57.20, ndcg: 61.08, took: 0.93s
Validation - loss: 4.2683, acc@1: 40.73%, f1: 31.02%, mrr: 50.29%, ndcg: 53.74%
Current learning rate: 0.000163

=== Epoch 18 ===
Epoch 18, 34.5%	 loss: 2.695 acc@1: 46.37 mrr: 58.11, ndcg: 62.25, took: 1.01s
Epoch 18, 69.0%	 loss: 2.748 acc@1: 44.69 mrr: 56.87, ndcg: 60.88, took: 0.96s
Validation - loss: 4.2642, acc@1: 41.03%, f1: 31.20%, mrr: 50.43%, ndcg: 53.79%
Current learning rate: 0.000016

=== Epoch 19 ===
Epoch 19, 34.5%	 loss: 2.800 acc@1: 44.02 mrr: 56.26, ndcg: 60.34, took: 0.97s
Epoch 19, 69.0%	 loss: 2.877 acc@1: 44.53 mrr: 55.88, ndcg: 59.62, took: 0.94s
Validation - loss: 4.2552, acc@1: 40.67%, f1: 30.58%, mrr: 50.26%, ndcg: 53.69%
Current learning rate: 0.000016

=== Epoch 20 ===
Epoch 20, 34.5%	 loss: 2.795 acc@1: 44.30 mrr: 56.58, ndcg: 60.69, took: 0.89s
Epoch 20, 69.0%	 loss: 2.811 acc@1: 45.04 mrr: 56.82, ndcg: 60.79, took: 0.89s
Validation - loss: 4.2581, acc@1: 40.46%, f1: 30.40%, mrr: 50.19%, ndcg: 53.63%
Current learning rate: 0.000016

=== Epoch 21 ===
Epoch 21, 34.5%	 loss: 2.794 acc@1: 44.22 mrr: 56.53, ndcg: 60.48, took: 0.87s
Epoch 21, 69.0%	 loss: 2.798 acc@1: 44.96 mrr: 56.85, ndcg: 60.56, took: 0.92s
Validation - loss: 4.2512, acc@1: 40.58%, f1: 30.51%, mrr: 50.23%, ndcg: 53.66%
Current learning rate: 0.000016

=== Epoch 22 ===
Epoch 22, 34.5%	 loss: 2.831 acc@1: 44.45 mrr: 56.43, ndcg: 60.38, took: 0.78s
Epoch 22, 69.0%	 loss: 2.824 acc@1: 44.65 mrr: 56.46, ndcg: 60.38, took: 0.78s
Validation - loss: 4.2557, acc@1: 40.85%, f1: 30.89%, mrr: 50.35%, ndcg: 53.74%
Current learning rate: 0.000016

=== Epoch 23 ===
Epoch 23, 34.5%	 loss: 2.778 acc@1: 45.55 mrr: 57.29, ndcg: 61.23, took: 0.94s
Epoch 23, 69.0%	 loss: 2.821 acc@1: 44.49 mrr: 56.45, ndcg: 60.45, took: 0.88s
Validation - loss: 4.2605, acc@1: 40.70%, f1: 30.64%, mrr: 50.29%, ndcg: 53.73%
Training finished.	 Time: 85.75s.	 acc@1: 40.58%

=== Test Results ===
Test Results:
  acc@1: 30.30%
  acc@5: 55.17%
  acc@10: 60.88%
  mrr: 41.12%
  ndcg: 45.68%
  f1: 20.86%

=== Training Complete ===
