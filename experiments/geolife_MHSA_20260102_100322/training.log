Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/scripts/sci_hyperparam_tuning/configs/temp_final_mhsa_geolife_run2.yaml
Device: cuda
Seed: 456
==================================================
Data loaders: train=232, val=105, test=110
Total trainable parameters: 281251

=== Epoch 1 ===
Epoch 1, 8.6%	 loss: 7.137 acc@1: 0.16 mrr: 0.77, ndcg: 0.47, took: 1.00s
Epoch 1, 17.2%	 loss: 7.141 acc@1: 0.16 mrr: 0.57, ndcg: 0.36, took: 0.56s
Epoch 1, 25.9%	 loss: 7.112 acc@1: 0.00 mrr: 0.54, ndcg: 0.25, took: 0.37s
Epoch 1, 34.5%	 loss: 7.102 acc@1: 0.16 mrr: 0.94, ndcg: 0.79, took: 0.37s
Epoch 1, 43.1%	 loss: 7.083 acc@1: 0.00 mrr: 0.79, ndcg: 0.44, took: 0.37s
Epoch 1, 51.7%	 loss: 7.052 acc@1: 0.31 mrr: 1.38, ndcg: 1.16, took: 0.42s
Epoch 1, 60.3%	 loss: 7.018 acc@1: 0.94 mrr: 2.00, ndcg: 1.77, took: 0.37s
Epoch 1, 69.0%	 loss: 6.998 acc@1: 1.09 mrr: 2.91, ndcg: 2.85, took: 0.37s
Epoch 1, 77.6%	 loss: 6.921 acc@1: 3.91 mrr: 6.92, ndcg: 7.77, took: 0.39s
Epoch 1, 86.2%	 loss: 6.854 acc@1: 8.28 mrr: 11.97, ndcg: 12.87, took: 0.37s
Epoch 1, 94.8%	 loss: 6.666 acc@1: 16.56 mrr: 21.18, ndcg: 22.52, took: 0.37s
Validation - loss: 6.3836, acc@1: 18.03%, f1: 9.08%, mrr: 24.80%, ndcg: 26.74%
Current learning rate: 0.000500

=== Epoch 2 ===
Epoch 2, 8.6%	 loss: 6.363 acc@1: 19.38 mrr: 25.69, ndcg: 27.76, took: 0.37s
Epoch 2, 17.2%	 loss: 6.078 acc@1: 20.31 mrr: 27.98, ndcg: 30.36, took: 0.38s
Epoch 2, 25.9%	 loss: 5.833 acc@1: 23.59 mrr: 30.53, ndcg: 33.11, took: 0.38s
Epoch 2, 34.5%	 loss: 5.656 acc@1: 20.78 mrr: 30.28, ndcg: 34.05, took: 0.37s
Epoch 2, 43.1%	 loss: 5.473 acc@1: 20.62 mrr: 30.50, ndcg: 34.17, took: 0.38s
Epoch 2, 51.7%	 loss: 5.282 acc@1: 21.25 mrr: 32.02, ndcg: 36.07, took: 0.37s
Epoch 2, 60.3%	 loss: 5.080 acc@1: 22.81 mrr: 34.19, ndcg: 39.05, took: 0.38s
Epoch 2, 69.0%	 loss: 4.846 acc@1: 24.38 mrr: 36.41, ndcg: 41.70, took: 0.37s
Epoch 2, 77.6%	 loss: 4.895 acc@1: 23.44 mrr: 34.35, ndcg: 38.86, took: 0.47s
Epoch 2, 86.2%	 loss: 4.700 acc@1: 22.97 mrr: 35.74, ndcg: 41.12, took: 0.43s
Epoch 2, 94.8%	 loss: 4.525 acc@1: 26.41 mrr: 38.56, ndcg: 43.68, took: 0.43s
Validation - loss: 4.6559, acc@1: 25.52%, f1: 16.15%, mrr: 37.65%, ndcg: 42.19%
Current learning rate: 0.001000

=== Epoch 3 ===
Epoch 3, 8.6%	 loss: 4.155 acc@1: 29.53 mrr: 41.88, ndcg: 46.33, took: 0.44s
Epoch 3, 17.2%	 loss: 4.373 acc@1: 26.72 mrr: 38.21, ndcg: 42.65, took: 0.40s
Epoch 3, 25.9%	 loss: 4.066 acc@1: 31.41 mrr: 43.33, ndcg: 47.96, took: 0.40s
Epoch 3, 34.5%	 loss: 4.009 acc@1: 30.00 mrr: 42.02, ndcg: 46.72, took: 0.44s
Epoch 3, 43.1%	 loss: 3.862 acc@1: 31.41 mrr: 44.37, ndcg: 49.12, took: 0.41s
Epoch 3, 51.7%	 loss: 3.934 acc@1: 30.16 mrr: 43.15, ndcg: 47.67, took: 0.43s
Epoch 3, 60.3%	 loss: 3.948 acc@1: 32.50 mrr: 44.71, ndcg: 48.79, took: 0.44s
Epoch 3, 69.0%	 loss: 3.792 acc@1: 34.38 mrr: 46.66, ndcg: 50.98, took: 0.45s
Epoch 3, 77.6%	 loss: 3.606 acc@1: 33.91 mrr: 46.77, ndcg: 51.75, took: 0.42s
Epoch 3, 86.2%	 loss: 3.679 acc@1: 34.69 mrr: 46.97, ndcg: 51.39, took: 0.43s
Epoch 3, 94.8%	 loss: 3.659 acc@1: 33.91 mrr: 47.21, ndcg: 52.09, took: 0.45s
Validation - loss: 4.3430, acc@1: 34.49%, f1: 20.87%, mrr: 45.57%, ndcg: 49.32%
Current learning rate: 0.000979

=== Epoch 4 ===
Epoch 4, 8.6%	 loss: 3.421 acc@1: 37.66 mrr: 50.38, ndcg: 54.69, took: 0.42s
Epoch 4, 17.2%	 loss: 3.460 acc@1: 36.88 mrr: 49.15, ndcg: 53.28, took: 0.40s
Epoch 4, 25.9%	 loss: 3.524 acc@1: 35.00 mrr: 47.77, ndcg: 52.25, took: 0.43s
Epoch 4, 34.5%	 loss: 3.388 acc@1: 39.69 mrr: 51.34, ndcg: 55.25, took: 0.42s
Epoch 4, 43.1%	 loss: 3.493 acc@1: 35.31 mrr: 47.61, ndcg: 52.09, took: 0.40s
Epoch 4, 51.7%	 loss: 3.396 acc@1: 37.66 mrr: 50.05, ndcg: 54.45, took: 0.42s
Epoch 4, 60.3%	 loss: 3.548 acc@1: 38.44 mrr: 49.37, ndcg: 53.00, took: 0.40s
Epoch 4, 69.0%	 loss: 3.239 acc@1: 40.00 mrr: 52.70, ndcg: 57.07, took: 0.42s
Epoch 4, 77.6%	 loss: 3.328 acc@1: 39.06 mrr: 51.63, ndcg: 55.98, took: 0.41s
Epoch 4, 86.2%	 loss: 3.367 acc@1: 37.03 mrr: 49.91, ndcg: 54.17, took: 0.42s
Epoch 4, 94.8%	 loss: 3.443 acc@1: 36.56 mrr: 49.22, ndcg: 53.73, took: 0.42s
Validation - loss: 4.3297, acc@1: 37.76%, f1: 27.04%, mrr: 47.73%, ndcg: 51.32%
Current learning rate: 0.000958

=== Epoch 5 ===
Epoch 5, 8.6%	 loss: 3.229 acc@1: 39.38 mrr: 51.33, ndcg: 55.43, took: 0.41s
Epoch 5, 17.2%	 loss: 3.147 acc@1: 40.31 mrr: 52.41, ndcg: 56.61, took: 0.40s
Epoch 5, 25.9%	 loss: 3.112 acc@1: 38.59 mrr: 51.85, ndcg: 56.25, took: 0.43s
Epoch 5, 34.5%	 loss: 3.029 acc@1: 38.75 mrr: 52.69, ndcg: 57.18, took: 0.41s
Epoch 5, 43.1%	 loss: 3.095 acc@1: 41.88 mrr: 54.01, ndcg: 58.50, took: 0.40s
Epoch 5, 51.7%	 loss: 2.962 acc@1: 40.47 mrr: 53.90, ndcg: 58.54, took: 0.41s
Epoch 5, 60.3%	 loss: 3.312 acc@1: 39.84 mrr: 51.06, ndcg: 55.04, took: 0.41s
Epoch 5, 69.0%	 loss: 3.148 acc@1: 42.03 mrr: 53.58, ndcg: 57.24, took: 0.42s
Epoch 5, 77.6%	 loss: 3.188 acc@1: 39.69 mrr: 52.10, ndcg: 56.25, took: 0.41s
Epoch 5, 86.2%	 loss: 3.040 acc@1: 44.38 mrr: 55.84, ndcg: 60.05, took: 0.43s
Epoch 5, 94.8%	 loss: 3.031 acc@1: 43.12 mrr: 55.11, ndcg: 59.20, took: 0.42s
Validation - loss: 4.2362, acc@1: 41.03%, f1: 30.81%, mrr: 50.36%, ndcg: 53.62%
Current learning rate: 0.000937

=== Epoch 6 ===
Epoch 6, 8.6%	 loss: 2.862 acc@1: 43.12 mrr: 55.77, ndcg: 60.03, took: 0.41s
Epoch 6, 17.2%	 loss: 2.841 acc@1: 45.16 mrr: 56.83, ndcg: 60.71, took: 0.41s
Epoch 6, 25.9%	 loss: 2.955 acc@1: 43.75 mrr: 55.18, ndcg: 59.26, took: 0.43s
Epoch 6, 34.5%	 loss: 2.755 acc@1: 45.62 mrr: 57.92, ndcg: 61.95, took: 0.40s
Epoch 6, 43.1%	 loss: 2.882 acc@1: 43.44 mrr: 55.63, ndcg: 59.90, took: 0.41s
Epoch 6, 51.7%	 loss: 2.905 acc@1: 44.38 mrr: 55.70, ndcg: 59.39, took: 0.42s
Epoch 6, 60.3%	 loss: 2.789 acc@1: 45.31 mrr: 57.55, ndcg: 61.72, took: 0.41s
Epoch 6, 69.0%	 loss: 2.926 acc@1: 41.88 mrr: 54.65, ndcg: 59.34, took: 0.41s
Epoch 6, 77.6%	 loss: 2.924 acc@1: 43.12 mrr: 54.93, ndcg: 58.92, took: 0.41s
Epoch 6, 86.2%	 loss: 2.690 acc@1: 47.66 mrr: 59.23, ndcg: 63.17, took: 0.40s
Epoch 6, 94.8%	 loss: 2.781 acc@1: 43.12 mrr: 56.37, ndcg: 61.06, took: 0.42s
Validation - loss: 4.2441, acc@1: 40.04%, f1: 30.48%, mrr: 49.87%, ndcg: 53.36%
Current learning rate: 0.000917

=== Epoch 7 ===
Epoch 7, 8.6%	 loss: 2.558 acc@1: 47.50 mrr: 60.06, ndcg: 64.35, took: 0.41s
Epoch 7, 17.2%	 loss: 2.414 acc@1: 51.25 mrr: 62.36, ndcg: 66.70, took: 0.40s
Epoch 7, 25.9%	 loss: 2.671 acc@1: 46.09 mrr: 57.89, ndcg: 62.01, took: 0.41s
Epoch 7, 34.5%	 loss: 2.562 acc@1: 46.56 mrr: 59.04, ndcg: 63.45, took: 0.42s
Epoch 7, 43.1%	 loss: 2.593 acc@1: 48.44 mrr: 60.46, ndcg: 64.37, took: 0.40s
Epoch 7, 51.7%	 loss: 2.661 acc@1: 46.88 mrr: 58.16, ndcg: 61.95, took: 0.41s
Epoch 7, 60.3%	 loss: 2.681 acc@1: 45.78 mrr: 58.03, ndcg: 62.18, took: 0.42s
Epoch 7, 69.0%	 loss: 2.749 acc@1: 44.22 mrr: 56.87, ndcg: 61.28, took: 0.41s
Epoch 7, 77.6%	 loss: 2.664 acc@1: 47.97 mrr: 59.31, ndcg: 63.14, took: 0.42s
Epoch 7, 86.2%	 loss: 2.573 acc@1: 49.06 mrr: 60.59, ndcg: 64.91, took: 0.40s
Epoch 7, 94.8%	 loss: 2.592 acc@1: 45.94 mrr: 59.17, ndcg: 63.84, took: 0.39s
Validation - loss: 4.2253, acc@1: 42.26%, f1: 33.33%, mrr: 51.26%, ndcg: 54.73%
Current learning rate: 0.000896

=== Epoch 8 ===
Epoch 8, 8.6%	 loss: 2.416 acc@1: 50.16 mrr: 62.10, ndcg: 66.30, took: 0.41s
Epoch 8, 17.2%	 loss: 2.364 acc@1: 49.22 mrr: 61.72, ndcg: 66.35, took: 0.40s
Epoch 8, 25.9%	 loss: 2.403 acc@1: 50.94 mrr: 62.65, ndcg: 67.18, took: 0.41s
Epoch 8, 34.5%	 loss: 2.318 acc@1: 51.88 mrr: 63.31, ndcg: 67.05, took: 0.40s
Epoch 8, 43.1%	 loss: 2.427 acc@1: 47.50 mrr: 60.54, ndcg: 65.83, took: 0.39s
Epoch 8, 51.7%	 loss: 2.409 acc@1: 49.69 mrr: 61.20, ndcg: 65.39, took: 0.42s
Epoch 8, 60.3%	 loss: 2.357 acc@1: 51.72 mrr: 62.94, ndcg: 66.80, took: 0.41s
Epoch 8, 69.0%	 loss: 2.616 acc@1: 48.12 mrr: 59.31, ndcg: 63.53, took: 0.39s
Epoch 8, 77.6%	 loss: 2.410 acc@1: 48.28 mrr: 61.12, ndcg: 65.71, took: 0.41s
Epoch 8, 86.2%	 loss: 2.468 acc@1: 48.59 mrr: 60.66, ndcg: 65.08, took: 0.41s
Epoch 8, 94.8%	 loss: 2.430 acc@1: 47.50 mrr: 60.62, ndcg: 65.31, took: 0.40s
Validation - loss: 4.2256, acc@1: 41.48%, f1: 33.23%, mrr: 50.90%, ndcg: 54.44%
Current learning rate: 0.000875

=== Epoch 9 ===
Epoch 9, 8.6%	 loss: 2.114 acc@1: 53.91 mrr: 65.95, ndcg: 70.32, took: 0.40s
Epoch 9, 17.2%	 loss: 2.125 acc@1: 54.69 mrr: 66.43, ndcg: 70.95, took: 0.41s
Epoch 9, 25.9%	 loss: 2.322 acc@1: 52.66 mrr: 63.87, ndcg: 68.53, took: 0.41s
Epoch 9, 34.5%	 loss: 2.247 acc@1: 52.50 mrr: 64.57, ndcg: 69.08, took: 0.40s
Epoch 9, 43.1%	 loss: 2.204 acc@1: 52.03 mrr: 64.61, ndcg: 69.03, took: 0.42s
Epoch 9, 51.7%	 loss: 2.138 acc@1: 54.53 mrr: 66.38, ndcg: 70.94, took: 0.40s
Epoch 9, 60.3%	 loss: 2.205 acc@1: 52.81 mrr: 64.67, ndcg: 69.14, took: 0.42s
Epoch 9, 69.0%	 loss: 2.165 acc@1: 53.91 mrr: 65.20, ndcg: 69.22, took: 0.43s
Epoch 9, 77.6%	 loss: 2.182 acc@1: 54.53 mrr: 65.57, ndcg: 69.74, took: 0.40s
Epoch 9, 86.2%	 loss: 2.283 acc@1: 49.53 mrr: 61.81, ndcg: 66.36, took: 0.43s
Epoch 9, 94.8%	 loss: 2.296 acc@1: 51.25 mrr: 62.72, ndcg: 67.08, took: 0.44s
Validation - loss: 4.2353, acc@1: 41.69%, f1: 33.47%, mrr: 51.09%, ndcg: 54.45%
Current learning rate: 0.000854

=== Epoch 10 ===
Epoch 10, 8.6%	 loss: 1.907 acc@1: 56.41 mrr: 68.42, ndcg: 73.15, took: 0.40s
Epoch 10, 17.2%	 loss: 2.066 acc@1: 55.16 mrr: 66.32, ndcg: 70.76, took: 0.41s
Epoch 10, 25.9%	 loss: 1.948 acc@1: 57.19 mrr: 68.83, ndcg: 73.59, took: 0.45s
Epoch 10, 34.5%	 loss: 2.004 acc@1: 53.12 mrr: 65.91, ndcg: 70.97, took: 0.41s
Epoch 10, 43.1%	 loss: 1.965 acc@1: 56.88 mrr: 67.90, ndcg: 72.42, took: 0.40s
Epoch 10, 51.7%	 loss: 1.928 acc@1: 56.25 mrr: 68.59, ndcg: 73.36, took: 0.40s
Epoch 10, 60.3%	 loss: 2.034 acc@1: 56.09 mrr: 67.48, ndcg: 71.81, took: 0.44s
Epoch 10, 69.0%	 loss: 2.120 acc@1: 55.00 mrr: 65.89, ndcg: 70.15, took: 0.40s
Epoch 10, 77.6%	 loss: 2.038 acc@1: 53.91 mrr: 66.53, ndcg: 71.13, took: 0.38s
Epoch 10, 86.2%	 loss: 2.022 acc@1: 56.72 mrr: 67.78, ndcg: 71.74, took: 0.44s
Epoch 10, 94.8%	 loss: 2.097 acc@1: 54.38 mrr: 66.09, ndcg: 70.79, took: 0.41s
Validation - loss: 4.1993, acc@1: 41.72%, f1: 33.87%, mrr: 50.99%, ndcg: 54.35%
Current learning rate: 0.000833

=== Epoch 11 ===
Epoch 11, 8.6%	 loss: 1.795 acc@1: 58.28 mrr: 70.23, ndcg: 75.41, took: 0.42s
Epoch 11, 17.2%	 loss: 1.798 acc@1: 57.81 mrr: 69.62, ndcg: 74.04, took: 0.43s
Epoch 11, 25.9%	 loss: 1.783 acc@1: 57.19 mrr: 69.74, ndcg: 74.78, took: 0.41s
Epoch 11, 34.5%	 loss: 1.873 acc@1: 57.66 mrr: 69.15, ndcg: 73.88, took: 0.41s
Epoch 11, 43.1%	 loss: 1.912 acc@1: 56.09 mrr: 67.77, ndcg: 72.76, took: 0.41s
Epoch 11, 51.7%	 loss: 1.727 acc@1: 61.41 mrr: 72.00, ndcg: 75.85, took: 0.43s
Epoch 11, 60.3%	 loss: 1.879 acc@1: 57.81 mrr: 69.35, ndcg: 73.98, took: 0.42s
Epoch 11, 69.0%	 loss: 1.763 acc@1: 60.78 mrr: 71.79, ndcg: 76.05, took: 0.41s
Epoch 11, 77.6%	 loss: 1.869 acc@1: 57.66 mrr: 69.43, ndcg: 74.49, took: 0.44s
Epoch 11, 86.2%	 loss: 1.829 acc@1: 61.41 mrr: 71.42, ndcg: 75.06, took: 0.41s
Epoch 11, 94.8%	 loss: 1.838 acc@1: 57.66 mrr: 69.21, ndcg: 74.15, took: 0.39s
Validation - loss: 4.2582, acc@1: 41.96%, f1: 34.46%, mrr: 51.01%, ndcg: 54.37%
Current learning rate: 0.000813

=== Epoch 12 ===
Epoch 12, 8.6%	 loss: 1.537 acc@1: 64.06 mrr: 75.31, ndcg: 79.96, took: 0.42s
Epoch 12, 17.2%	 loss: 1.569 acc@1: 63.12 mrr: 74.64, ndcg: 78.98, took: 0.42s
Epoch 12, 25.9%	 loss: 1.642 acc@1: 60.16 mrr: 72.54, ndcg: 77.54, took: 0.40s
Epoch 12, 34.5%	 loss: 1.793 acc@1: 59.06 mrr: 70.58, ndcg: 75.22, took: 0.40s
Epoch 12, 43.1%	 loss: 1.560 acc@1: 63.12 mrr: 73.90, ndcg: 78.26, took: 0.42s
Epoch 12, 51.7%	 loss: 1.678 acc@1: 59.69 mrr: 71.90, ndcg: 76.73, took: 0.41s
Epoch 12, 60.3%	 loss: 1.701 acc@1: 61.56 mrr: 72.80, ndcg: 77.51, took: 0.40s
Epoch 12, 69.0%	 loss: 1.714 acc@1: 60.31 mrr: 71.61, ndcg: 76.63, took: 0.44s
Epoch 12, 77.6%	 loss: 1.752 acc@1: 58.59 mrr: 71.19, ndcg: 76.39, took: 0.40s
Epoch 12, 86.2%	 loss: 1.799 acc@1: 56.09 mrr: 68.73, ndcg: 74.14, took: 0.44s
Epoch 12, 94.8%	 loss: 1.740 acc@1: 59.84 mrr: 71.27, ndcg: 76.10, took: 0.42s
Validation - loss: 4.2571, acc@1: 41.15%, f1: 34.34%, mrr: 50.51%, ndcg: 53.87%
Current learning rate: 0.000792

=== Epoch 13 ===
Epoch 13, 8.6%	 loss: 1.557 acc@1: 61.72 mrr: 73.76, ndcg: 78.85, took: 0.41s
Epoch 13, 17.2%	 loss: 1.487 acc@1: 66.25 mrr: 76.28, ndcg: 80.44, took: 0.41s
Epoch 13, 25.9%	 loss: 1.461 acc@1: 66.09 mrr: 76.72, ndcg: 80.97, took: 0.42s
Epoch 13, 34.5%	 loss: 1.434 acc@1: 65.62 mrr: 76.36, ndcg: 80.77, took: 0.41s
Epoch 13, 43.1%	 loss: 1.530 acc@1: 62.34 mrr: 73.81, ndcg: 78.41, took: 0.39s
Epoch 13, 51.7%	 loss: 1.507 acc@1: 63.75 mrr: 74.66, ndcg: 79.20, took: 0.40s
Epoch 13, 60.3%	 loss: 1.503 acc@1: 65.62 mrr: 75.59, ndcg: 79.78, took: 0.41s
Epoch 13, 69.0%	 loss: 1.535 acc@1: 61.56 mrr: 73.13, ndcg: 78.00, took: 0.40s
Epoch 13, 77.6%	 loss: 1.596 acc@1: 62.34 mrr: 73.44, ndcg: 78.30, took: 0.42s
Epoch 13, 86.2%	 loss: 1.586 acc@1: 60.62 mrr: 73.06, ndcg: 77.89, took: 0.38s
Epoch 13, 94.8%	 loss: 1.551 acc@1: 60.16 mrr: 72.54, ndcg: 77.57, took: 0.40s
Validation - loss: 4.3383, acc@1: 41.00%, f1: 34.32%, mrr: 50.37%, ndcg: 53.72%
Current learning rate: 0.000771

=== Epoch 14 ===
Epoch 14, 8.6%	 loss: 1.236 acc@1: 70.31 mrr: 80.30, ndcg: 84.34, took: 0.43s
Epoch 14, 17.2%	 loss: 1.337 acc@1: 65.94 mrr: 77.50, ndcg: 81.96, took: 0.41s
Epoch 14, 25.9%	 loss: 1.266 acc@1: 68.59 mrr: 79.16, ndcg: 83.54, took: 0.40s
Epoch 14, 34.5%	 loss: 1.349 acc@1: 67.03 mrr: 77.67, ndcg: 82.05, took: 0.45s
Epoch 14, 43.1%	 loss: 1.360 acc@1: 67.50 mrr: 78.07, ndcg: 82.52, took: 0.42s
Epoch 14, 51.7%	 loss: 1.495 acc@1: 64.38 mrr: 75.36, ndcg: 79.64, took: 0.40s
Epoch 14, 60.3%	 loss: 1.450 acc@1: 64.69 mrr: 75.51, ndcg: 80.18, took: 0.40s
Epoch 14, 69.0%	 loss: 1.405 acc@1: 65.00 mrr: 76.20, ndcg: 80.81, took: 0.44s
Epoch 14, 77.6%	 loss: 1.443 acc@1: 64.22 mrr: 75.85, ndcg: 80.39, took: 0.40s
Epoch 14, 86.2%	 loss: 1.495 acc@1: 62.81 mrr: 74.42, ndcg: 79.28, took: 0.41s
Epoch 14, 94.8%	 loss: 1.441 acc@1: 64.84 mrr: 75.21, ndcg: 79.73, took: 0.40s
Validation - loss: 4.3253, acc@1: 41.72%, f1: 35.02%, mrr: 50.58%, ndcg: 53.85%
Current learning rate: 0.000750

=== Epoch 15 ===
Epoch 15, 8.6%	 loss: 1.187 acc@1: 71.09 mrr: 80.83, ndcg: 84.77, took: 0.43s
Epoch 15, 17.2%	 loss: 1.218 acc@1: 69.22 mrr: 79.90, ndcg: 84.32, took: 0.42s
Epoch 15, 25.9%	 loss: 1.206 acc@1: 70.00 mrr: 80.15, ndcg: 84.31, took: 0.40s
Epoch 15, 34.5%	 loss: 1.240 acc@1: 67.97 mrr: 79.14, ndcg: 83.48, took: 0.42s
Epoch 15, 43.1%	 loss: 1.283 acc@1: 68.28 mrr: 79.14, ndcg: 83.51, took: 0.42s
Epoch 15, 51.7%	 loss: 1.297 acc@1: 66.09 mrr: 77.36, ndcg: 82.00, took: 0.40s
Epoch 15, 60.3%	 loss: 1.250 acc@1: 68.44 mrr: 78.83, ndcg: 82.91, took: 0.42s
Epoch 15, 69.0%	 loss: 1.238 acc@1: 69.22 mrr: 79.14, ndcg: 83.40, took: 0.41s
Epoch 15, 77.6%	 loss: 1.326 acc@1: 65.94 mrr: 77.20, ndcg: 81.86, took: 0.40s
Epoch 15, 86.2%	 loss: 1.315 acc@1: 67.66 mrr: 78.22, ndcg: 82.62, took: 0.44s
Epoch 15, 94.8%	 loss: 1.315 acc@1: 67.19 mrr: 77.92, ndcg: 82.26, took: 0.41s
Validation - loss: 4.4065, acc@1: 40.97%, f1: 34.88%, mrr: 49.91%, ndcg: 53.15%
Current learning rate: 0.000073

=== Epoch 16 ===
Epoch 16, 8.6%	 loss: 1.710 acc@1: 60.16 mrr: 71.48, ndcg: 76.15, took: 0.43s
Epoch 16, 17.2%	 loss: 1.706 acc@1: 59.69 mrr: 71.77, ndcg: 76.45, took: 0.41s
Epoch 16, 25.9%	 loss: 1.756 acc@1: 61.72 mrr: 71.76, ndcg: 76.07, took: 0.40s
Epoch 16, 34.5%	 loss: 1.662 acc@1: 62.34 mrr: 73.74, ndcg: 78.24, took: 0.43s
Epoch 16, 43.1%	 loss: 1.770 acc@1: 60.47 mrr: 71.72, ndcg: 75.81, took: 0.41s
Epoch 16, 51.7%	 loss: 1.820 acc@1: 59.69 mrr: 70.71, ndcg: 75.60, took: 0.42s
Epoch 16, 60.3%	 loss: 1.754 acc@1: 60.00 mrr: 71.20, ndcg: 75.85, took: 0.42s
Epoch 16, 69.0%	 loss: 1.839 acc@1: 56.88 mrr: 69.00, ndcg: 74.14, took: 0.41s
Epoch 16, 77.6%	 loss: 1.823 acc@1: 58.91 mrr: 70.32, ndcg: 75.04, took: 0.40s
Epoch 16, 86.2%	 loss: 1.767 acc@1: 60.00 mrr: 71.08, ndcg: 75.76, took: 0.42s
Epoch 16, 94.8%	 loss: 1.698 acc@1: 62.97 mrr: 73.43, ndcg: 78.21, took: 0.42s
Validation - loss: 4.2037, acc@1: 42.35%, f1: 34.37%, mrr: 51.32%, ndcg: 54.61%
Current learning rate: 0.000073

=== Epoch 17 ===
Epoch 17, 8.6%	 loss: 1.704 acc@1: 61.09 mrr: 72.41, ndcg: 76.91, took: 0.42s
Epoch 17, 17.2%	 loss: 1.568 acc@1: 62.50 mrr: 74.27, ndcg: 79.10, took: 0.42s
Epoch 17, 25.9%	 loss: 1.595 acc@1: 62.66 mrr: 74.02, ndcg: 78.61, took: 0.41s
Epoch 17, 34.5%	 loss: 1.801 acc@1: 58.75 mrr: 70.35, ndcg: 74.85, took: 0.41s
Epoch 17, 43.1%	 loss: 1.768 acc@1: 59.22 mrr: 70.74, ndcg: 75.72, took: 0.40s
Epoch 17, 51.7%	 loss: 1.729 acc@1: 61.72 mrr: 72.36, ndcg: 76.59, took: 0.40s
Epoch 17, 60.3%	 loss: 1.759 acc@1: 59.38 mrr: 71.19, ndcg: 76.24, took: 0.40s
Epoch 17, 69.0%	 loss: 1.763 acc@1: 58.12 mrr: 70.27, ndcg: 75.38, took: 0.40s
Epoch 17, 77.6%	 loss: 1.794 acc@1: 60.47 mrr: 71.31, ndcg: 75.86, took: 0.40s
Epoch 17, 86.2%	 loss: 1.709 acc@1: 61.72 mrr: 72.23, ndcg: 76.83, took: 0.42s
Epoch 17, 94.8%	 loss: 1.742 acc@1: 60.31 mrr: 71.13, ndcg: 75.49, took: 0.45s
Validation - loss: 4.1873, acc@1: 42.32%, f1: 34.62%, mrr: 51.25%, ndcg: 54.51%
Current learning rate: 0.000073

=== Epoch 18 ===
Epoch 18, 8.6%	 loss: 1.669 acc@1: 62.19 mrr: 72.96, ndcg: 77.53, took: 0.44s
Epoch 18, 17.2%	 loss: 1.824 acc@1: 57.50 mrr: 69.26, ndcg: 73.88, took: 0.42s
Epoch 18, 25.9%	 loss: 1.704 acc@1: 61.25 mrr: 72.64, ndcg: 77.27, took: 0.41s
Epoch 18, 34.5%	 loss: 1.815 acc@1: 58.12 mrr: 69.93, ndcg: 74.96, took: 0.42s
Epoch 18, 43.1%	 loss: 1.672 acc@1: 62.50 mrr: 72.98, ndcg: 77.36, took: 0.40s
Epoch 18, 51.7%	 loss: 1.648 acc@1: 61.88 mrr: 72.83, ndcg: 76.96, took: 0.40s
Epoch 18, 60.3%	 loss: 1.685 acc@1: 60.62 mrr: 72.23, ndcg: 77.09, took: 0.41s
Epoch 18, 69.0%	 loss: 1.615 acc@1: 64.06 mrr: 74.15, ndcg: 78.53, took: 0.42s
Epoch 18, 77.6%	 loss: 1.642 acc@1: 61.56 mrr: 72.95, ndcg: 77.56, took: 0.40s
Epoch 18, 86.2%	 loss: 1.742 acc@1: 58.28 mrr: 70.67, ndcg: 75.69, took: 0.41s
Epoch 18, 94.8%	 loss: 1.614 acc@1: 63.59 mrr: 74.41, ndcg: 78.67, took: 0.41s
Validation - loss: 4.2059, acc@1: 42.02%, f1: 34.40%, mrr: 51.19%, ndcg: 54.51%
Current learning rate: 0.000073

=== Epoch 19 ===
Epoch 19, 8.6%	 loss: 1.758 acc@1: 60.00 mrr: 71.22, ndcg: 76.03, took: 0.41s
Epoch 19, 17.2%	 loss: 1.590 acc@1: 63.59 mrr: 74.22, ndcg: 78.65, took: 0.38s
Epoch 19, 25.9%	 loss: 1.589 acc@1: 63.91 mrr: 74.13, ndcg: 78.14, took: 0.41s
Epoch 19, 34.5%	 loss: 1.631 acc@1: 63.12 mrr: 73.83, ndcg: 78.18, took: 0.42s
Epoch 19, 43.1%	 loss: 1.693 acc@1: 63.12 mrr: 73.26, ndcg: 77.60, took: 0.38s
Epoch 19, 51.7%	 loss: 1.555 acc@1: 63.28 mrr: 74.37, ndcg: 78.93, took: 0.42s
Epoch 19, 60.3%	 loss: 1.644 acc@1: 62.34 mrr: 73.06, ndcg: 77.82, took: 0.41s
Epoch 19, 69.0%	 loss: 1.807 acc@1: 59.22 mrr: 70.30, ndcg: 74.96, took: 0.41s
Epoch 19, 77.6%	 loss: 1.744 acc@1: 59.22 mrr: 70.89, ndcg: 75.42, took: 0.41s
Epoch 19, 86.2%	 loss: 1.601 acc@1: 62.97 mrr: 73.89, ndcg: 78.55, took: 0.45s
Epoch 19, 94.8%	 loss: 1.662 acc@1: 61.41 mrr: 72.52, ndcg: 77.41, took: 0.42s
Validation - loss: 4.2102, acc@1: 41.84%, f1: 34.45%, mrr: 51.00%, ndcg: 54.39%
Current learning rate: 0.000073

=== Epoch 20 ===
Epoch 20, 8.6%	 loss: 1.632 acc@1: 63.44 mrr: 74.12, ndcg: 78.57, took: 0.42s
Epoch 20, 17.2%	 loss: 1.672 acc@1: 59.69 mrr: 71.86, ndcg: 76.92, took: 0.42s
Epoch 20, 25.9%	 loss: 1.600 acc@1: 63.59 mrr: 74.03, ndcg: 78.65, took: 0.40s
Epoch 20, 34.5%	 loss: 1.615 acc@1: 61.41 mrr: 73.05, ndcg: 78.04, took: 0.41s
Epoch 20, 43.1%	 loss: 1.505 acc@1: 67.34 mrr: 76.74, ndcg: 80.70, took: 0.41s
Epoch 20, 51.7%	 loss: 1.836 acc@1: 59.38 mrr: 70.33, ndcg: 74.83, took: 0.38s
Epoch 20, 60.3%	 loss: 1.678 acc@1: 60.78 mrr: 72.33, ndcg: 77.17, took: 0.45s
Epoch 20, 69.0%	 loss: 1.565 acc@1: 65.00 mrr: 75.01, ndcg: 79.16, took: 0.39s
Epoch 20, 77.6%	 loss: 1.538 acc@1: 65.00 mrr: 75.27, ndcg: 79.49, took: 0.39s
Epoch 20, 86.2%	 loss: 1.637 acc@1: 60.00 mrr: 72.32, ndcg: 77.10, took: 0.40s
Epoch 20, 94.8%	 loss: 1.693 acc@1: 58.75 mrr: 71.02, ndcg: 76.06, took: 0.41s
Validation - loss: 4.2239, acc@1: 42.35%, f1: 34.83%, mrr: 51.21%, ndcg: 54.45%
Current learning rate: 0.000073

=== Epoch 21 ===
Epoch 21, 8.6%	 loss: 1.689 acc@1: 60.31 mrr: 71.98, ndcg: 76.57, took: 0.41s
Epoch 21, 17.2%	 loss: 1.624 acc@1: 60.78 mrr: 72.88, ndcg: 77.63, took: 0.40s
Epoch 21, 25.9%	 loss: 1.609 acc@1: 62.66 mrr: 73.76, ndcg: 78.28, took: 0.39s
Epoch 21, 34.5%	 loss: 1.604 acc@1: 63.12 mrr: 73.70, ndcg: 78.22, took: 0.38s
Epoch 21, 43.1%	 loss: 1.443 acc@1: 66.56 mrr: 76.83, ndcg: 81.25, took: 0.42s
Epoch 21, 51.7%	 loss: 1.581 acc@1: 63.28 mrr: 74.46, ndcg: 79.13, took: 0.41s
Epoch 21, 60.3%	 loss: 1.725 acc@1: 58.28 mrr: 70.64, ndcg: 75.66, took: 0.39s
Epoch 21, 69.0%	 loss: 1.635 acc@1: 60.94 mrr: 72.52, ndcg: 77.42, took: 0.42s
Epoch 21, 77.6%	 loss: 1.625 acc@1: 62.34 mrr: 73.27, ndcg: 77.84, took: 0.45s
Epoch 21, 86.2%	 loss: 1.562 acc@1: 63.59 mrr: 74.34, ndcg: 78.92, took: 0.42s
Epoch 21, 94.8%	 loss: 1.666 acc@1: 62.97 mrr: 73.44, ndcg: 77.49, took: 0.41s
Validation - loss: 4.2182, acc@1: 42.26%, f1: 34.90%, mrr: 51.12%, ndcg: 54.38%
Current learning rate: 0.000073

=== Epoch 22 ===
Epoch 22, 8.6%	 loss: 1.556 acc@1: 64.53 mrr: 75.01, ndcg: 79.21, took: 0.40s
Epoch 22, 17.2%	 loss: 1.545 acc@1: 64.84 mrr: 75.48, ndcg: 79.80, took: 0.41s
Epoch 22, 25.9%	 loss: 1.621 acc@1: 60.94 mrr: 72.94, ndcg: 78.07, took: 0.42s
Epoch 22, 34.5%	 loss: 1.635 acc@1: 62.34 mrr: 73.35, ndcg: 77.89, took: 0.42s
Epoch 22, 43.1%	 loss: 1.698 acc@1: 61.25 mrr: 72.17, ndcg: 76.79, took: 0.41s
Epoch 22, 51.7%	 loss: 1.531 acc@1: 64.22 mrr: 75.34, ndcg: 79.67, took: 0.40s
Epoch 22, 60.3%	 loss: 1.722 acc@1: 60.94 mrr: 72.21, ndcg: 76.87, took: 0.42s
Epoch 22, 69.0%	 loss: 1.625 acc@1: 60.78 mrr: 72.50, ndcg: 77.48, took: 0.42s
Epoch 22, 77.6%	 loss: 1.570 acc@1: 62.19 mrr: 73.52, ndcg: 78.21, took: 0.41s
Epoch 22, 86.2%	 loss: 1.480 acc@1: 65.00 mrr: 75.76, ndcg: 80.00, took: 0.41s
Epoch 22, 94.8%	 loss: 1.608 acc@1: 61.25 mrr: 73.16, ndcg: 77.71, took: 0.41s
Validation - loss: 4.2208, acc@1: 41.81%, f1: 34.54%, mrr: 50.88%, ndcg: 54.20%
Current learning rate: 0.000007

=== Epoch 23 ===
Epoch 23, 8.6%	 loss: 1.611 acc@1: 63.59 mrr: 74.22, ndcg: 78.38, took: 0.41s
Epoch 23, 17.2%	 loss: 1.690 acc@1: 62.34 mrr: 72.79, ndcg: 77.03, took: 0.40s
Epoch 23, 25.9%	 loss: 1.671 acc@1: 62.50 mrr: 73.35, ndcg: 77.95, took: 0.42s
Epoch 23, 34.5%	 loss: 1.618 acc@1: 61.41 mrr: 72.87, ndcg: 77.60, took: 0.42s
Epoch 23, 43.1%	 loss: 1.732 acc@1: 59.69 mrr: 71.50, ndcg: 76.18, took: 0.40s
Epoch 23, 51.7%	 loss: 1.697 acc@1: 60.16 mrr: 72.17, ndcg: 76.78, took: 0.43s
Epoch 23, 60.3%	 loss: 1.615 acc@1: 63.44 mrr: 73.75, ndcg: 78.34, took: 0.42s
Epoch 23, 69.0%	 loss: 1.683 acc@1: 58.44 mrr: 71.04, ndcg: 76.16, took: 0.41s
Epoch 23, 77.6%	 loss: 1.723 acc@1: 61.25 mrr: 71.98, ndcg: 76.41, took: 0.42s
Epoch 23, 86.2%	 loss: 1.680 acc@1: 62.81 mrr: 73.10, ndcg: 77.45, took: 0.39s
Epoch 23, 94.8%	 loss: 1.732 acc@1: 62.34 mrr: 72.44, ndcg: 76.48, took: 0.40s
Validation - loss: 4.2028, acc@1: 42.44%, f1: 34.89%, mrr: 51.29%, ndcg: 54.51%
Current learning rate: 0.000007

=== Epoch 24 ===
Epoch 24, 8.6%	 loss: 1.578 acc@1: 63.91 mrr: 74.64, ndcg: 78.92, took: 0.51s
Epoch 24, 17.2%	 loss: 1.740 acc@1: 59.38 mrr: 70.70, ndcg: 75.50, took: 0.50s
Epoch 24, 25.9%	 loss: 1.687 acc@1: 62.97 mrr: 73.33, ndcg: 77.68, took: 0.52s
Epoch 24, 34.5%	 loss: 1.634 acc@1: 61.09 mrr: 72.90, ndcg: 77.62, took: 0.52s
Epoch 24, 43.1%	 loss: 1.634 acc@1: 60.31 mrr: 72.29, ndcg: 77.02, took: 0.55s
Epoch 24, 51.7%	 loss: 1.665 acc@1: 59.84 mrr: 71.42, ndcg: 76.22, took: 0.56s
Epoch 24, 60.3%	 loss: 1.652 acc@1: 62.34 mrr: 73.40, ndcg: 77.63, took: 0.52s
Epoch 24, 69.0%	 loss: 1.714 acc@1: 63.28 mrr: 72.93, ndcg: 77.01, took: 0.51s
Epoch 24, 77.6%	 loss: 1.803 acc@1: 58.28 mrr: 70.10, ndcg: 75.07, took: 0.53s
Epoch 24, 86.2%	 loss: 1.662 acc@1: 61.09 mrr: 72.79, ndcg: 77.46, took: 0.51s
Epoch 24, 94.8%	 loss: 1.646 acc@1: 61.41 mrr: 72.80, ndcg: 77.23, took: 0.53s
Validation - loss: 4.2083, acc@1: 42.14%, f1: 34.72%, mrr: 51.16%, ndcg: 54.42%
Current learning rate: 0.000007

=== Epoch 25 ===
Epoch 25, 8.6%	 loss: 1.697 acc@1: 59.06 mrr: 71.32, ndcg: 76.40, took: 0.54s
Epoch 25, 17.2%	 loss: 1.655 acc@1: 60.78 mrr: 72.21, ndcg: 76.63, took: 0.54s
Epoch 25, 25.9%	 loss: 1.643 acc@1: 62.50 mrr: 73.28, ndcg: 77.98, took: 0.54s
Epoch 25, 34.5%	 loss: 1.620 acc@1: 63.91 mrr: 74.23, ndcg: 78.40, took: 0.58s
Epoch 25, 43.1%	 loss: 1.738 acc@1: 60.94 mrr: 71.89, ndcg: 76.38, took: 0.53s
Epoch 25, 51.7%	 loss: 1.760 acc@1: 59.84 mrr: 70.96, ndcg: 75.62, took: 0.58s
Epoch 25, 60.3%	 loss: 1.508 acc@1: 63.91 mrr: 74.93, ndcg: 79.65, took: 0.57s
Epoch 25, 69.0%	 loss: 1.594 acc@1: 61.41 mrr: 73.00, ndcg: 77.78, took: 0.52s
Epoch 25, 77.6%	 loss: 1.607 acc@1: 61.88 mrr: 73.58, ndcg: 78.15, took: 0.55s
Epoch 25, 86.2%	 loss: 1.727 acc@1: 61.88 mrr: 72.40, ndcg: 76.81, took: 0.53s
Epoch 25, 94.8%	 loss: 1.784 acc@1: 61.25 mrr: 71.75, ndcg: 76.04, took: 0.56s
Validation - loss: 4.1959, acc@1: 42.02%, f1: 34.16%, mrr: 51.27%, ndcg: 54.64%
Current learning rate: 0.000007

=== Epoch 26 ===
Epoch 26, 8.6%	 loss: 1.664 acc@1: 61.88 mrr: 72.96, ndcg: 77.53, took: 0.53s
Epoch 26, 17.2%	 loss: 1.612 acc@1: 64.06 mrr: 74.49, ndcg: 78.92, took: 0.53s
Epoch 26, 25.9%	 loss: 1.814 acc@1: 58.28 mrr: 70.10, ndcg: 74.97, took: 0.54s
Epoch 26, 34.5%	 loss: 1.606 acc@1: 63.12 mrr: 73.58, ndcg: 77.90, took: 0.52s
Epoch 26, 43.1%	 loss: 1.686 acc@1: 61.09 mrr: 72.77, ndcg: 77.29, took: 0.52s
Epoch 26, 51.7%	 loss: 1.818 acc@1: 57.34 mrr: 69.52, ndcg: 74.37, took: 0.52s
Epoch 26, 60.3%	 loss: 1.633 acc@1: 61.72 mrr: 72.80, ndcg: 77.44, took: 0.51s
Epoch 26, 69.0%	 loss: 1.792 acc@1: 60.00 mrr: 71.14, ndcg: 75.77, took: 0.50s
Epoch 26, 77.6%	 loss: 1.512 acc@1: 62.81 mrr: 74.63, ndcg: 79.40, took: 0.54s
Epoch 26, 86.2%	 loss: 1.651 acc@1: 63.75 mrr: 73.88, ndcg: 77.84, took: 0.54s
Epoch 26, 94.8%	 loss: 1.649 acc@1: 63.44 mrr: 73.64, ndcg: 77.82, took: 0.58s
Validation - loss: 4.2162, acc@1: 42.32%, f1: 34.93%, mrr: 51.21%, ndcg: 54.45%
Current learning rate: 0.000007

=== Epoch 27 ===
Epoch 27, 8.6%	 loss: 1.621 acc@1: 62.81 mrr: 73.85, ndcg: 77.88, took: 0.60s
Epoch 27, 17.2%	 loss: 1.679 acc@1: 61.25 mrr: 72.77, ndcg: 77.21, took: 0.56s
Epoch 27, 25.9%	 loss: 1.784 acc@1: 58.91 mrr: 70.36, ndcg: 75.07, took: 0.56s
Epoch 27, 34.5%	 loss: 1.671 acc@1: 62.66 mrr: 72.72, ndcg: 77.14, took: 0.56s
Epoch 27, 43.1%	 loss: 1.530 acc@1: 64.22 mrr: 75.25, ndcg: 79.86, took: 0.54s
Epoch 27, 51.7%	 loss: 1.622 acc@1: 62.81 mrr: 73.29, ndcg: 77.29, took: 0.52s
Epoch 27, 60.3%	 loss: 1.790 acc@1: 59.69 mrr: 71.01, ndcg: 75.57, took: 0.52s
Epoch 27, 69.0%	 loss: 1.656 acc@1: 63.59 mrr: 73.43, ndcg: 77.82, took: 0.51s
Epoch 27, 77.6%	 loss: 1.694 acc@1: 61.09 mrr: 72.62, ndcg: 77.24, took: 0.54s
Epoch 27, 86.2%	 loss: 1.668 acc@1: 62.50 mrr: 72.98, ndcg: 77.42, took: 0.54s
Epoch 27, 94.8%	 loss: 1.666 acc@1: 61.56 mrr: 72.63, ndcg: 77.02, took: 0.53s
Validation - loss: 4.2092, acc@1: 42.26%, f1: 34.54%, mrr: 51.22%, ndcg: 54.54%
Training finished.	 Time: 159.52s.	 acc@1: 42.32%

=== Test Results ===
Test Results:
  acc@1: 30.53%
  acc@5: 54.11%
  acc@10: 59.14%
  mrr: 40.92%
  ndcg: 45.06%
  f1: 24.15%

=== Training Complete ===
