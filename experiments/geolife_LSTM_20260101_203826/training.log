Training LSTM model
Dataset: geolife
Config: /data/next_loc_clean_v2/scripts/sci_hyperparam_tuning/configs/lstm_geolife_trial04.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=58, val=27, test=28
Total trainable parameters: 1195363

=== Epoch 1 ===
Epoch 1, 34.5%	 loss: 7.212 acc@1: 0.31 mrr: 1.32, ndcg: 1.13, took: 2.10s
Epoch 1, 69.0%	 loss: 6.457 acc@1: 11.48 mrr: 15.34, ndcg: 16.43, took: 1.21s
Validation - loss: 5.2919, acc@1: 21.24%, f1: 12.03%, mrr: 31.35%, ndcg: 35.56%
Current learning rate: 0.000667

=== Epoch 2 ===
Epoch 2, 34.5%	 loss: 4.610 acc@1: 25.47 mrr: 36.04, ndcg: 40.15, took: 1.43s
Epoch 2, 69.0%	 loss: 4.083 acc@1: 29.14 mrr: 41.03, ndcg: 45.64, took: 1.27s
Validation - loss: 4.7241, acc@1: 29.09%, f1: 20.24%, mrr: 40.17%, ndcg: 44.24%
Current learning rate: 0.001333

=== Epoch 3 ===
Epoch 3, 34.5%	 loss: 3.465 acc@1: 34.57 mrr: 47.72, ndcg: 52.31, took: 1.38s
Epoch 3, 69.0%	 loss: 3.539 acc@1: 31.88 mrr: 45.90, ndcg: 50.96, took: 1.38s
Validation - loss: 4.6379, acc@1: 32.36%, f1: 22.45%, mrr: 44.27%, ndcg: 48.47%
Current learning rate: 0.002000

=== Epoch 4 ===
Epoch 4, 34.5%	 loss: 3.156 acc@1: 33.52 mrr: 48.75, ndcg: 53.90, took: 1.35s
Epoch 4, 69.0%	 loss: 3.168 acc@1: 34.10 mrr: 49.02, ndcg: 54.32, took: 1.41s
Validation - loss: 4.6446, acc@1: 32.06%, f1: 19.73%, mrr: 44.73%, ndcg: 48.99%
Current learning rate: 0.001957

=== Epoch 5 ===
Epoch 5, 34.5%	 loss: 2.854 acc@1: 34.69 mrr: 50.83, ndcg: 56.61, took: 1.16s
Epoch 5, 69.0%	 loss: 2.900 acc@1: 36.33 mrr: 51.64, ndcg: 57.02, took: 1.27s
Validation - loss: 4.7029, acc@1: 30.41%, f1: 19.49%, mrr: 43.24%, ndcg: 47.71%
Current learning rate: 0.001915

=== Epoch 6 ===
Epoch 6, 34.5%	 loss: 2.683 acc@1: 35.78 mrr: 52.49, ndcg: 58.30, took: 1.34s
Epoch 6, 69.0%	 loss: 2.760 acc@1: 35.78 mrr: 51.85, ndcg: 57.43, took: 1.23s
Validation - loss: 4.7373, acc@1: 32.69%, f1: 21.65%, mrr: 45.48%, ndcg: 49.65%
Current learning rate: 0.001872

=== Epoch 7 ===
Epoch 7, 34.5%	 loss: 2.478 acc@1: 37.30 mrr: 54.60, ndcg: 61.26, took: 1.33s
Epoch 7, 69.0%	 loss: 2.533 acc@1: 36.52 mrr: 53.63, ndcg: 59.96, took: 1.21s
Validation - loss: 4.8160, acc@1: 31.25%, f1: 22.44%, mrr: 43.80%, ndcg: 48.17%
Current learning rate: 0.001830

=== Epoch 8 ===
Epoch 8, 34.5%	 loss: 2.249 acc@1: 38.98 mrr: 57.18, ndcg: 64.36, took: 1.31s
Epoch 8, 69.0%	 loss: 2.436 acc@1: 36.09 mrr: 54.14, ndcg: 60.99, took: 1.28s
Validation - loss: 4.9083, acc@1: 31.28%, f1: 21.45%, mrr: 44.20%, ndcg: 48.64%
Current learning rate: 0.000179

=== Epoch 9 ===
Epoch 9, 34.5%	 loss: 3.013 acc@1: 36.56 mrr: 51.17, ndcg: 56.25, took: 1.51s
Epoch 9, 69.0%	 loss: 3.104 acc@1: 34.80 mrr: 49.54, ndcg: 54.57, took: 1.30s
Validation - loss: 4.5198, acc@1: 33.41%, f1: 22.21%, mrr: 45.49%, ndcg: 49.70%
Current learning rate: 0.000179

=== Epoch 10 ===
Epoch 10, 34.5%	 loss: 2.970 acc@1: 36.21 mrr: 51.15, ndcg: 56.25, took: 1.37s
Epoch 10, 69.0%	 loss: 2.886 acc@1: 37.50 mrr: 52.40, ndcg: 57.61, took: 1.35s
Validation - loss: 4.5197, acc@1: 33.29%, f1: 22.27%, mrr: 45.47%, ndcg: 49.66%
Current learning rate: 0.000179

=== Epoch 11 ===
Epoch 11, 34.5%	 loss: 2.838 acc@1: 38.48 mrr: 53.05, ndcg: 58.11, took: 1.30s
Epoch 11, 69.0%	 loss: 2.905 acc@1: 37.11 mrr: 51.98, ndcg: 57.13, took: 1.41s
Validation - loss: 4.5410, acc@1: 33.41%, f1: 22.05%, mrr: 45.63%, ndcg: 49.73%
Current learning rate: 0.000179

=== Epoch 12 ===
Epoch 12, 34.5%	 loss: 2.799 acc@1: 37.62 mrr: 52.90, ndcg: 58.22, took: 1.38s
Epoch 12, 69.0%	 loss: 2.771 acc@1: 37.19 mrr: 52.95, ndcg: 58.51, took: 1.19s
Validation - loss: 4.5617, acc@1: 33.44%, f1: 22.37%, mrr: 45.44%, ndcg: 49.59%
Current learning rate: 0.000179

=== Epoch 13 ===
Epoch 13, 34.5%	 loss: 2.729 acc@1: 39.57 mrr: 54.19, ndcg: 59.46, took: 1.21s
Epoch 13, 69.0%	 loss: 2.702 acc@1: 38.83 mrr: 54.01, ndcg: 59.44, took: 1.35s
Validation - loss: 4.5488, acc@1: 33.77%, f1: 22.81%, mrr: 45.78%, ndcg: 49.85%
Current learning rate: 0.000179

=== Epoch 14 ===
Epoch 14, 34.5%	 loss: 2.637 acc@1: 37.81 mrr: 54.19, ndcg: 59.91, took: 1.30s
Epoch 14, 69.0%	 loss: 2.714 acc@1: 37.77 mrr: 53.54, ndcg: 59.04, took: 1.36s
Validation - loss: 4.5769, acc@1: 33.71%, f1: 22.70%, mrr: 45.76%, ndcg: 49.95%
Current learning rate: 0.000018

=== Epoch 15 ===
Epoch 15, 34.5%	 loss: 2.925 acc@1: 36.52 mrr: 51.78, ndcg: 56.90, took: 1.17s
Epoch 15, 69.0%	 loss: 2.934 acc@1: 36.68 mrr: 51.53, ndcg: 56.64, took: 1.27s
Validation - loss: 4.5256, acc@1: 33.83%, f1: 22.50%, mrr: 45.66%, ndcg: 49.78%
Current learning rate: 0.000018

=== Epoch 16 ===
Epoch 16, 34.5%	 loss: 2.953 acc@1: 37.15 mrr: 51.48, ndcg: 56.47, took: 1.33s
Epoch 16, 69.0%	 loss: 2.907 acc@1: 38.05 mrr: 52.49, ndcg: 57.31, took: 1.36s
Validation - loss: 4.5216, acc@1: 33.74%, f1: 22.50%, mrr: 45.61%, ndcg: 49.77%
Current learning rate: 0.000018

=== Epoch 17 ===
Epoch 17, 34.5%	 loss: 2.904 acc@1: 37.30 mrr: 52.04, ndcg: 57.16, took: 1.28s
Epoch 17, 69.0%	 loss: 2.923 acc@1: 37.58 mrr: 52.11, ndcg: 56.96, took: 1.18s
Validation - loss: 4.5234, acc@1: 33.62%, f1: 22.37%, mrr: 45.56%, ndcg: 49.75%
Current learning rate: 0.000018

=== Epoch 18 ===
Epoch 18, 34.5%	 loss: 2.849 acc@1: 37.93 mrr: 52.81, ndcg: 57.91, took: 1.33s
Epoch 18, 69.0%	 loss: 2.899 acc@1: 35.98 mrr: 51.50, ndcg: 56.81, took: 1.34s
Validation - loss: 4.5244, acc@1: 33.80%, f1: 22.52%, mrr: 45.65%, ndcg: 49.78%
Current learning rate: 0.000018

=== Epoch 19 ===
Epoch 19, 34.5%	 loss: 2.849 acc@1: 38.91 mrr: 53.36, ndcg: 58.22, took: 1.25s
Epoch 19, 69.0%	 loss: 2.896 acc@1: 36.95 mrr: 51.90, ndcg: 57.04, took: 1.24s
Validation - loss: 4.5220, acc@1: 33.77%, f1: 22.49%, mrr: 45.67%, ndcg: 49.81%
Training finished.	 Time: 90.14s.	 acc@1: 33.41%

=== Test Results ===
Test Results:
  acc@1: 27.64%
  acc@5: 52.14%
  acc@10: 58.28%
  mrr: 38.90%
  ndcg: 43.29%
  f1: 17.35%

=== Training Complete ===
