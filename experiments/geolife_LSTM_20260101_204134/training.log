Training LSTM model
Dataset: geolife
Config: /data/next_loc_clean_v2/scripts/sci_hyperparam_tuning/configs/lstm_geolife_trial06.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=58, val=27, test=28
Total trainable parameters: 541219

=== Epoch 1 ===
Epoch 1, 34.5%	 loss: 7.264 acc@1: 0.04 mrr: 0.62, ndcg: 0.36, took: 2.11s
Epoch 1, 69.0%	 loss: 6.748 acc@1: 6.37 mrr: 8.42, ndcg: 8.68, took: 1.19s
Validation - loss: 5.6586, acc@1: 19.02%, f1: 10.23%, mrr: 28.03%, ndcg: 31.61%
Current learning rate: 0.000667

=== Epoch 2 ===
Epoch 2, 34.5%	 loss: 5.110 acc@1: 22.66 mrr: 33.17, ndcg: 37.30, took: 1.25s
Epoch 2, 69.0%	 loss: 4.352 acc@1: 27.42 mrr: 39.39, ndcg: 44.15, took: 1.24s
Validation - loss: 4.4371, acc@1: 32.27%, f1: 20.99%, mrr: 43.67%, ndcg: 47.48%
Current learning rate: 0.001333

=== Epoch 3 ===
Epoch 3, 34.5%	 loss: 3.553 acc@1: 35.35 mrr: 48.04, ndcg: 52.39, took: 1.21s
Epoch 3, 69.0%	 loss: 3.520 acc@1: 34.06 mrr: 47.69, ndcg: 52.55, took: 1.31s
Validation - loss: 4.3813, acc@1: 32.78%, f1: 20.97%, mrr: 44.99%, ndcg: 49.03%
Current learning rate: 0.002000

=== Epoch 4 ===
Epoch 4, 34.5%	 loss: 3.131 acc@1: 35.23 mrr: 50.09, ndcg: 55.15, took: 1.16s
Epoch 4, 69.0%	 loss: 3.043 acc@1: 36.17 mrr: 50.98, ndcg: 56.26, took: 1.02s
Validation - loss: 4.4369, acc@1: 33.89%, f1: 22.62%, mrr: 45.88%, ndcg: 50.06%
Current learning rate: 0.001957

=== Epoch 5 ===
Epoch 5, 34.5%	 loss: 2.739 acc@1: 36.80 mrr: 52.99, ndcg: 58.72, took: 1.03s
Epoch 5, 69.0%	 loss: 2.817 acc@1: 36.41 mrr: 52.64, ndcg: 58.25, took: 1.05s
Validation - loss: 4.5104, acc@1: 32.12%, f1: 22.52%, mrr: 45.02%, ndcg: 49.37%
Current learning rate: 0.001915

=== Epoch 6 ===
Epoch 6, 34.5%	 loss: 2.475 acc@1: 38.44 mrr: 55.73, ndcg: 62.07, took: 1.03s
Epoch 6, 69.0%	 loss: 2.559 acc@1: 37.03 mrr: 54.08, ndcg: 60.26, took: 1.05s
Validation - loss: 4.5123, acc@1: 33.05%, f1: 22.44%, mrr: 45.64%, ndcg: 49.84%
Current learning rate: 0.001872

=== Epoch 7 ===
Epoch 7, 34.5%	 loss: 2.333 acc@1: 38.01 mrr: 56.38, ndcg: 63.48, took: 1.21s
Epoch 7, 69.0%	 loss: 2.436 acc@1: 37.97 mrr: 55.33, ndcg: 61.79, took: 1.18s
Validation - loss: 4.5605, acc@1: 33.53%, f1: 24.17%, mrr: 46.19%, ndcg: 50.44%
Current learning rate: 0.001830

=== Epoch 8 ===
Epoch 8, 34.5%	 loss: 2.181 acc@1: 40.27 mrr: 58.55, ndcg: 65.81, took: 1.17s
Epoch 8, 69.0%	 loss: 2.272 acc@1: 38.71 mrr: 56.83, ndcg: 63.97, took: 1.14s
Validation - loss: 4.6959, acc@1: 31.37%, f1: 22.26%, mrr: 44.27%, ndcg: 48.76%
Current learning rate: 0.000179

=== Epoch 9 ===
Epoch 9, 34.5%	 loss: 3.054 acc@1: 36.60 mrr: 51.47, ndcg: 56.69, took: 1.20s
Epoch 9, 69.0%	 loss: 3.028 acc@1: 35.55 mrr: 50.71, ndcg: 56.04, took: 1.24s
Validation - loss: 4.3188, acc@1: 33.89%, f1: 22.23%, mrr: 46.19%, ndcg: 50.28%
Current learning rate: 0.000179

=== Epoch 10 ===
Epoch 10, 34.5%	 loss: 2.928 acc@1: 37.42 mrr: 52.73, ndcg: 57.78, took: 1.15s
Epoch 10, 69.0%	 loss: 2.988 acc@1: 36.91 mrr: 51.50, ndcg: 56.55, took: 1.09s
Validation - loss: 4.3091, acc@1: 34.01%, f1: 22.55%, mrr: 46.37%, ndcg: 50.51%
Current learning rate: 0.000179

=== Epoch 11 ===
Epoch 11, 34.5%	 loss: 2.906 acc@1: 37.89 mrr: 52.88, ndcg: 57.84, took: 1.28s
Epoch 11, 69.0%	 loss: 2.821 acc@1: 38.44 mrr: 53.79, ndcg: 58.89, took: 1.11s
Validation - loss: 4.3117, acc@1: 33.80%, f1: 22.84%, mrr: 46.28%, ndcg: 50.45%
Current learning rate: 0.000179

=== Epoch 12 ===
Epoch 12, 34.5%	 loss: 2.894 acc@1: 36.02 mrr: 51.64, ndcg: 57.00, took: 1.12s
Epoch 12, 69.0%	 loss: 2.822 acc@1: 37.66 mrr: 53.10, ndcg: 58.30, took: 1.16s
Validation - loss: 4.3228, acc@1: 34.22%, f1: 22.64%, mrr: 46.50%, ndcg: 50.67%
Current learning rate: 0.000179

=== Epoch 13 ===
Epoch 13, 34.5%	 loss: 2.727 acc@1: 39.38 mrr: 54.59, ndcg: 59.79, took: 1.23s
Epoch 13, 69.0%	 loss: 2.801 acc@1: 37.70 mrr: 53.41, ndcg: 58.80, took: 1.15s
Validation - loss: 4.3302, acc@1: 33.68%, f1: 22.37%, mrr: 46.21%, ndcg: 50.43%
Current learning rate: 0.000179

=== Epoch 14 ===
Epoch 14, 34.5%	 loss: 2.726 acc@1: 39.10 mrr: 54.49, ndcg: 59.76, took: 1.11s
Epoch 14, 69.0%	 loss: 2.696 acc@1: 39.30 mrr: 55.01, ndcg: 60.40, took: 1.10s
Validation - loss: 4.3488, acc@1: 33.86%, f1: 22.84%, mrr: 46.22%, ndcg: 50.41%
Current learning rate: 0.000179

=== Epoch 15 ===
Epoch 15, 34.5%	 loss: 2.693 acc@1: 38.75 mrr: 54.56, ndcg: 60.10, took: 1.14s
Epoch 15, 69.0%	 loss: 2.750 acc@1: 38.24 mrr: 53.82, ndcg: 59.22, took: 1.09s
Validation - loss: 4.3526, acc@1: 34.13%, f1: 22.43%, mrr: 46.59%, ndcg: 50.84%
Current learning rate: 0.000018

=== Epoch 16 ===
Epoch 16, 34.5%	 loss: 2.858 acc@1: 38.28 mrr: 53.30, ndcg: 58.34, took: 1.10s
Epoch 16, 69.0%	 loss: 2.914 acc@1: 37.03 mrr: 52.13, ndcg: 57.30, took: 1.10s
Validation - loss: 4.3106, acc@1: 33.95%, f1: 22.35%, mrr: 46.33%, ndcg: 50.47%
Current learning rate: 0.000018

=== Epoch 17 ===
Epoch 17, 34.5%	 loss: 2.858 acc@1: 37.89 mrr: 53.31, ndcg: 58.55, took: 1.11s
Epoch 17, 69.0%	 loss: 2.871 acc@1: 37.73 mrr: 52.94, ndcg: 57.87, took: 1.15s
Validation - loss: 4.3120, acc@1: 33.86%, f1: 22.47%, mrr: 46.28%, ndcg: 50.41%
Current learning rate: 0.000018

=== Epoch 18 ===
Epoch 18, 34.5%	 loss: 2.849 acc@1: 38.20 mrr: 53.46, ndcg: 58.57, took: 1.15s
Epoch 18, 69.0%	 loss: 2.830 acc@1: 38.71 mrr: 53.55, ndcg: 58.52, took: 1.13s
Validation - loss: 4.3091, acc@1: 33.83%, f1: 22.49%, mrr: 46.29%, ndcg: 50.43%
Current learning rate: 0.000018

=== Epoch 19 ===
Epoch 19, 34.5%	 loss: 2.875 acc@1: 36.99 mrr: 52.57, ndcg: 57.74, took: 1.23s
Epoch 19, 69.0%	 loss: 2.840 acc@1: 38.09 mrr: 53.36, ndcg: 58.45, took: 1.26s
Validation - loss: 4.3143, acc@1: 33.74%, f1: 22.32%, mrr: 46.19%, ndcg: 50.39%
Current learning rate: 0.000018

=== Epoch 20 ===
Epoch 20, 34.5%	 loss: 2.893 acc@1: 37.19 mrr: 52.44, ndcg: 57.51, took: 1.16s
Epoch 20, 69.0%	 loss: 2.824 acc@1: 39.53 mrr: 54.13, ndcg: 59.05, took: 1.17s
Validation - loss: 4.3139, acc@1: 33.65%, f1: 22.29%, mrr: 46.19%, ndcg: 50.38%
Training finished.	 Time: 86.14s.	 acc@1: 34.01%

=== Test Results ===
Test Results:
  acc@1: 28.50%
  acc@5: 53.51%
  acc@10: 58.05%
  mrr: 40.06%
  ndcg: 44.14%
  f1: 18.03%

=== Training Complete ===
