Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/scripts/sci_hyperparam_tuning/configs/mhsa_geolife_trial19.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=58, val=27, test=28
Total trainable parameters: 137955

=== Epoch 1 ===
Epoch 1, 34.5%	 loss: 7.103 acc@1: 0.04 mrr: 0.54, ndcg: 0.20, took: 2.07s
Epoch 1, 69.0%	 loss: 7.088 acc@1: 0.08 mrr: 0.67, ndcg: 0.40, took: 1.07s
Validation - loss: 7.0179, acc@1: 1.68%, f1: 2.32%, mrr: 3.30%, ndcg: 3.46%
Current learning rate: 0.000500

=== Epoch 2 ===
Epoch 2, 34.5%	 loss: 6.991 acc@1: 0.98 mrr: 2.84, ndcg: 3.02, took: 1.09s
Epoch 2, 69.0%	 loss: 6.894 acc@1: 5.31 mrr: 9.04, ndcg: 9.86, took: 1.13s
Validation - loss: 6.6648, acc@1: 16.86%, f1: 11.69%, mrr: 23.69%, ndcg: 25.54%
Current learning rate: 0.000490

=== Epoch 3 ===
Epoch 3, 34.5%	 loss: 6.570 acc@1: 18.48 mrr: 25.69, ndcg: 27.87, took: 1.18s
Epoch 3, 69.0%	 loss: 6.395 acc@1: 18.59 mrr: 27.62, ndcg: 30.96, took: 1.00s
Validation - loss: 6.0587, acc@1: 17.19%, f1: 11.54%, mrr: 28.66%, ndcg: 33.27%
Current learning rate: 0.000480

=== Epoch 4 ===
Epoch 4, 34.5%	 loss: 6.016 acc@1: 20.35 mrr: 30.02, ndcg: 33.89, took: 1.19s
Epoch 4, 69.0%	 loss: 5.806 acc@1: 20.66 mrr: 31.32, ndcg: 35.42, took: 1.20s
Validation - loss: 5.5200, acc@1: 19.23%, f1: 13.45%, mrr: 31.53%, ndcg: 36.35%
Current learning rate: 0.000469

=== Epoch 5 ===
Epoch 5, 34.5%	 loss: 5.491 acc@1: 21.72 mrr: 32.65, ndcg: 37.18, took: 1.14s
Epoch 5, 69.0%	 loss: 5.334 acc@1: 22.23 mrr: 33.48, ndcg: 37.85, took: 1.27s
Validation - loss: 5.1958, acc@1: 20.34%, f1: 12.22%, mrr: 33.56%, ndcg: 38.81%
Current learning rate: 0.000459

=== Epoch 6 ===
Epoch 6, 34.5%	 loss: 5.081 acc@1: 23.12 mrr: 34.77, ndcg: 39.66, took: 1.28s
Epoch 6, 69.0%	 loss: 4.914 acc@1: 23.44 mrr: 35.38, ndcg: 40.40, took: 1.23s
Validation - loss: 4.9138, acc@1: 20.16%, f1: 11.77%, mrr: 34.11%, ndcg: 39.81%
Current learning rate: 0.000449

=== Epoch 7 ===
Epoch 7, 34.5%	 loss: 4.709 acc@1: 24.18 mrr: 35.97, ndcg: 40.87, took: 1.15s
Epoch 7, 69.0%	 loss: 4.572 acc@1: 24.80 mrr: 37.27, ndcg: 42.41, took: 1.16s
Validation - loss: 4.7255, acc@1: 21.27%, f1: 12.48%, mrr: 35.88%, ndcg: 41.35%
Current learning rate: 0.000439

=== Epoch 8 ===
Epoch 8, 34.5%	 loss: 4.408 acc@1: 26.84 mrr: 39.00, ndcg: 43.84, took: 1.11s
Epoch 8, 69.0%	 loss: 4.300 acc@1: 27.38 mrr: 39.87, ndcg: 44.72, took: 1.09s
Validation - loss: 4.5925, acc@1: 23.58%, f1: 13.58%, mrr: 37.71%, ndcg: 42.78%
Current learning rate: 0.000429

=== Epoch 9 ===
Epoch 9, 34.5%	 loss: 4.237 acc@1: 27.19 mrr: 39.86, ndcg: 44.63, took: 1.12s
Epoch 9, 69.0%	 loss: 4.105 acc@1: 29.45 mrr: 41.56, ndcg: 46.36, took: 1.01s
Validation - loss: 4.5141, acc@1: 24.42%, f1: 14.05%, mrr: 38.50%, ndcg: 43.44%
Current learning rate: 0.000418

=== Epoch 10 ===
Epoch 10, 34.5%	 loss: 4.075 acc@1: 28.59 mrr: 41.29, ndcg: 45.94, took: 1.29s
Epoch 10, 69.0%	 loss: 3.930 acc@1: 29.73 mrr: 42.80, ndcg: 47.72, took: 1.19s
Validation - loss: 4.4622, acc@1: 25.28%, f1: 14.63%, mrr: 39.20%, ndcg: 44.01%
Current learning rate: 0.000408

=== Epoch 11 ===
Epoch 11, 34.5%	 loss: 3.893 acc@1: 30.47 mrr: 42.95, ndcg: 47.55, took: 1.34s
Epoch 11, 69.0%	 loss: 3.834 acc@1: 31.25 mrr: 44.06, ndcg: 48.76, took: 1.27s
Validation - loss: 4.4486, acc@1: 26.18%, f1: 15.55%, mrr: 39.89%, ndcg: 44.59%
Current learning rate: 0.000398

=== Epoch 12 ===
Epoch 12, 34.5%	 loss: 3.699 acc@1: 32.50 mrr: 45.36, ndcg: 50.04, took: 1.33s
Epoch 12, 69.0%	 loss: 3.806 acc@1: 31.17 mrr: 43.98, ndcg: 48.55, took: 1.36s
Validation - loss: 4.4334, acc@1: 26.24%, f1: 15.70%, mrr: 39.75%, ndcg: 44.59%
Current learning rate: 0.000388

=== Epoch 13 ===
Epoch 13, 34.5%	 loss: 3.699 acc@1: 32.42 mrr: 45.52, ndcg: 50.10, took: 1.24s
Epoch 13, 69.0%	 loss: 3.725 acc@1: 31.02 mrr: 44.25, ndcg: 48.81, took: 1.30s
Validation - loss: 4.4081, acc@1: 26.42%, f1: 15.83%, mrr: 39.81%, ndcg: 44.70%
Current learning rate: 0.000378

=== Epoch 14 ===
Epoch 14, 34.5%	 loss: 3.607 acc@1: 34.61 mrr: 47.11, ndcg: 51.33, took: 1.23s
Epoch 14, 69.0%	 loss: 3.631 acc@1: 32.46 mrr: 45.47, ndcg: 50.16, took: 1.27s
Validation - loss: 4.4234, acc@1: 26.99%, f1: 17.85%, mrr: 40.40%, ndcg: 45.15%
Current learning rate: 0.000367

=== Epoch 15 ===
Epoch 15, 34.5%	 loss: 3.594 acc@1: 33.52 mrr: 46.53, ndcg: 50.86, took: 1.31s
Epoch 15, 69.0%	 loss: 3.551 acc@1: 34.34 mrr: 47.35, ndcg: 51.71, took: 1.27s
Validation - loss: 4.4075, acc@1: 27.50%, f1: 17.75%, mrr: 41.03%, ndcg: 45.80%
Current learning rate: 0.000357

=== Epoch 16 ===
Epoch 16, 34.5%	 loss: 3.572 acc@1: 32.97 mrr: 46.42, ndcg: 50.94, took: 1.28s
Epoch 16, 69.0%	 loss: 3.466 acc@1: 33.63 mrr: 47.55, ndcg: 51.91, took: 1.31s
Validation - loss: 4.3720, acc@1: 28.40%, f1: 19.24%, mrr: 41.74%, ndcg: 46.58%
Current learning rate: 0.000347

=== Epoch 17 ===
Epoch 17, 34.5%	 loss: 3.423 acc@1: 34.88 mrr: 48.29, ndcg: 52.83, took: 1.18s
Epoch 17, 69.0%	 loss: 3.420 acc@1: 35.66 mrr: 49.03, ndcg: 53.26, took: 1.23s
Validation - loss: 4.3658, acc@1: 29.27%, f1: 20.37%, mrr: 42.16%, ndcg: 46.88%
Current learning rate: 0.000337

=== Epoch 18 ===
Epoch 18, 34.5%	 loss: 3.384 acc@1: 34.88 mrr: 48.71, ndcg: 53.06, took: 1.28s
Epoch 18, 69.0%	 loss: 3.387 acc@1: 35.78 mrr: 49.28, ndcg: 53.54, took: 1.28s
Validation - loss: 4.3568, acc@1: 29.57%, f1: 20.98%, mrr: 42.49%, ndcg: 47.39%
Current learning rate: 0.000327

=== Epoch 19 ===
Epoch 19, 34.5%	 loss: 3.326 acc@1: 36.17 mrr: 49.84, ndcg: 54.19, took: 1.28s
Epoch 19, 69.0%	 loss: 3.281 acc@1: 37.46 mrr: 50.82, ndcg: 55.10, took: 1.25s
Validation - loss: 4.3310, acc@1: 32.33%, f1: 22.55%, mrr: 44.23%, ndcg: 48.68%
Current learning rate: 0.000316

=== Epoch 20 ===
Epoch 20, 34.5%	 loss: 3.210 acc@1: 37.62 mrr: 51.24, ndcg: 55.58, took: 1.31s
Epoch 20, 69.0%	 loss: 3.320 acc@1: 36.17 mrr: 49.85, ndcg: 54.01, took: 1.36s
Validation - loss: 4.3291, acc@1: 33.08%, f1: 23.08%, mrr: 44.92%, ndcg: 49.29%
Current learning rate: 0.000306

=== Epoch 21 ===
Epoch 21, 34.5%	 loss: 3.255 acc@1: 36.56 mrr: 50.34, ndcg: 54.76, took: 1.34s
Epoch 21, 69.0%	 loss: 3.256 acc@1: 37.42 mrr: 50.98, ndcg: 55.27, took: 1.21s
Validation - loss: 4.3064, acc@1: 34.73%, f1: 24.01%, mrr: 46.27%, ndcg: 50.37%
Current learning rate: 0.000296

=== Epoch 22 ===
Epoch 22, 34.5%	 loss: 3.145 acc@1: 39.10 mrr: 52.72, ndcg: 56.94, took: 1.44s
Epoch 22, 69.0%	 loss: 3.156 acc@1: 39.53 mrr: 52.41, ndcg: 56.57, took: 1.29s
Validation - loss: 4.2633, acc@1: 35.18%, f1: 24.11%, mrr: 46.70%, ndcg: 50.83%
Current learning rate: 0.000286

=== Epoch 23 ===
Epoch 23, 34.5%	 loss: 3.156 acc@1: 37.89 mrr: 51.77, ndcg: 55.96, took: 1.34s
Epoch 23, 69.0%	 loss: 3.154 acc@1: 38.20 mrr: 51.78, ndcg: 56.10, took: 1.28s
Validation - loss: 4.2908, acc@1: 35.45%, f1: 24.49%, mrr: 46.81%, ndcg: 50.85%
Current learning rate: 0.000276

=== Epoch 24 ===
Epoch 24, 34.5%	 loss: 3.099 acc@1: 39.14 mrr: 52.72, ndcg: 57.11, took: 1.29s
Epoch 24, 69.0%	 loss: 3.071 acc@1: 39.45 mrr: 52.89, ndcg: 57.16, took: 1.23s
Validation - loss: 4.2618, acc@1: 35.72%, f1: 24.35%, mrr: 47.28%, ndcg: 51.26%
Current learning rate: 0.000265

=== Epoch 25 ===
Epoch 25, 34.5%	 loss: 3.094 acc@1: 41.17 mrr: 53.52, ndcg: 57.64, took: 1.35s
Epoch 25, 69.0%	 loss: 3.085 acc@1: 39.53 mrr: 52.90, ndcg: 57.20, took: 1.27s
Validation - loss: 4.2407, acc@1: 36.50%, f1: 25.23%, mrr: 47.77%, ndcg: 51.68%
Current learning rate: 0.000255

=== Epoch 26 ===
Epoch 26, 34.5%	 loss: 2.995 acc@1: 41.33 mrr: 54.33, ndcg: 58.59, took: 1.29s
Epoch 26, 69.0%	 loss: 2.960 acc@1: 41.02 mrr: 54.43, ndcg: 58.69, took: 1.30s
Validation - loss: 4.2479, acc@1: 36.71%, f1: 25.26%, mrr: 47.94%, ndcg: 51.86%
Current learning rate: 0.000245

=== Epoch 27 ===
Epoch 27, 34.5%	 loss: 3.038 acc@1: 41.05 mrr: 53.78, ndcg: 57.92, took: 1.32s
Epoch 27, 69.0%	 loss: 2.945 acc@1: 41.72 mrr: 55.00, ndcg: 59.20, took: 1.35s
Validation - loss: 4.2477, acc@1: 36.65%, f1: 25.21%, mrr: 47.97%, ndcg: 51.89%
Current learning rate: 0.000235

=== Epoch 28 ===
Epoch 28, 34.5%	 loss: 2.989 acc@1: 41.09 mrr: 54.12, ndcg: 58.31, took: 1.34s
Epoch 28, 69.0%	 loss: 3.001 acc@1: 40.86 mrr: 53.86, ndcg: 57.87, took: 1.42s
Validation - loss: 4.2389, acc@1: 36.92%, f1: 25.34%, mrr: 48.10%, ndcg: 52.01%
Current learning rate: 0.000224

=== Epoch 29 ===
Epoch 29, 34.5%	 loss: 2.938 acc@1: 42.77 mrr: 55.24, ndcg: 59.32, took: 1.22s
Epoch 29, 69.0%	 loss: 2.961 acc@1: 41.72 mrr: 54.74, ndcg: 59.01, took: 1.20s
Validation - loss: 4.2439, acc@1: 36.71%, f1: 25.53%, mrr: 48.13%, ndcg: 52.08%
Current learning rate: 0.000214

=== Epoch 30 ===
Epoch 30, 34.5%	 loss: 2.992 acc@1: 40.31 mrr: 53.53, ndcg: 57.71, took: 1.36s
Epoch 30, 69.0%	 loss: 2.929 acc@1: 41.99 mrr: 55.02, ndcg: 59.25, took: 1.35s
Validation - loss: 4.2492, acc@1: 37.28%, f1: 25.88%, mrr: 48.48%, ndcg: 52.35%
Current learning rate: 0.000204

=== Epoch 31 ===
Epoch 31, 34.5%	 loss: 2.902 acc@1: 41.33 mrr: 54.70, ndcg: 58.98, took: 1.40s
Epoch 31, 69.0%	 loss: 2.851 acc@1: 42.62 mrr: 55.72, ndcg: 59.93, took: 1.37s
Validation - loss: 4.2484, acc@1: 37.13%, f1: 25.99%, mrr: 48.41%, ndcg: 52.30%
Current learning rate: 0.000194

=== Epoch 32 ===
Epoch 32, 34.5%	 loss: 2.858 acc@1: 43.36 mrr: 55.91, ndcg: 60.04, took: 1.33s
Epoch 32, 69.0%	 loss: 2.874 acc@1: 42.34 mrr: 55.57, ndcg: 59.81, took: 1.32s
Validation - loss: 4.2394, acc@1: 37.22%, f1: 26.15%, mrr: 48.49%, ndcg: 52.31%
Current learning rate: 0.000184

=== Epoch 33 ===
Epoch 33, 34.5%	 loss: 2.905 acc@1: 41.95 mrr: 55.12, ndcg: 59.31, took: 1.25s
Epoch 33, 69.0%	 loss: 2.810 acc@1: 43.71 mrr: 56.59, ndcg: 60.92, took: 1.32s
Validation - loss: 4.2441, acc@1: 37.37%, f1: 26.23%, mrr: 48.61%, ndcg: 52.44%
Current learning rate: 0.000017

=== Epoch 34 ===
Epoch 34, 34.5%	 loss: 2.926 acc@1: 42.54 mrr: 55.33, ndcg: 59.43, took: 1.38s
Epoch 34, 69.0%	 loss: 2.917 acc@1: 41.05 mrr: 54.55, ndcg: 58.90, took: 1.31s
Validation - loss: 4.2489, acc@1: 36.86%, f1: 25.47%, mrr: 48.09%, ndcg: 51.97%
Current learning rate: 0.000017

=== Epoch 35 ===
Epoch 35, 34.5%	 loss: 2.954 acc@1: 40.98 mrr: 54.22, ndcg: 58.66, took: 1.44s
Epoch 35, 69.0%	 loss: 2.931 acc@1: 42.50 mrr: 55.14, ndcg: 59.13, took: 1.30s
Validation - loss: 4.2524, acc@1: 36.74%, f1: 25.41%, mrr: 48.04%, ndcg: 51.94%
Current learning rate: 0.000017

=== Epoch 36 ===
Epoch 36, 34.5%	 loss: 2.916 acc@1: 41.80 mrr: 54.99, ndcg: 59.33, took: 1.24s
Epoch 36, 69.0%	 loss: 2.978 acc@1: 41.05 mrr: 54.08, ndcg: 58.21, took: 1.38s
Validation - loss: 4.2461, acc@1: 36.89%, f1: 25.41%, mrr: 48.17%, ndcg: 52.06%
Current learning rate: 0.000017

=== Epoch 37 ===
Epoch 37, 34.5%	 loss: 2.886 acc@1: 42.23 mrr: 55.42, ndcg: 59.69, took: 1.46s
Epoch 37, 69.0%	 loss: 2.976 acc@1: 41.56 mrr: 54.43, ndcg: 58.53, took: 1.57s
Validation - loss: 4.2542, acc@1: 36.98%, f1: 25.47%, mrr: 48.20%, ndcg: 52.06%
Current learning rate: 0.000017

=== Epoch 38 ===
Epoch 38, 34.5%	 loss: 2.973 acc@1: 41.09 mrr: 53.94, ndcg: 58.11, took: 1.31s
Epoch 38, 69.0%	 loss: 2.916 acc@1: 42.58 mrr: 55.19, ndcg: 59.29, took: 1.38s
Validation - loss: 4.2421, acc@1: 36.89%, f1: 25.44%, mrr: 48.16%, ndcg: 52.07%
Current learning rate: 0.000002

=== Epoch 39 ===
Epoch 39, 34.5%	 loss: 2.986 acc@1: 41.95 mrr: 54.45, ndcg: 58.31, took: 1.34s
Epoch 39, 69.0%	 loss: 2.929 acc@1: 42.07 mrr: 55.02, ndcg: 59.23, took: 1.26s
Validation - loss: 4.2447, acc@1: 36.77%, f1: 25.38%, mrr: 48.03%, ndcg: 51.94%
Current learning rate: 0.000002

=== Epoch 40 ===
Epoch 40, 34.5%	 loss: 2.962 acc@1: 40.43 mrr: 53.85, ndcg: 58.28, took: 1.25s
Epoch 40, 69.0%	 loss: 2.970 acc@1: 41.48 mrr: 54.39, ndcg: 58.52, took: 1.31s
Validation - loss: 4.2530, acc@1: 36.98%, f1: 25.53%, mrr: 48.16%, ndcg: 52.02%
Current learning rate: 0.000002

=== Epoch 41 ===
Epoch 41, 34.5%	 loss: 2.988 acc@1: 40.43 mrr: 53.60, ndcg: 57.89, took: 1.30s
Epoch 41, 69.0%	 loss: 2.967 acc@1: 41.88 mrr: 54.66, ndcg: 58.72, took: 1.27s
Validation - loss: 4.2400, acc@1: 37.01%, f1: 25.47%, mrr: 48.21%, ndcg: 52.09%
Current learning rate: 0.000002

=== Epoch 42 ===
Epoch 42, 34.5%	 loss: 2.991 acc@1: 40.66 mrr: 53.62, ndcg: 57.88, took: 1.17s
Epoch 42, 69.0%	 loss: 2.925 acc@1: 41.84 mrr: 54.99, ndcg: 59.04, took: 1.23s
Validation - loss: 4.2421, acc@1: 36.98%, f1: 25.49%, mrr: 48.20%, ndcg: 52.08%
Current learning rate: 0.000002

=== Epoch 43 ===
Epoch 43, 34.5%	 loss: 2.973 acc@1: 40.00 mrr: 53.58, ndcg: 57.97, took: 1.17s
Epoch 43, 69.0%	 loss: 2.926 acc@1: 43.05 mrr: 55.45, ndcg: 59.49, took: 1.25s
Validation - loss: 4.2407, acc@1: 36.95%, f1: 25.47%, mrr: 48.19%, ndcg: 52.10%
Training finished.	 Time: 200.44s.	 acc@1: 36.92%

=== Test Results ===
Test Results:
  acc@1: 28.36%
  acc@5: 53.71%
  acc@10: 59.17%
  mrr: 39.76%
  ndcg: 44.20%
  f1: 18.18%

=== Training Complete ===
