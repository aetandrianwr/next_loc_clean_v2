Training MHSA model
Dataset: geolife
Config: /data/next_loc_clean_v2/config/ht_optuna/optuna_MHSA_geolife_prev7_t14_20251231_153638_b30fe939.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=232, val=105, test=110
Total trainable parameters: 248227

=== Epoch 1 ===
Epoch 1, 8.6%	 loss: 7.126 acc@1: 0.00 mrr: 0.52, ndcg: 0.24, took: 2.34s
Epoch 1, 17.2%	 loss: 7.097 acc@1: 0.16 mrr: 0.73, ndcg: 0.37, took: 1.07s
Epoch 1, 25.9%	 loss: 7.099 acc@1: 0.47 mrr: 1.32, ndcg: 1.11, took: 1.18s
Epoch 1, 34.5%	 loss: 7.073 acc@1: 0.16 mrr: 1.25, ndcg: 1.10, took: 1.17s
Epoch 1, 43.1%	 loss: 7.039 acc@1: 0.16 mrr: 1.74, ndcg: 1.80, took: 1.33s
Epoch 1, 51.7%	 loss: 6.987 acc@1: 1.25 mrr: 3.48, ndcg: 3.70, took: 1.36s
Epoch 1, 60.3%	 loss: 6.914 acc@1: 4.53 mrr: 7.67, ndcg: 8.40, took: 1.40s
Epoch 1, 69.0%	 loss: 6.742 acc@1: 13.12 mrr: 17.44, ndcg: 18.57, took: 1.34s
Epoch 1, 77.6%	 loss: 6.532 acc@1: 17.03 mrr: 22.42, ndcg: 24.14, took: 1.27s
Epoch 1, 86.2%	 loss: 6.209 acc@1: 18.75 mrr: 25.92, ndcg: 28.28, took: 1.21s
Epoch 1, 94.8%	 loss: 5.944 acc@1: 18.91 mrr: 27.17, ndcg: 30.22, took: 1.21s
Validation - loss: 5.4474, acc@1: 18.57%, f1: 9.76%, mrr: 29.39%, ndcg: 34.23%
Current learning rate: 0.001000

=== Epoch 2 ===
Epoch 2, 8.6%	 loss: 5.421 acc@1: 22.19 mrr: 30.62, ndcg: 34.09, took: 1.02s
Epoch 2, 17.2%	 loss: 5.165 acc@1: 21.25 mrr: 31.72, ndcg: 36.13, took: 1.08s
Epoch 2, 25.9%	 loss: 5.050 acc@1: 20.78 mrr: 31.83, ndcg: 36.57, took: 1.10s
Epoch 2, 34.5%	 loss: 4.973 acc@1: 20.47 mrr: 31.67, ndcg: 36.83, took: 1.09s
Epoch 2, 43.1%	 loss: 4.651 acc@1: 23.59 mrr: 35.74, ndcg: 40.41, took: 1.34s
Epoch 2, 51.7%	 loss: 4.397 acc@1: 24.84 mrr: 37.94, ndcg: 43.11, took: 1.34s
Epoch 2, 60.3%	 loss: 4.271 acc@1: 25.62 mrr: 38.93, ndcg: 44.55, took: 1.31s
Epoch 2, 69.0%	 loss: 4.054 acc@1: 28.91 mrr: 42.07, ndcg: 46.79, took: 1.36s
Epoch 2, 77.6%	 loss: 4.078 acc@1: 30.16 mrr: 42.16, ndcg: 46.73, took: 1.22s
Epoch 2, 86.2%	 loss: 3.920 acc@1: 32.03 mrr: 44.51, ndcg: 49.39, took: 1.29s
Epoch 2, 94.8%	 loss: 3.917 acc@1: 32.81 mrr: 45.55, ndcg: 50.25, took: 1.33s
Validation - loss: 4.5145, acc@1: 34.61%, f1: 22.63%, mrr: 45.27%, ndcg: 49.28%
Current learning rate: 0.002000

=== Epoch 3 ===
Epoch 3, 8.6%	 loss: 3.510 acc@1: 34.84 mrr: 47.93, ndcg: 52.89, took: 1.17s
Epoch 3, 17.2%	 loss: 3.589 acc@1: 36.25 mrr: 48.87, ndcg: 52.82, took: 1.09s
Epoch 3, 25.9%	 loss: 3.684 acc@1: 32.34 mrr: 45.62, ndcg: 50.45, took: 1.23s
Epoch 3, 34.5%	 loss: 3.541 acc@1: 31.88 mrr: 47.07, ndcg: 52.21, took: 1.19s
Epoch 3, 43.1%	 loss: 3.424 acc@1: 36.88 mrr: 49.89, ndcg: 54.28, took: 1.21s
Epoch 3, 51.7%	 loss: 3.543 acc@1: 36.09 mrr: 48.90, ndcg: 52.91, took: 1.17s
Epoch 3, 60.3%	 loss: 3.565 acc@1: 35.94 mrr: 48.29, ndcg: 53.00, took: 1.34s
Epoch 3, 69.0%	 loss: 3.487 acc@1: 38.28 mrr: 50.30, ndcg: 54.45, took: 1.44s
Epoch 3, 77.6%	 loss: 3.427 acc@1: 37.50 mrr: 50.31, ndcg: 54.79, took: 1.51s
Epoch 3, 86.2%	 loss: 3.370 acc@1: 35.94 mrr: 49.67, ndcg: 54.35, took: 1.46s
Epoch 3, 94.8%	 loss: 3.276 acc@1: 38.75 mrr: 51.80, ndcg: 56.48, took: 1.38s
Validation - loss: 4.5313, acc@1: 36.98%, f1: 26.81%, mrr: 47.96%, ndcg: 51.77%
Current learning rate: 0.001958

=== Epoch 4 ===
Epoch 4, 8.6%	 loss: 3.134 acc@1: 38.12 mrr: 51.06, ndcg: 55.55, took: 1.52s
Epoch 4, 17.2%	 loss: 2.904 acc@1: 44.38 mrr: 56.47, ndcg: 60.49, took: 1.23s
Epoch 4, 25.9%	 loss: 3.044 acc@1: 39.84 mrr: 53.10, ndcg: 57.62, took: 1.23s
Epoch 4, 34.5%	 loss: 2.788 acc@1: 44.38 mrr: 57.18, ndcg: 61.58, took: 1.32s
Epoch 4, 43.1%	 loss: 3.124 acc@1: 37.34 mrr: 51.80, ndcg: 56.48, took: 1.21s
Epoch 4, 51.7%	 loss: 2.964 acc@1: 42.19 mrr: 55.11, ndcg: 59.44, took: 1.29s
Epoch 4, 60.3%	 loss: 3.136 acc@1: 39.84 mrr: 52.64, ndcg: 56.93, took: 1.47s
Epoch 4, 69.0%	 loss: 2.952 acc@1: 42.50 mrr: 55.38, ndcg: 59.35, took: 1.25s
Epoch 4, 77.6%	 loss: 3.117 acc@1: 37.19 mrr: 51.24, ndcg: 56.25, took: 1.14s
Epoch 4, 86.2%	 loss: 3.134 acc@1: 40.00 mrr: 52.24, ndcg: 56.61, took: 1.26s
Epoch 4, 94.8%	 loss: 3.172 acc@1: 38.75 mrr: 51.73, ndcg: 56.44, took: 1.48s
Validation - loss: 4.4741, acc@1: 40.13%, f1: 30.22%, mrr: 50.22%, ndcg: 53.86%
Current learning rate: 0.001917

=== Epoch 5 ===
Epoch 5, 8.6%	 loss: 2.707 acc@1: 44.69 mrr: 57.35, ndcg: 61.58, took: 1.40s
Epoch 5, 17.2%	 loss: 2.816 acc@1: 40.16 mrr: 54.67, ndcg: 59.81, took: 1.42s
Epoch 5, 25.9%	 loss: 2.622 acc@1: 45.47 mrr: 58.33, ndcg: 62.77, took: 1.39s
Epoch 5, 34.5%	 loss: 2.693 acc@1: 44.22 mrr: 57.47, ndcg: 62.27, took: 1.37s
Epoch 5, 43.1%	 loss: 2.711 acc@1: 44.69 mrr: 57.46, ndcg: 61.84, took: 1.38s
Epoch 5, 51.7%	 loss: 2.816 acc@1: 44.38 mrr: 55.89, ndcg: 59.90, took: 1.28s
Epoch 5, 60.3%	 loss: 2.794 acc@1: 41.88 mrr: 55.05, ndcg: 60.01, took: 1.37s
Epoch 5, 69.0%	 loss: 2.537 acc@1: 46.25 mrr: 59.26, ndcg: 64.11, took: 1.37s
Epoch 5, 77.6%	 loss: 2.693 acc@1: 45.31 mrr: 57.61, ndcg: 62.02, took: 1.37s
Epoch 5, 86.2%	 loss: 2.537 acc@1: 47.50 mrr: 60.23, ndcg: 64.64, took: 1.36s
Epoch 5, 94.8%	 loss: 2.628 acc@1: 45.94 mrr: 57.83, ndcg: 62.44, took: 1.19s
Validation - loss: 4.5584, acc@1: 40.19%, f1: 32.12%, mrr: 50.71%, ndcg: 54.39%
Current learning rate: 0.001875

=== Epoch 6 ===
Epoch 6, 8.6%	 loss: 2.373 acc@1: 48.44 mrr: 61.69, ndcg: 66.57, took: 1.67s
Epoch 6, 17.2%	 loss: 2.358 acc@1: 47.34 mrr: 60.47, ndcg: 65.91, took: 1.40s
Epoch 6, 25.9%	 loss: 2.444 acc@1: 48.75 mrr: 60.61, ndcg: 65.00, took: 1.51s
Epoch 6, 34.5%	 loss: 2.388 acc@1: 49.53 mrr: 61.90, ndcg: 66.78, took: 1.49s
Epoch 6, 43.1%	 loss: 2.260 acc@1: 48.12 mrr: 62.07, ndcg: 67.14, took: 1.20s
Epoch 6, 51.7%	 loss: 2.480 acc@1: 44.84 mrr: 58.66, ndcg: 63.94, took: 1.33s
Epoch 6, 60.3%	 loss: 2.368 acc@1: 48.28 mrr: 61.71, ndcg: 66.04, took: 1.35s
Epoch 6, 69.0%	 loss: 2.389 acc@1: 48.59 mrr: 61.44, ndcg: 66.14, took: 1.39s
Epoch 6, 77.6%	 loss: 2.382 acc@1: 46.56 mrr: 60.30, ndcg: 65.04, took: 1.40s
Epoch 6, 86.2%	 loss: 2.404 acc@1: 47.81 mrr: 60.65, ndcg: 65.15, took: 1.41s
Epoch 6, 94.8%	 loss: 2.367 acc@1: 49.06 mrr: 61.51, ndcg: 65.93, took: 1.18s
Validation - loss: 4.5644, acc@1: 40.67%, f1: 32.98%, mrr: 51.01%, ndcg: 54.61%
Current learning rate: 0.001833

=== Epoch 7 ===
Epoch 7, 8.6%	 loss: 1.985 acc@1: 53.28 mrr: 66.61, ndcg: 71.88, took: 1.27s
Epoch 7, 17.2%	 loss: 1.983 acc@1: 55.47 mrr: 67.38, ndcg: 72.54, took: 1.19s
Epoch 7, 25.9%	 loss: 2.042 acc@1: 52.50 mrr: 65.82, ndcg: 71.38, took: 1.26s
Epoch 7, 34.5%	 loss: 2.059 acc@1: 52.66 mrr: 65.40, ndcg: 70.35, took: 1.28s
Epoch 7, 43.1%	 loss: 2.009 acc@1: 52.81 mrr: 65.86, ndcg: 70.66, took: 1.44s
Epoch 7, 51.7%	 loss: 2.296 acc@1: 50.00 mrr: 62.72, ndcg: 67.74, took: 1.51s
Epoch 7, 60.3%	 loss: 2.116 acc@1: 50.62 mrr: 64.44, ndcg: 69.16, took: 1.35s
Epoch 7, 69.0%	 loss: 2.287 acc@1: 50.31 mrr: 62.34, ndcg: 67.04, took: 1.22s
Epoch 7, 77.6%	 loss: 1.999 acc@1: 52.03 mrr: 65.35, ndcg: 70.58, took: 1.26s
Epoch 7, 86.2%	 loss: 2.162 acc@1: 52.50 mrr: 64.36, ndcg: 69.11, took: 1.22s
Epoch 7, 94.8%	 loss: 2.111 acc@1: 55.00 mrr: 66.17, ndcg: 70.25, took: 1.31s
Validation - loss: 4.7893, acc@1: 39.47%, f1: 33.20%, mrr: 49.37%, ndcg: 53.08%
Current learning rate: 0.001792

=== Epoch 8 ===
Epoch 8, 8.6%	 loss: 1.567 acc@1: 60.47 mrr: 73.22, ndcg: 78.39, took: 1.34s
Epoch 8, 17.2%	 loss: 1.795 acc@1: 57.66 mrr: 69.80, ndcg: 74.83, took: 1.36s
Epoch 8, 25.9%	 loss: 1.865 acc@1: 56.88 mrr: 68.73, ndcg: 73.68, took: 1.33s
Epoch 8, 34.5%	 loss: 1.811 acc@1: 55.47 mrr: 68.49, ndcg: 73.58, took: 1.38s
Epoch 8, 43.1%	 loss: 1.863 acc@1: 55.94 mrr: 68.95, ndcg: 74.16, took: 1.41s
Epoch 8, 51.7%	 loss: 1.809 acc@1: 56.72 mrr: 69.00, ndcg: 73.74, took: 1.45s
Epoch 8, 60.3%	 loss: 1.829 acc@1: 58.59 mrr: 69.82, ndcg: 74.67, took: 1.43s
Epoch 8, 69.0%	 loss: 1.905 acc@1: 51.72 mrr: 66.51, ndcg: 72.04, took: 1.50s
Epoch 8, 77.6%	 loss: 1.860 acc@1: 56.72 mrr: 68.66, ndcg: 73.05, took: 1.35s
Epoch 8, 86.2%	 loss: 2.036 acc@1: 51.41 mrr: 64.80, ndcg: 70.15, took: 1.24s
Epoch 8, 94.8%	 loss: 2.054 acc@1: 51.56 mrr: 64.39, ndcg: 69.80, took: 1.24s
Validation - loss: 4.8022, acc@1: 39.59%, f1: 32.67%, mrr: 49.69%, ndcg: 53.34%
Current learning rate: 0.001750

=== Epoch 9 ===
Epoch 9, 8.6%	 loss: 1.552 acc@1: 60.78 mrr: 72.87, ndcg: 78.08, took: 1.47s
Epoch 9, 17.2%	 loss: 1.469 acc@1: 63.28 mrr: 74.99, ndcg: 79.75, took: 1.38s
Epoch 9, 25.9%	 loss: 1.545 acc@1: 61.72 mrr: 73.62, ndcg: 78.64, took: 1.20s
Epoch 9, 34.5%	 loss: 1.632 acc@1: 58.75 mrr: 71.53, ndcg: 76.84, took: 1.39s
Epoch 9, 43.1%	 loss: 1.595 acc@1: 60.47 mrr: 72.85, ndcg: 78.03, took: 1.39s
Epoch 9, 51.7%	 loss: 1.536 acc@1: 63.28 mrr: 74.44, ndcg: 79.07, took: 1.37s
Epoch 9, 60.3%	 loss: 1.818 acc@1: 55.94 mrr: 68.97, ndcg: 74.35, took: 1.22s
Epoch 9, 69.0%	 loss: 1.663 acc@1: 58.28 mrr: 71.16, ndcg: 76.77, took: 1.37s
Epoch 9, 77.6%	 loss: 1.578 acc@1: 61.25 mrr: 72.78, ndcg: 77.98, took: 1.33s
Epoch 9, 86.2%	 loss: 1.761 acc@1: 58.12 mrr: 70.07, ndcg: 74.88, took: 1.35s
Epoch 9, 94.8%	 loss: 1.689 acc@1: 58.91 mrr: 71.70, ndcg: 76.67, took: 1.44s
Validation - loss: 4.8259, acc@1: 40.28%, f1: 34.59%, mrr: 49.72%, ndcg: 53.22%
Current learning rate: 0.000171

=== Epoch 10 ===
Epoch 10, 8.6%	 loss: 2.748 acc@1: 44.69 mrr: 56.78, ndcg: 61.03, took: 1.41s
Epoch 10, 17.2%	 loss: 2.614 acc@1: 45.47 mrr: 58.66, ndcg: 63.32, took: 1.26s
Epoch 10, 25.9%	 loss: 2.644 acc@1: 46.56 mrr: 58.65, ndcg: 62.47, took: 1.22s
Epoch 10, 34.5%	 loss: 2.683 acc@1: 44.22 mrr: 56.69, ndcg: 61.79, took: 1.26s
Epoch 10, 43.1%	 loss: 2.554 acc@1: 45.78 mrr: 58.88, ndcg: 63.48, took: 1.25s
Epoch 10, 51.7%	 loss: 2.553 acc@1: 42.66 mrr: 57.54, ndcg: 62.85, took: 1.25s
Epoch 10, 60.3%	 loss: 2.533 acc@1: 47.66 mrr: 60.09, ndcg: 64.73, took: 1.26s
Epoch 10, 69.0%	 loss: 2.652 acc@1: 43.59 mrr: 57.22, ndcg: 61.98, took: 1.30s
Epoch 10, 77.6%	 loss: 2.619 acc@1: 45.78 mrr: 58.14, ndcg: 62.73, took: 1.17s
Epoch 10, 86.2%	 loss: 2.495 acc@1: 47.03 mrr: 60.39, ndcg: 64.86, took: 1.13s
Epoch 10, 94.8%	 loss: 2.578 acc@1: 46.41 mrr: 58.92, ndcg: 63.61, took: 1.12s
Validation - loss: 4.4271, acc@1: 40.82%, f1: 31.93%, mrr: 50.75%, ndcg: 54.26%
Current learning rate: 0.000171

=== Epoch 11 ===
Epoch 11, 8.6%	 loss: 2.567 acc@1: 47.34 mrr: 59.19, ndcg: 63.63, took: 1.29s
Epoch 11, 17.2%	 loss: 2.566 acc@1: 43.59 mrr: 58.23, ndcg: 63.56, took: 1.34s
Epoch 11, 25.9%	 loss: 2.512 acc@1: 45.94 mrr: 59.18, ndcg: 64.01, took: 1.48s
Epoch 11, 34.5%	 loss: 2.499 acc@1: 49.38 mrr: 60.77, ndcg: 64.81, took: 1.49s
Epoch 11, 43.1%	 loss: 2.604 acc@1: 46.88 mrr: 58.58, ndcg: 62.87, took: 1.40s
Epoch 11, 51.7%	 loss: 2.290 acc@1: 51.25 mrr: 63.66, ndcg: 68.04, took: 1.37s
Epoch 11, 60.3%	 loss: 2.529 acc@1: 46.09 mrr: 59.28, ndcg: 64.10, took: 1.24s
Epoch 11, 69.0%	 loss: 2.473 acc@1: 47.66 mrr: 60.28, ndcg: 64.70, took: 1.26s
Epoch 11, 77.6%	 loss: 2.383 acc@1: 50.16 mrr: 62.52, ndcg: 66.63, took: 1.37s
Epoch 11, 86.2%	 loss: 2.563 acc@1: 48.44 mrr: 59.77, ndcg: 63.60, took: 1.26s
Epoch 11, 94.8%	 loss: 2.666 acc@1: 45.47 mrr: 57.74, ndcg: 62.60, took: 1.34s
Validation - loss: 4.4832, acc@1: 40.58%, f1: 31.59%, mrr: 50.66%, ndcg: 54.15%
Current learning rate: 0.000171

=== Epoch 12 ===
Epoch 12, 8.6%	 loss: 2.552 acc@1: 44.84 mrr: 58.43, ndcg: 63.50, took: 1.13s
Epoch 12, 17.2%	 loss: 2.542 acc@1: 45.47 mrr: 59.38, ndcg: 64.42, took: 1.17s
Epoch 12, 25.9%	 loss: 2.456 acc@1: 47.97 mrr: 60.95, ndcg: 65.84, took: 1.16s
Epoch 12, 34.5%	 loss: 2.557 acc@1: 45.31 mrr: 58.33, ndcg: 63.14, took: 1.29s
Epoch 12, 43.1%	 loss: 2.593 acc@1: 45.47 mrr: 58.07, ndcg: 62.87, took: 1.54s
Epoch 12, 51.7%	 loss: 2.378 acc@1: 50.31 mrr: 62.19, ndcg: 66.37, took: 1.52s
Epoch 12, 60.3%	 loss: 2.494 acc@1: 49.38 mrr: 60.53, ndcg: 64.83, took: 1.40s
Epoch 12, 69.0%	 loss: 2.411 acc@1: 48.44 mrr: 61.36, ndcg: 66.04, took: 1.36s
Epoch 12, 77.6%	 loss: 2.292 acc@1: 50.78 mrr: 64.03, ndcg: 68.63, took: 1.25s
Epoch 12, 86.2%	 loss: 2.325 acc@1: 51.56 mrr: 63.13, ndcg: 66.99, took: 1.18s
Epoch 12, 94.8%	 loss: 2.445 acc@1: 48.91 mrr: 61.28, ndcg: 65.79, took: 1.27s
Validation - loss: 4.4670, acc@1: 40.40%, f1: 31.71%, mrr: 50.53%, ndcg: 54.09%
Current learning rate: 0.000171

=== Epoch 13 ===
Epoch 13, 8.6%	 loss: 2.485 acc@1: 45.62 mrr: 59.31, ndcg: 63.81, took: 1.26s
Epoch 13, 17.2%	 loss: 2.364 acc@1: 52.34 mrr: 63.05, ndcg: 67.10, took: 1.21s
Epoch 13, 25.9%	 loss: 2.343 acc@1: 49.06 mrr: 61.87, ndcg: 66.21, took: 1.11s
Epoch 13, 34.5%	 loss: 2.428 acc@1: 47.50 mrr: 60.46, ndcg: 65.11, took: 1.18s
Epoch 13, 43.1%	 loss: 2.311 acc@1: 49.84 mrr: 62.77, ndcg: 67.76, took: 1.24s
Epoch 13, 51.7%	 loss: 2.471 acc@1: 47.50 mrr: 60.28, ndcg: 65.45, took: 1.34s
Epoch 13, 60.3%	 loss: 2.363 acc@1: 50.31 mrr: 62.14, ndcg: 66.50, took: 1.42s
Epoch 13, 69.0%	 loss: 2.341 acc@1: 48.12 mrr: 61.34, ndcg: 66.22, took: 1.43s
Epoch 13, 77.6%	 loss: 2.372 acc@1: 48.28 mrr: 61.10, ndcg: 65.85, took: 1.32s
Epoch 13, 86.2%	 loss: 2.313 acc@1: 51.56 mrr: 63.07, ndcg: 67.40, took: 1.23s
Epoch 13, 94.8%	 loss: 2.436 acc@1: 47.97 mrr: 60.87, ndcg: 65.53, took: 1.24s
Validation - loss: 4.4876, acc@1: 40.58%, f1: 31.94%, mrr: 50.64%, ndcg: 54.24%
Current learning rate: 0.000171

=== Epoch 14 ===
Epoch 14, 8.6%	 loss: 2.300 acc@1: 51.09 mrr: 63.09, ndcg: 67.60, took: 1.33s
Epoch 14, 17.2%	 loss: 2.439 acc@1: 47.03 mrr: 59.88, ndcg: 64.64, took: 1.38s
Epoch 14, 25.9%	 loss: 2.296 acc@1: 50.62 mrr: 63.09, ndcg: 67.87, took: 1.42s
Epoch 14, 34.5%	 loss: 2.412 acc@1: 48.44 mrr: 60.80, ndcg: 65.02, took: 1.25s
Epoch 14, 43.1%	 loss: 2.354 acc@1: 49.84 mrr: 62.31, ndcg: 67.35, took: 1.25s
Epoch 14, 51.7%	 loss: 2.304 acc@1: 51.41 mrr: 64.01, ndcg: 68.52, took: 1.33s
Epoch 14, 60.3%	 loss: 2.416 acc@1: 47.81 mrr: 60.38, ndcg: 64.98, took: 1.11s
Epoch 14, 69.0%	 loss: 2.246 acc@1: 51.88 mrr: 63.77, ndcg: 68.20, took: 1.34s
Epoch 14, 77.6%	 loss: 2.435 acc@1: 49.38 mrr: 61.15, ndcg: 65.70, took: 1.27s
Epoch 14, 86.2%	 loss: 2.305 acc@1: 51.25 mrr: 63.33, ndcg: 67.60, took: 1.29s
Epoch 14, 94.8%	 loss: 2.423 acc@1: 49.22 mrr: 61.06, ndcg: 65.63, took: 1.14s
Validation - loss: 4.4876, acc@1: 40.58%, f1: 32.14%, mrr: 50.64%, ndcg: 54.20%
Current learning rate: 0.000171

=== Epoch 15 ===
Epoch 15, 8.6%	 loss: 2.283 acc@1: 51.41 mrr: 63.25, ndcg: 67.91, took: 1.28s
Epoch 15, 17.2%	 loss: 2.304 acc@1: 49.38 mrr: 62.01, ndcg: 66.89, took: 1.42s
Epoch 15, 25.9%	 loss: 2.403 acc@1: 48.75 mrr: 61.28, ndcg: 66.31, took: 1.36s
Epoch 15, 34.5%	 loss: 2.346 acc@1: 49.84 mrr: 62.22, ndcg: 66.77, took: 1.49s
Epoch 15, 43.1%	 loss: 2.405 acc@1: 47.50 mrr: 59.81, ndcg: 64.96, took: 1.51s
Epoch 15, 51.7%	 loss: 2.190 acc@1: 50.31 mrr: 63.59, ndcg: 68.53, took: 1.42s
Epoch 15, 60.3%	 loss: 2.365 acc@1: 49.53 mrr: 62.00, ndcg: 66.31, took: 1.39s
Epoch 15, 69.0%	 loss: 2.317 acc@1: 52.19 mrr: 63.77, ndcg: 68.21, took: 1.33s
Epoch 15, 77.6%	 loss: 2.211 acc@1: 55.94 mrr: 66.26, ndcg: 70.30, took: 1.28s
Epoch 15, 86.2%	 loss: 2.159 acc@1: 51.56 mrr: 64.96, ndcg: 69.57, took: 1.20s
Epoch 15, 94.8%	 loss: 2.420 acc@1: 49.84 mrr: 61.74, ndcg: 66.35, took: 1.25s
Validation - loss: 4.5017, acc@1: 40.91%, f1: 32.57%, mrr: 50.81%, ndcg: 54.39%
Current learning rate: 0.000017

=== Epoch 16 ===
Epoch 16, 8.6%	 loss: 2.588 acc@1: 43.59 mrr: 57.35, ndcg: 61.73, took: 1.19s
Epoch 16, 17.2%	 loss: 2.516 acc@1: 47.66 mrr: 59.90, ndcg: 64.26, took: 1.38s
Epoch 16, 25.9%	 loss: 2.514 acc@1: 48.44 mrr: 60.84, ndcg: 65.27, took: 1.38s
Epoch 16, 34.5%	 loss: 2.338 acc@1: 50.94 mrr: 63.25, ndcg: 67.52, took: 1.43s
Epoch 16, 43.1%	 loss: 2.555 acc@1: 46.72 mrr: 59.39, ndcg: 63.82, took: 1.48s
Epoch 16, 51.7%	 loss: 2.482 acc@1: 47.97 mrr: 60.26, ndcg: 64.80, took: 1.53s
Epoch 16, 60.3%	 loss: 2.583 acc@1: 46.72 mrr: 59.01, ndcg: 63.74, took: 1.37s
Epoch 16, 69.0%	 loss: 2.616 acc@1: 45.94 mrr: 58.28, ndcg: 62.75, took: 1.42s
Epoch 16, 77.6%	 loss: 2.438 acc@1: 48.75 mrr: 60.85, ndcg: 65.26, took: 1.25s
Epoch 16, 86.2%	 loss: 2.684 acc@1: 42.97 mrr: 56.51, ndcg: 61.31, took: 1.24s
Epoch 16, 94.8%	 loss: 2.477 acc@1: 47.97 mrr: 60.51, ndcg: 64.82, took: 1.19s
Validation - loss: 4.4295, acc@1: 40.76%, f1: 31.90%, mrr: 50.72%, ndcg: 54.20%
Current learning rate: 0.000017

=== Epoch 17 ===
Epoch 17, 8.6%	 loss: 2.649 acc@1: 45.78 mrr: 58.17, ndcg: 62.72, took: 1.04s
Epoch 17, 17.2%	 loss: 2.558 acc@1: 46.25 mrr: 58.45, ndcg: 63.00, took: 1.11s
Epoch 17, 25.9%	 loss: 2.491 acc@1: 46.25 mrr: 59.40, ndcg: 64.21, took: 1.12s
Epoch 17, 34.5%	 loss: 2.477 acc@1: 49.38 mrr: 61.25, ndcg: 65.39, took: 1.44s
Epoch 17, 43.1%	 loss: 2.487 acc@1: 47.66 mrr: 60.33, ndcg: 65.15, took: 1.56s
Epoch 17, 51.7%	 loss: 2.494 acc@1: 45.94 mrr: 59.66, ndcg: 64.44, took: 1.60s
Epoch 17, 60.3%	 loss: 2.354 acc@1: 51.09 mrr: 63.09, ndcg: 67.11, took: 1.54s
Epoch 17, 69.0%	 loss: 2.566 acc@1: 47.03 mrr: 59.63, ndcg: 64.07, took: 1.44s
Epoch 17, 77.6%	 loss: 2.522 acc@1: 46.25 mrr: 59.39, ndcg: 64.07, took: 1.50s
Epoch 17, 86.2%	 loss: 2.441 acc@1: 47.97 mrr: 60.19, ndcg: 64.85, took: 1.30s
Epoch 17, 94.8%	 loss: 2.716 acc@1: 43.59 mrr: 56.43, ndcg: 61.01, took: 1.26s
Validation - loss: 4.4494, acc@1: 40.58%, f1: 31.76%, mrr: 50.67%, ndcg: 54.18%
Current learning rate: 0.000017

=== Epoch 18 ===
Epoch 18, 8.6%	 loss: 2.457 acc@1: 48.59 mrr: 60.77, ndcg: 64.91, took: 1.24s
Epoch 18, 17.2%	 loss: 2.472 acc@1: 50.00 mrr: 61.09, ndcg: 64.91, took: 1.10s
Epoch 18, 25.9%	 loss: 2.404 acc@1: 50.78 mrr: 62.66, ndcg: 66.68, took: 1.06s
Epoch 18, 34.5%	 loss: 2.637 acc@1: 44.22 mrr: 57.34, ndcg: 62.17, took: 1.13s
Epoch 18, 43.1%	 loss: 2.352 acc@1: 50.00 mrr: 61.99, ndcg: 66.45, took: 1.21s
Epoch 18, 51.7%	 loss: 2.590 acc@1: 45.62 mrr: 58.52, ndcg: 63.16, took: 1.48s
Epoch 18, 60.3%	 loss: 2.419 acc@1: 47.50 mrr: 60.29, ndcg: 64.98, took: 1.56s
Epoch 18, 69.0%	 loss: 2.484 acc@1: 49.84 mrr: 61.05, ndcg: 65.34, took: 1.59s
Epoch 18, 77.6%	 loss: 2.584 acc@1: 46.41 mrr: 58.83, ndcg: 63.35, took: 1.58s
Epoch 18, 86.2%	 loss: 2.479 acc@1: 48.44 mrr: 60.75, ndcg: 65.21, took: 1.55s
Epoch 18, 94.8%	 loss: 2.621 acc@1: 44.84 mrr: 57.87, ndcg: 62.11, took: 1.39s
Validation - loss: 4.4295, acc@1: 40.85%, f1: 31.74%, mrr: 50.77%, ndcg: 54.23%
Current learning rate: 0.000017

=== Epoch 19 ===
Epoch 19, 8.6%	 loss: 2.599 acc@1: 48.44 mrr: 59.61, ndcg: 63.61, took: 1.49s
Epoch 19, 17.2%	 loss: 2.526 acc@1: 46.88 mrr: 59.57, ndcg: 64.05, took: 1.41s
Epoch 19, 25.9%	 loss: 2.516 acc@1: 46.88 mrr: 59.18, ndcg: 63.86, took: 1.08s
Epoch 19, 34.5%	 loss: 2.317 acc@1: 51.72 mrr: 64.06, ndcg: 68.37, took: 1.20s
Epoch 19, 43.1%	 loss: 2.475 acc@1: 48.91 mrr: 61.04, ndcg: 65.19, took: 1.12s
Epoch 19, 51.7%	 loss: 2.529 acc@1: 45.62 mrr: 58.56, ndcg: 63.69, took: 1.17s
Epoch 19, 60.3%	 loss: 2.501 acc@1: 48.28 mrr: 59.96, ndcg: 64.42, took: 1.29s
Epoch 19, 69.0%	 loss: 2.348 acc@1: 47.50 mrr: 61.45, ndcg: 66.48, took: 1.50s
Epoch 19, 77.6%	 loss: 2.660 acc@1: 43.59 mrr: 56.84, ndcg: 61.52, took: 1.39s
Epoch 19, 86.2%	 loss: 2.531 acc@1: 46.72 mrr: 59.19, ndcg: 63.61, took: 1.57s
Epoch 19, 94.8%	 loss: 2.409 acc@1: 48.28 mrr: 61.46, ndcg: 66.38, took: 1.46s
Validation - loss: 4.4325, acc@1: 40.37%, f1: 31.37%, mrr: 50.51%, ndcg: 54.12%
Current learning rate: 0.000017

=== Epoch 20 ===
Epoch 20, 8.6%	 loss: 2.453 acc@1: 48.28 mrr: 60.84, ndcg: 65.80, took: 1.38s
Epoch 20, 17.2%	 loss: 2.421 acc@1: 49.84 mrr: 61.45, ndcg: 65.55, took: 1.51s
Epoch 20, 25.9%	 loss: 2.536 acc@1: 49.69 mrr: 60.75, ndcg: 64.73, took: 1.51s
Epoch 20, 34.5%	 loss: 2.512 acc@1: 49.06 mrr: 60.67, ndcg: 64.78, took: 1.33s
Epoch 20, 43.1%	 loss: 2.421 acc@1: 48.28 mrr: 61.03, ndcg: 65.48, took: 1.25s
Epoch 20, 51.7%	 loss: 2.498 acc@1: 47.03 mrr: 59.66, ndcg: 64.09, took: 1.30s
Epoch 20, 60.3%	 loss: 2.407 acc@1: 48.28 mrr: 61.27, ndcg: 65.98, took: 1.33s
Epoch 20, 69.0%	 loss: 2.514 acc@1: 45.78 mrr: 59.20, ndcg: 63.86, took: 1.47s
Epoch 20, 77.6%	 loss: 2.477 acc@1: 45.94 mrr: 59.22, ndcg: 63.81, took: 1.37s
Epoch 20, 86.2%	 loss: 2.601 acc@1: 43.59 mrr: 57.32, ndcg: 62.10, took: 1.32s
Epoch 20, 94.8%	 loss: 2.504 acc@1: 46.56 mrr: 59.56, ndcg: 64.34, took: 1.24s
Validation - loss: 4.4574, acc@1: 40.49%, f1: 31.37%, mrr: 50.60%, ndcg: 54.13%
Training finished.	 Time: 412.14s.	 acc@1: 40.82%

=== Test Results ===
Test Results:
  acc@1: 29.53%
  acc@5: 54.43%
  acc@10: 58.85%
  mrr: 40.67%
  ndcg: 44.81%
  f1: 21.02%

=== Training Complete ===
