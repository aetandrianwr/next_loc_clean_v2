Training LSTM model
Dataset: geolife
Config: /data/next_loc_clean_v2/config/ht_optuna/optuna_LSTM_geolife_prev7_t5_20260101_091514_7d9d4e15.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=232, val=105, test=110
Total trainable parameters: 104035

=== Epoch 1 ===
Epoch 1, 8.6%	 loss: 7.301 acc@1: 0.00 mrr: 0.37, ndcg: 0.05, took: 1.74s
Epoch 1, 17.2%	 loss: 7.279 acc@1: 0.16 mrr: 0.54, ndcg: 0.27, took: 1.41s
Epoch 1, 25.9%	 loss: 7.237 acc@1: 0.16 mrr: 0.56, ndcg: 0.16, took: 2.03s
Epoch 1, 34.5%	 loss: 7.176 acc@1: 0.31 mrr: 0.97, ndcg: 0.75, took: 2.14s
Epoch 1, 43.1%	 loss: 7.113 acc@1: 1.25 mrr: 2.33, ndcg: 2.38, took: 2.17s
Epoch 1, 51.7%	 loss: 7.000 acc@1: 1.72 mrr: 3.00, ndcg: 3.02, took: 2.07s
Epoch 1, 60.3%	 loss: 6.910 acc@1: 3.28 mrr: 5.23, ndcg: 5.32, took: 2.20s
Epoch 1, 69.0%	 loss: 6.665 acc@1: 12.19 mrr: 14.70, ndcg: 15.47, took: 2.23s
Epoch 1, 77.6%	 loss: 6.505 acc@1: 12.97 mrr: 15.87, ndcg: 16.52, took: 2.11s
Epoch 1, 86.2%	 loss: 6.298 acc@1: 11.72 mrr: 17.36, ndcg: 18.87, took: 2.16s
Epoch 1, 94.8%	 loss: 6.067 acc@1: 13.75 mrr: 20.43, ndcg: 22.18, took: 2.06s
Validation - loss: 5.7577, acc@1: 15.48%, f1: 6.13%, mrr: 24.61%, ndcg: 27.12%
Current learning rate: 0.001000

=== Epoch 2 ===
Epoch 2, 8.6%	 loss: 5.620 acc@1: 12.19 mrr: 23.53, ndcg: 27.28, took: 0.99s
Epoch 2, 17.2%	 loss: 5.448 acc@1: 15.00 mrr: 25.91, ndcg: 30.12, took: 1.01s
Epoch 2, 25.9%	 loss: 5.091 acc@1: 18.91 mrr: 30.59, ndcg: 35.51, took: 1.17s
Epoch 2, 34.5%	 loss: 4.780 acc@1: 21.25 mrr: 34.26, ndcg: 39.80, took: 1.37s
Epoch 2, 43.1%	 loss: 4.645 acc@1: 25.47 mrr: 36.33, ndcg: 41.04, took: 2.00s
Epoch 2, 51.7%	 loss: 4.602 acc@1: 24.84 mrr: 35.89, ndcg: 40.41, took: 2.16s
Epoch 2, 60.3%	 loss: 4.336 acc@1: 27.66 mrr: 38.81, ndcg: 43.24, took: 2.11s
Epoch 2, 69.0%	 loss: 4.322 acc@1: 26.72 mrr: 38.11, ndcg: 42.32, took: 2.13s
Epoch 2, 77.6%	 loss: 3.978 acc@1: 29.06 mrr: 42.39, ndcg: 47.05, took: 2.04s
Epoch 2, 86.2%	 loss: 3.944 acc@1: 32.03 mrr: 44.08, ndcg: 48.57, took: 2.12s
Epoch 2, 94.8%	 loss: 3.868 acc@1: 33.75 mrr: 45.44, ndcg: 49.53, took: 2.09s
Validation - loss: 4.4331, acc@1: 34.97%, f1: 21.72%, mrr: 45.60%, ndcg: 49.06%
Current learning rate: 0.002000

=== Epoch 3 ===
Epoch 3, 8.6%	 loss: 3.607 acc@1: 31.88 mrr: 45.34, ndcg: 50.64, took: 1.81s
Epoch 3, 17.2%	 loss: 3.716 acc@1: 30.78 mrr: 44.08, ndcg: 49.05, took: 1.41s
Epoch 3, 25.9%	 loss: 3.732 acc@1: 32.66 mrr: 44.99, ndcg: 49.56, took: 1.07s
Epoch 3, 34.5%	 loss: 3.528 acc@1: 33.44 mrr: 47.24, ndcg: 52.38, took: 1.06s
Epoch 3, 43.1%	 loss: 3.791 acc@1: 31.88 mrr: 44.43, ndcg: 48.75, took: 1.14s
Epoch 3, 51.7%	 loss: 3.574 acc@1: 32.97 mrr: 46.73, ndcg: 51.30, took: 1.28s
Epoch 3, 60.3%	 loss: 3.496 acc@1: 33.59 mrr: 47.73, ndcg: 52.32, took: 1.83s
Epoch 3, 69.0%	 loss: 3.379 acc@1: 39.22 mrr: 51.64, ndcg: 56.11, took: 2.05s
Epoch 3, 77.6%	 loss: 3.494 acc@1: 33.59 mrr: 47.95, ndcg: 52.72, took: 2.07s
Epoch 3, 86.2%	 loss: 3.478 acc@1: 33.75 mrr: 47.98, ndcg: 53.44, took: 2.12s
Epoch 3, 94.8%	 loss: 3.380 acc@1: 37.81 mrr: 51.21, ndcg: 55.75, took: 2.16s
Validation - loss: 4.3768, acc@1: 34.91%, f1: 20.95%, mrr: 46.89%, ndcg: 50.74%
Current learning rate: 0.001958

=== Epoch 4 ===
Epoch 4, 8.6%	 loss: 3.088 acc@1: 36.41 mrr: 51.31, ndcg: 56.84, took: 2.25s
Epoch 4, 17.2%	 loss: 3.285 acc@1: 36.41 mrr: 49.58, ndcg: 53.99, took: 2.08s
Epoch 4, 25.9%	 loss: 3.261 acc@1: 35.62 mrr: 49.44, ndcg: 53.93, took: 2.01s
Epoch 4, 34.5%	 loss: 3.190 acc@1: 35.47 mrr: 49.80, ndcg: 54.78, took: 1.55s
Epoch 4, 43.1%	 loss: 3.142 acc@1: 37.34 mrr: 51.21, ndcg: 56.02, took: 1.26s
Epoch 4, 51.7%	 loss: 3.273 acc@1: 32.66 mrr: 47.93, ndcg: 52.87, took: 1.22s
Epoch 4, 60.3%	 loss: 3.194 acc@1: 34.22 mrr: 49.44, ndcg: 54.57, took: 1.32s
Epoch 4, 69.0%	 loss: 3.242 acc@1: 34.38 mrr: 49.28, ndcg: 54.50, took: 1.62s
Epoch 4, 77.6%	 loss: 3.023 acc@1: 35.62 mrr: 51.79, ndcg: 57.23, took: 1.99s
Epoch 4, 86.2%	 loss: 3.104 acc@1: 32.97 mrr: 49.33, ndcg: 54.78, took: 2.11s
Epoch 4, 94.8%	 loss: 3.251 acc@1: 33.28 mrr: 48.81, ndcg: 53.92, took: 2.11s
Validation - loss: 4.3706, acc@1: 35.03%, f1: 22.70%, mrr: 47.32%, ndcg: 51.52%
Current learning rate: 0.001917

=== Epoch 5 ===
Epoch 5, 8.6%	 loss: 3.021 acc@1: 35.62 mrr: 50.48, ndcg: 55.24, took: 2.05s
Epoch 5, 17.2%	 loss: 2.997 acc@1: 34.84 mrr: 50.49, ndcg: 56.15, took: 2.03s
Epoch 5, 25.9%	 loss: 2.974 acc@1: 32.81 mrr: 50.11, ndcg: 55.74, took: 1.94s
Epoch 5, 34.5%	 loss: 2.916 acc@1: 37.19 mrr: 51.89, ndcg: 57.29, took: 1.86s
Epoch 5, 43.1%	 loss: 2.911 acc@1: 35.31 mrr: 52.03, ndcg: 57.33, took: 1.92s
Epoch 5, 51.7%	 loss: 3.008 acc@1: 34.22 mrr: 49.81, ndcg: 55.37, took: 1.38s
Epoch 5, 60.3%	 loss: 3.043 acc@1: 35.94 mrr: 50.47, ndcg: 55.58, took: 1.27s
Epoch 5, 69.0%	 loss: 2.989 acc@1: 40.00 mrr: 53.17, ndcg: 57.46, took: 1.25s
Epoch 5, 77.6%	 loss: 2.814 acc@1: 40.00 mrr: 54.63, ndcg: 59.55, took: 1.31s
Epoch 5, 86.2%	 loss: 2.975 acc@1: 35.47 mrr: 51.05, ndcg: 56.53, took: 1.85s
Epoch 5, 94.8%	 loss: 2.947 acc@1: 34.38 mrr: 51.01, ndcg: 56.61, took: 1.95s
Validation - loss: 4.4026, acc@1: 35.21%, f1: 22.59%, mrr: 47.67%, ndcg: 51.87%
Current learning rate: 0.001875

=== Epoch 6 ===
Epoch 6, 8.6%	 loss: 2.731 acc@1: 37.34 mrr: 53.81, ndcg: 59.64, took: 2.28s
Epoch 6, 17.2%	 loss: 2.658 acc@1: 37.50 mrr: 54.04, ndcg: 59.88, took: 2.22s
Epoch 6, 25.9%	 loss: 2.623 acc@1: 39.53 mrr: 55.90, ndcg: 61.66, took: 1.97s
Epoch 6, 34.5%	 loss: 2.871 acc@1: 35.00 mrr: 50.90, ndcg: 55.72, took: 2.15s
Epoch 6, 43.1%	 loss: 2.842 acc@1: 35.78 mrr: 52.14, ndcg: 57.69, took: 1.95s
Epoch 6, 51.7%	 loss: 2.918 acc@1: 30.78 mrr: 48.35, ndcg: 54.59, took: 2.02s
Epoch 6, 60.3%	 loss: 2.838 acc@1: 35.94 mrr: 51.62, ndcg: 56.98, took: 1.44s
Epoch 6, 69.0%	 loss: 2.828 acc@1: 36.56 mrr: 52.55, ndcg: 58.27, took: 1.31s
Epoch 6, 77.6%	 loss: 2.811 acc@1: 33.59 mrr: 51.35, ndcg: 57.42, took: 1.07s
Epoch 6, 86.2%	 loss: 2.822 acc@1: 37.50 mrr: 52.82, ndcg: 58.09, took: 1.17s
Epoch 6, 94.8%	 loss: 2.723 acc@1: 34.06 mrr: 51.49, ndcg: 57.36, took: 1.26s
Validation - loss: 4.4890, acc@1: 34.73%, f1: 23.31%, mrr: 47.62%, ndcg: 52.00%
Current learning rate: 0.001833

=== Epoch 7 ===
Epoch 7, 8.6%	 loss: 2.520 acc@1: 37.97 mrr: 55.09, ndcg: 61.19, took: 2.18s
Epoch 7, 17.2%	 loss: 2.663 acc@1: 36.72 mrr: 53.13, ndcg: 59.10, took: 2.24s
Epoch 7, 25.9%	 loss: 2.758 acc@1: 35.16 mrr: 51.91, ndcg: 57.59, took: 1.97s
Epoch 7, 34.5%	 loss: 2.645 acc@1: 40.16 mrr: 55.38, ndcg: 60.38, took: 2.01s
Epoch 7, 43.1%	 loss: 2.651 acc@1: 37.50 mrr: 53.12, ndcg: 59.35, took: 2.05s
Epoch 7, 51.7%	 loss: 2.677 acc@1: 37.81 mrr: 53.33, ndcg: 58.34, took: 2.02s
Epoch 7, 60.3%	 loss: 2.649 acc@1: 37.81 mrr: 53.76, ndcg: 59.00, took: 2.10s
Epoch 7, 69.0%	 loss: 2.753 acc@1: 35.94 mrr: 52.32, ndcg: 57.64, took: 1.92s
Epoch 7, 77.6%	 loss: 2.707 acc@1: 35.94 mrr: 53.03, ndcg: 58.78, took: 1.50s
Epoch 7, 86.2%	 loss: 2.647 acc@1: 36.56 mrr: 53.44, ndcg: 58.96, took: 1.31s
Epoch 7, 94.8%	 loss: 2.675 acc@1: 39.53 mrr: 54.85, ndcg: 60.20, took: 1.15s
Validation - loss: 4.5341, acc@1: 30.83%, f1: 23.18%, mrr: 46.08%, ndcg: 51.04%
Current learning rate: 0.001792

=== Epoch 8 ===
Epoch 8, 8.6%	 loss: 2.357 acc@1: 40.62 mrr: 57.13, ndcg: 63.50, took: 2.27s
Epoch 8, 17.2%	 loss: 2.385 acc@1: 38.12 mrr: 56.03, ndcg: 62.50, took: 2.28s
Epoch 8, 25.9%	 loss: 2.490 acc@1: 38.12 mrr: 54.85, ndcg: 61.04, took: 2.22s
Epoch 8, 34.5%	 loss: 2.448 acc@1: 38.44 mrr: 55.38, ndcg: 61.23, took: 2.11s
Epoch 8, 43.1%	 loss: 2.545 acc@1: 35.94 mrr: 53.66, ndcg: 59.97, took: 2.00s
Epoch 8, 51.7%	 loss: 2.537 acc@1: 38.44 mrr: 55.06, ndcg: 60.84, took: 2.02s
Epoch 8, 60.3%	 loss: 2.609 acc@1: 35.78 mrr: 53.18, ndcg: 59.35, took: 1.98s
Epoch 8, 69.0%	 loss: 2.659 acc@1: 34.69 mrr: 52.30, ndcg: 58.52, took: 2.10s
Epoch 8, 77.6%	 loss: 2.569 acc@1: 37.81 mrr: 54.32, ndcg: 60.37, took: 2.12s
Epoch 8, 86.2%	 loss: 2.698 acc@1: 34.84 mrr: 51.79, ndcg: 57.87, took: 1.98s
Epoch 8, 94.8%	 loss: 2.539 acc@1: 40.94 mrr: 56.26, ndcg: 61.74, took: 1.48s
Validation - loss: 4.5488, acc@1: 35.33%, f1: 24.77%, mrr: 48.10%, ndcg: 52.35%
Current learning rate: 0.001750

=== Epoch 9 ===
Epoch 9, 8.6%	 loss: 2.295 acc@1: 39.69 mrr: 57.11, ndcg: 64.15, took: 1.94s
Epoch 9, 17.2%	 loss: 2.333 acc@1: 39.38 mrr: 57.22, ndcg: 64.17, took: 2.05s
Epoch 9, 25.9%	 loss: 2.512 acc@1: 37.03 mrr: 54.59, ndcg: 60.88, took: 2.13s
Epoch 9, 34.5%	 loss: 2.425 acc@1: 39.53 mrr: 55.84, ndcg: 61.95, took: 2.09s
Epoch 9, 43.1%	 loss: 2.440 acc@1: 38.12 mrr: 54.97, ndcg: 61.32, took: 2.11s
Epoch 9, 51.7%	 loss: 2.499 acc@1: 37.03 mrr: 54.05, ndcg: 60.38, took: 2.03s
Epoch 9, 60.3%	 loss: 2.468 acc@1: 37.66 mrr: 54.80, ndcg: 60.95, took: 1.99s
Epoch 9, 69.0%	 loss: 2.425 acc@1: 38.75 mrr: 55.65, ndcg: 61.53, took: 1.96s
Epoch 9, 77.6%	 loss: 2.451 acc@1: 37.50 mrr: 54.97, ndcg: 61.30, took: 2.04s
Epoch 9, 86.2%	 loss: 2.499 acc@1: 38.75 mrr: 55.16, ndcg: 61.09, took: 2.24s
Epoch 9, 94.8%	 loss: 2.468 acc@1: 38.44 mrr: 55.47, ndcg: 61.51, took: 2.15s
Validation - loss: 4.5891, acc@1: 35.33%, f1: 25.95%, mrr: 48.15%, ndcg: 52.37%
Current learning rate: 0.000171

=== Epoch 10 ===
Epoch 10, 8.6%	 loss: 2.877 acc@1: 37.81 mrr: 53.06, ndcg: 57.61, took: 1.68s
Epoch 10, 17.2%	 loss: 2.869 acc@1: 37.81 mrr: 52.94, ndcg: 58.51, took: 1.95s
Epoch 10, 25.9%	 loss: 2.978 acc@1: 36.09 mrr: 50.80, ndcg: 55.82, took: 1.89s
Epoch 10, 34.5%	 loss: 2.950 acc@1: 36.41 mrr: 51.72, ndcg: 56.56, took: 1.86s
Epoch 10, 43.1%	 loss: 2.867 acc@1: 33.75 mrr: 50.62, ndcg: 56.43, took: 2.09s
Epoch 10, 51.7%	 loss: 2.941 acc@1: 35.94 mrr: 51.31, ndcg: 56.47, took: 2.10s
Epoch 10, 60.3%	 loss: 2.799 acc@1: 38.28 mrr: 53.69, ndcg: 58.75, took: 2.15s
Epoch 10, 69.0%	 loss: 3.174 acc@1: 32.66 mrr: 47.43, ndcg: 52.82, took: 2.09s
Epoch 10, 77.6%	 loss: 2.954 acc@1: 37.03 mrr: 51.68, ndcg: 56.48, took: 2.35s
Epoch 10, 86.2%	 loss: 2.742 acc@1: 40.00 mrr: 54.53, ndcg: 59.33, took: 2.11s
Epoch 10, 94.8%	 loss: 2.914 acc@1: 38.44 mrr: 52.81, ndcg: 57.46, took: 2.05s
Validation - loss: 4.3477, acc@1: 35.45%, f1: 22.77%, mrr: 47.62%, ndcg: 51.77%
Current learning rate: 0.000171

=== Epoch 11 ===
Epoch 11, 8.6%	 loss: 2.956 acc@1: 36.41 mrr: 51.32, ndcg: 56.33, took: 1.26s
Epoch 11, 17.2%	 loss: 2.988 acc@1: 36.25 mrr: 51.06, ndcg: 55.90, took: 1.34s
Epoch 11, 25.9%	 loss: 2.799 acc@1: 36.72 mrr: 52.78, ndcg: 58.04, took: 1.83s
Epoch 11, 34.5%	 loss: 2.816 acc@1: 39.69 mrr: 53.87, ndcg: 58.72, took: 1.96s
Epoch 11, 43.1%	 loss: 2.876 acc@1: 34.69 mrr: 50.68, ndcg: 56.59, took: 2.03s
Epoch 11, 51.7%	 loss: 2.855 acc@1: 38.28 mrr: 53.00, ndcg: 58.20, took: 1.97s
Epoch 11, 60.3%	 loss: 2.908 acc@1: 36.25 mrr: 51.89, ndcg: 57.07, took: 2.09s
Epoch 11, 69.0%	 loss: 2.831 acc@1: 37.81 mrr: 52.97, ndcg: 58.33, took: 2.20s
Epoch 11, 77.6%	 loss: 2.864 acc@1: 36.09 mrr: 51.78, ndcg: 57.22, took: 2.09s
Epoch 11, 86.2%	 loss: 2.712 acc@1: 39.84 mrr: 55.46, ndcg: 60.54, took: 2.08s
Epoch 11, 94.8%	 loss: 2.918 acc@1: 34.69 mrr: 50.59, ndcg: 55.96, took: 2.03s
Validation - loss: 4.3542, acc@1: 35.39%, f1: 22.73%, mrr: 47.72%, ndcg: 51.91%
Current learning rate: 0.000171

=== Epoch 12 ===
Epoch 12, 8.6%	 loss: 2.958 acc@1: 37.03 mrr: 51.86, ndcg: 56.98, took: 1.32s
Epoch 12, 17.2%	 loss: 2.706 acc@1: 39.53 mrr: 54.70, ndcg: 60.27, took: 1.26s
Epoch 12, 25.9%	 loss: 2.819 acc@1: 39.38 mrr: 54.11, ndcg: 58.85, took: 1.26s
Epoch 12, 34.5%	 loss: 2.797 acc@1: 38.28 mrr: 53.75, ndcg: 58.90, took: 1.40s
Epoch 12, 43.1%	 loss: 2.859 acc@1: 36.25 mrr: 52.16, ndcg: 57.57, took: 1.77s
Epoch 12, 51.7%	 loss: 2.916 acc@1: 35.31 mrr: 51.24, ndcg: 56.60, took: 1.88s
Epoch 12, 60.3%	 loss: 2.829 acc@1: 37.34 mrr: 52.61, ndcg: 57.63, took: 1.83s
Epoch 12, 69.0%	 loss: 2.721 acc@1: 37.97 mrr: 54.11, ndcg: 59.59, took: 1.80s
Epoch 12, 77.6%	 loss: 2.905 acc@1: 37.34 mrr: 52.10, ndcg: 57.04, took: 1.98s
Epoch 12, 86.2%	 loss: 2.803 acc@1: 38.28 mrr: 53.14, ndcg: 58.21, took: 1.98s
Epoch 12, 94.8%	 loss: 2.813 acc@1: 34.06 mrr: 51.14, ndcg: 56.87, took: 1.99s
Validation - loss: 4.3697, acc@1: 35.78%, f1: 23.01%, mrr: 47.94%, ndcg: 52.05%
Current learning rate: 0.000171

=== Epoch 13 ===
Epoch 13, 8.6%	 loss: 2.836 acc@1: 39.84 mrr: 54.05, ndcg: 58.79, took: 2.04s
Epoch 13, 17.2%	 loss: 2.807 acc@1: 38.28 mrr: 53.13, ndcg: 58.16, took: 1.68s
Epoch 13, 25.9%	 loss: 2.675 acc@1: 38.28 mrr: 53.69, ndcg: 59.10, took: 1.29s
Epoch 13, 34.5%	 loss: 2.860 acc@1: 37.50 mrr: 52.32, ndcg: 57.49, took: 1.24s
Epoch 13, 43.1%	 loss: 2.828 acc@1: 35.62 mrr: 51.49, ndcg: 57.02, took: 1.23s
Epoch 13, 51.7%	 loss: 2.755 acc@1: 38.91 mrr: 54.60, ndcg: 59.77, took: 1.43s
Epoch 13, 60.3%	 loss: 2.942 acc@1: 33.28 mrr: 50.04, ndcg: 55.68, took: 1.76s
Epoch 13, 69.0%	 loss: 2.867 acc@1: 39.53 mrr: 53.32, ndcg: 57.71, took: 1.87s
Epoch 13, 77.6%	 loss: 2.748 acc@1: 37.97 mrr: 53.72, ndcg: 58.89, took: 1.78s
Epoch 13, 86.2%	 loss: 2.855 acc@1: 36.72 mrr: 52.34, ndcg: 57.47, took: 1.73s
Epoch 13, 94.8%	 loss: 2.809 acc@1: 37.81 mrr: 53.29, ndcg: 58.42, took: 1.72s
Validation - loss: 4.3907, acc@1: 35.57%, f1: 22.97%, mrr: 47.89%, ndcg: 52.04%
Current learning rate: 0.000171

=== Epoch 14 ===
Epoch 14, 8.6%	 loss: 2.844 acc@1: 35.16 mrr: 51.58, ndcg: 57.00, took: 2.17s
Epoch 14, 17.2%	 loss: 2.855 acc@1: 37.50 mrr: 52.44, ndcg: 57.61, took: 2.09s
Epoch 14, 25.9%	 loss: 2.771 acc@1: 37.03 mrr: 53.02, ndcg: 58.42, took: 2.08s
Epoch 14, 34.5%	 loss: 2.607 acc@1: 40.62 mrr: 55.94, ndcg: 61.45, took: 1.89s
Epoch 14, 43.1%	 loss: 2.783 acc@1: 37.19 mrr: 52.80, ndcg: 58.63, took: 1.42s
Epoch 14, 51.7%	 loss: 2.953 acc@1: 32.50 mrr: 49.33, ndcg: 55.26, took: 1.26s
Epoch 14, 60.3%	 loss: 2.888 acc@1: 36.88 mrr: 51.55, ndcg: 56.54, took: 1.23s
Epoch 14, 69.0%	 loss: 2.652 acc@1: 39.22 mrr: 55.14, ndcg: 60.35, took: 1.29s
Epoch 14, 77.6%	 loss: 2.671 acc@1: 39.38 mrr: 55.19, ndcg: 60.28, took: 1.65s
Epoch 14, 86.2%	 loss: 2.892 acc@1: 36.25 mrr: 51.49, ndcg: 56.58, took: 1.75s
Epoch 14, 94.8%	 loss: 2.807 acc@1: 36.25 mrr: 52.34, ndcg: 57.62, took: 1.76s
Validation - loss: 4.3957, acc@1: 35.60%, f1: 22.89%, mrr: 47.93%, ndcg: 52.05%
Current learning rate: 0.000171

=== Epoch 15 ===
Epoch 15, 8.6%	 loss: 2.741 acc@1: 37.81 mrr: 53.62, ndcg: 58.93, took: 2.16s
Epoch 15, 17.2%	 loss: 2.689 acc@1: 39.84 mrr: 54.90, ndcg: 60.06, took: 2.18s
Epoch 15, 25.9%	 loss: 2.779 acc@1: 35.16 mrr: 51.62, ndcg: 57.39, took: 2.15s
Epoch 15, 34.5%	 loss: 2.857 acc@1: 35.16 mrr: 51.34, ndcg: 56.80, took: 2.16s
Epoch 15, 43.1%	 loss: 2.785 acc@1: 36.88 mrr: 52.98, ndcg: 58.25, took: 2.10s
Epoch 15, 51.7%	 loss: 2.776 acc@1: 36.41 mrr: 52.91, ndcg: 58.12, took: 1.92s
Epoch 15, 60.3%	 loss: 2.658 acc@1: 39.84 mrr: 55.35, ndcg: 60.54, took: 1.53s
Epoch 15, 69.0%	 loss: 2.813 acc@1: 39.69 mrr: 54.01, ndcg: 58.86, took: 1.32s
Epoch 15, 77.6%	 loss: 2.775 acc@1: 37.19 mrr: 53.25, ndcg: 58.11, took: 1.20s
Epoch 15, 86.2%	 loss: 2.730 acc@1: 40.94 mrr: 55.03, ndcg: 59.93, took: 1.24s
Epoch 15, 94.8%	 loss: 2.799 acc@1: 37.97 mrr: 53.10, ndcg: 57.97, took: 1.52s
Validation - loss: 4.4157, acc@1: 35.78%, f1: 23.26%, mrr: 47.96%, ndcg: 52.13%
Current learning rate: 0.000017

=== Epoch 16 ===
Epoch 16, 8.6%	 loss: 2.901 acc@1: 35.94 mrr: 51.51, ndcg: 56.89, took: 2.21s
Epoch 16, 17.2%	 loss: 3.110 acc@1: 36.25 mrr: 49.91, ndcg: 54.50, took: 2.25s
Epoch 16, 25.9%	 loss: 2.871 acc@1: 36.72 mrr: 52.10, ndcg: 57.63, took: 2.11s
Epoch 16, 34.5%	 loss: 2.764 acc@1: 36.41 mrr: 53.40, ndcg: 59.01, took: 2.08s
Epoch 16, 43.1%	 loss: 2.755 acc@1: 39.38 mrr: 54.67, ndcg: 59.48, took: 2.08s
Epoch 16, 51.7%	 loss: 2.730 acc@1: 39.22 mrr: 54.77, ndcg: 59.97, took: 2.09s
Epoch 16, 60.3%	 loss: 2.888 acc@1: 38.59 mrr: 52.38, ndcg: 57.29, took: 2.19s
Epoch 16, 69.0%	 loss: 2.919 acc@1: 37.03 mrr: 52.32, ndcg: 57.52, took: 2.02s
Epoch 16, 77.6%	 loss: 2.797 acc@1: 39.69 mrr: 54.05, ndcg: 59.11, took: 1.61s
Epoch 16, 86.2%	 loss: 2.906 acc@1: 37.34 mrr: 52.07, ndcg: 56.87, took: 1.29s
Epoch 16, 94.8%	 loss: 2.930 acc@1: 35.62 mrr: 51.20, ndcg: 56.51, took: 1.22s
Validation - loss: 4.3534, acc@1: 35.24%, f1: 22.59%, mrr: 47.59%, ndcg: 51.78%
Current learning rate: 0.000017

=== Epoch 17 ===
Epoch 17, 8.6%	 loss: 3.034 acc@1: 35.00 mrr: 50.13, ndcg: 55.20, took: 2.00s
Epoch 17, 17.2%	 loss: 2.718 acc@1: 40.00 mrr: 54.84, ndcg: 60.16, took: 2.00s
Epoch 17, 25.9%	 loss: 2.884 acc@1: 37.03 mrr: 52.12, ndcg: 57.31, took: 2.08s
Epoch 17, 34.5%	 loss: 2.702 acc@1: 37.34 mrr: 53.92, ndcg: 59.93, took: 2.20s
Epoch 17, 43.1%	 loss: 2.911 acc@1: 38.59 mrr: 52.68, ndcg: 56.95, took: 2.14s
Epoch 17, 51.7%	 loss: 2.899 acc@1: 34.22 mrr: 50.66, ndcg: 56.01, took: 2.23s
Epoch 17, 60.3%	 loss: 2.748 acc@1: 42.03 mrr: 56.24, ndcg: 61.13, took: 2.10s
Epoch 17, 69.0%	 loss: 2.810 acc@1: 37.97 mrr: 52.83, ndcg: 57.87, took: 2.25s
Epoch 17, 77.6%	 loss: 2.923 acc@1: 35.94 mrr: 51.19, ndcg: 56.44, took: 2.18s
Epoch 17, 86.2%	 loss: 2.854 acc@1: 38.12 mrr: 53.15, ndcg: 58.46, took: 1.75s
Epoch 17, 94.8%	 loss: 2.921 acc@1: 36.09 mrr: 51.42, ndcg: 56.51, took: 1.41s
Validation - loss: 4.3514, acc@1: 35.27%, f1: 22.54%, mrr: 47.63%, ndcg: 51.84%
Current learning rate: 0.000017

=== Epoch 18 ===
Epoch 18, 8.6%	 loss: 2.854 acc@1: 35.94 mrr: 52.08, ndcg: 57.66, took: 1.93s
Epoch 18, 17.2%	 loss: 2.840 acc@1: 39.38 mrr: 54.23, ndcg: 59.24, took: 1.87s
Epoch 18, 25.9%	 loss: 2.823 acc@1: 37.66 mrr: 52.83, ndcg: 57.78, took: 1.83s
Epoch 18, 34.5%	 loss: 2.900 acc@1: 36.09 mrr: 51.46, ndcg: 56.72, took: 1.83s
Epoch 18, 43.1%	 loss: 2.688 acc@1: 40.47 mrr: 55.49, ndcg: 60.75, took: 1.88s
Epoch 18, 51.7%	 loss: 2.759 acc@1: 39.84 mrr: 55.17, ndcg: 60.28, took: 2.02s
Epoch 18, 60.3%	 loss: 2.921 acc@1: 38.91 mrr: 52.71, ndcg: 56.91, took: 2.13s
Epoch 18, 69.0%	 loss: 2.847 acc@1: 37.66 mrr: 52.42, ndcg: 57.47, took: 2.16s
Epoch 18, 77.6%	 loss: 2.747 acc@1: 40.31 mrr: 55.47, ndcg: 60.26, took: 2.11s
Epoch 18, 86.2%	 loss: 2.992 acc@1: 35.94 mrr: 50.94, ndcg: 55.97, took: 2.14s
Epoch 18, 94.8%	 loss: 3.022 acc@1: 33.75 mrr: 49.00, ndcg: 54.41, took: 1.99s
Validation - loss: 4.3687, acc@1: 35.63%, f1: 22.94%, mrr: 47.78%, ndcg: 51.92%
Current learning rate: 0.000017

=== Epoch 19 ===
Epoch 19, 8.6%	 loss: 3.023 acc@1: 32.50 mrr: 48.90, ndcg: 54.08, took: 1.46s
Epoch 19, 17.2%	 loss: 2.719 acc@1: 38.44 mrr: 54.03, ndcg: 59.27, took: 1.83s
Epoch 19, 25.9%	 loss: 2.766 acc@1: 40.31 mrr: 54.78, ndcg: 60.04, took: 2.03s
Epoch 19, 34.5%	 loss: 2.815 acc@1: 40.00 mrr: 54.19, ndcg: 58.84, took: 2.03s
Epoch 19, 43.1%	 loss: 2.957 acc@1: 36.72 mrr: 51.36, ndcg: 56.38, took: 1.87s
Epoch 19, 51.7%	 loss: 3.032 acc@1: 32.50 mrr: 48.70, ndcg: 53.82, took: 2.02s
Epoch 19, 60.3%	 loss: 2.924 acc@1: 36.72 mrr: 51.78, ndcg: 57.05, took: 1.83s
Epoch 19, 69.0%	 loss: 2.703 acc@1: 40.47 mrr: 55.22, ndcg: 60.50, took: 1.87s
Epoch 19, 77.6%	 loss: 2.779 acc@1: 39.22 mrr: 54.35, ndcg: 59.50, took: 1.92s
Epoch 19, 86.2%	 loss: 2.942 acc@1: 33.59 mrr: 50.14, ndcg: 55.85, took: 2.07s
Epoch 19, 94.8%	 loss: 2.806 acc@1: 38.12 mrr: 53.01, ndcg: 57.89, took: 2.05s
Validation - loss: 4.3649, acc@1: 35.42%, f1: 22.65%, mrr: 47.74%, ndcg: 51.88%
Current learning rate: 0.000017

=== Epoch 20 ===
Epoch 20, 8.6%	 loss: 2.697 acc@1: 41.09 mrr: 55.32, ndcg: 60.48, took: 1.11s
Epoch 20, 17.2%	 loss: 2.867 acc@1: 39.53 mrr: 53.91, ndcg: 58.82, took: 1.03s
Epoch 20, 25.9%	 loss: 2.837 acc@1: 37.34 mrr: 52.90, ndcg: 58.13, took: 1.14s
Epoch 20, 34.5%	 loss: 2.945 acc@1: 33.75 mrr: 49.65, ndcg: 55.19, took: 1.75s
Epoch 20, 43.1%	 loss: 2.866 acc@1: 37.97 mrr: 52.84, ndcg: 57.96, took: 1.88s
Epoch 20, 51.7%	 loss: 2.800 acc@1: 39.38 mrr: 53.96, ndcg: 58.52, took: 2.02s
Epoch 20, 60.3%	 loss: 2.634 acc@1: 41.41 mrr: 56.49, ndcg: 61.57, took: 1.97s
Epoch 20, 69.0%	 loss: 2.970 acc@1: 34.69 mrr: 50.40, ndcg: 55.78, took: 1.90s
Epoch 20, 77.6%	 loss: 2.895 acc@1: 38.12 mrr: 52.17, ndcg: 57.06, took: 1.78s
Epoch 20, 86.2%	 loss: 2.943 acc@1: 36.56 mrr: 51.25, ndcg: 56.32, took: 1.74s
Epoch 20, 94.8%	 loss: 2.940 acc@1: 32.81 mrr: 49.77, ndcg: 55.37, took: 1.89s
Validation - loss: 4.3558, acc@1: 35.39%, f1: 22.78%, mrr: 47.72%, ndcg: 51.90%
Training finished.	 Time: 584.72s.	 acc@1: 35.45%

=== Test Results ===
Test Results:
  acc@1: 32.04%
  acc@5: 54.31%
  acc@10: 58.02%
  mrr: 42.37%
  ndcg: 45.94%
  f1: 19.11%

=== Training Complete ===
