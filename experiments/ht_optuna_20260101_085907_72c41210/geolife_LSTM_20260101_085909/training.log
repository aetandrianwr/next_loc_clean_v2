Training LSTM model
Dataset: geolife
Config: /data/next_loc_clean_v2/config/ht_optuna/optuna_LSTM_geolife_prev3_t3_20260101_085907_72c41210.yaml
Device: cuda
Seed: 42
==================================================
Data loaders: train=224, val=104, test=109
Total trainable parameters: 541219

=== Epoch 1 ===
Epoch 1, 8.9%	 loss: 7.379 acc@1: 0.00 mrr: 0.50, ndcg: 0.25, took: 1.89s
Epoch 1, 17.9%	 loss: 7.276 acc@1: 0.00 mrr: 0.38, ndcg: 0.09, took: 1.11s
Epoch 1, 26.8%	 loss: 7.134 acc@1: 0.00 mrr: 0.78, ndcg: 0.45, took: 1.09s
Epoch 1, 35.7%	 loss: 6.866 acc@1: 1.09 mrr: 3.46, ndcg: 3.73, took: 1.14s
Epoch 1, 44.6%	 loss: 6.603 acc@1: 6.88 mrr: 10.32, ndcg: 11.27, took: 1.11s
Epoch 1, 53.6%	 loss: 6.193 acc@1: 15.47 mrr: 20.43, ndcg: 22.06, took: 1.15s
Epoch 1, 62.5%	 loss: 5.764 acc@1: 17.34 mrr: 24.89, ndcg: 27.67, took: 1.15s
Epoch 1, 71.4%	 loss: 5.403 acc@1: 19.06 mrr: 27.84, ndcg: 31.12, took: 1.14s
Epoch 1, 80.4%	 loss: 4.976 acc@1: 22.81 mrr: 32.78, ndcg: 36.30, took: 1.15s
Epoch 1, 89.3%	 loss: 5.006 acc@1: 20.62 mrr: 30.38, ndcg: 33.88, took: 1.16s
Epoch 1, 98.2%	 loss: 4.643 acc@1: 25.47 mrr: 35.73, ndcg: 39.92, took: 1.11s
Validation - loss: 4.8178, acc@1: 25.33%, f1: 15.67%, mrr: 35.59%, ndcg: 39.80%
Current learning rate: 0.000750

=== Epoch 2 ===
Epoch 2, 8.9%	 loss: 4.245 acc@1: 26.25 mrr: 38.94, ndcg: 43.50, took: 1.10s
Epoch 2, 17.9%	 loss: 4.259 acc@1: 23.75 mrr: 36.74, ndcg: 41.20, took: 1.11s
Epoch 2, 26.8%	 loss: 3.964 acc@1: 31.09 mrr: 43.06, ndcg: 47.25, took: 1.10s
Epoch 2, 35.7%	 loss: 3.841 acc@1: 28.91 mrr: 42.91, ndcg: 47.91, took: 1.14s
Epoch 2, 44.6%	 loss: 3.725 acc@1: 33.59 mrr: 45.99, ndcg: 50.70, took: 1.14s
Epoch 2, 53.6%	 loss: 3.799 acc@1: 31.41 mrr: 44.62, ndcg: 49.59, took: 1.14s
Epoch 2, 62.5%	 loss: 3.905 acc@1: 30.31 mrr: 42.70, ndcg: 47.57, took: 1.15s
Epoch 2, 71.4%	 loss: 3.662 acc@1: 32.03 mrr: 45.17, ndcg: 50.12, took: 1.15s
Epoch 2, 80.4%	 loss: 3.672 acc@1: 35.62 mrr: 47.78, ndcg: 52.51, took: 1.15s
Epoch 2, 89.3%	 loss: 3.603 acc@1: 34.69 mrr: 47.75, ndcg: 52.56, took: 1.12s
Epoch 2, 98.2%	 loss: 3.617 acc@1: 36.72 mrr: 48.83, ndcg: 53.01, took: 1.12s
Validation - loss: 4.5135, acc@1: 32.77%, f1: 18.96%, mrr: 44.43%, ndcg: 48.83%
Current learning rate: 0.001500

=== Epoch 3 ===
Epoch 3, 8.9%	 loss: 3.224 acc@1: 37.81 mrr: 50.73, ndcg: 55.54, took: 1.06s
Epoch 3, 17.9%	 loss: 3.292 acc@1: 33.28 mrr: 47.32, ndcg: 52.26, took: 1.12s
Epoch 3, 26.8%	 loss: 3.187 acc@1: 37.66 mrr: 51.55, ndcg: 56.17, took: 1.11s
Epoch 3, 35.7%	 loss: 3.326 acc@1: 35.62 mrr: 48.93, ndcg: 53.72, took: 1.10s
Epoch 3, 44.6%	 loss: 3.294 acc@1: 37.19 mrr: 50.51, ndcg: 55.37, took: 1.15s
Epoch 3, 53.6%	 loss: 3.342 acc@1: 32.34 mrr: 47.39, ndcg: 52.59, took: 1.14s
Epoch 3, 62.5%	 loss: 3.267 acc@1: 35.31 mrr: 49.40, ndcg: 54.70, took: 1.15s
Epoch 3, 71.4%	 loss: 3.160 acc@1: 36.72 mrr: 51.31, ndcg: 56.24, took: 1.11s
Epoch 3, 80.4%	 loss: 3.163 acc@1: 35.94 mrr: 50.87, ndcg: 56.10, took: 1.11s
Epoch 3, 89.3%	 loss: 3.147 acc@1: 36.72 mrr: 51.35, ndcg: 56.42, took: 1.10s
Epoch 3, 98.2%	 loss: 3.117 acc@1: 36.72 mrr: 51.96, ndcg: 57.26, took: 1.07s
Validation - loss: 4.3659, acc@1: 33.10%, f1: 22.46%, mrr: 45.63%, ndcg: 50.10%
Current learning rate: 0.001469

=== Epoch 4 ===
Epoch 4, 8.9%	 loss: 2.775 acc@1: 35.47 mrr: 52.24, ndcg: 58.15, took: 0.98s
Epoch 4, 17.9%	 loss: 2.743 acc@1: 38.91 mrr: 54.27, ndcg: 59.28, took: 1.03s
Epoch 4, 26.8%	 loss: 2.738 acc@1: 34.06 mrr: 51.88, ndcg: 58.12, took: 1.08s
Epoch 4, 35.7%	 loss: 2.807 acc@1: 38.91 mrr: 53.35, ndcg: 58.82, took: 1.13s
Epoch 4, 44.6%	 loss: 2.860 acc@1: 36.56 mrr: 51.89, ndcg: 57.25, took: 1.13s
Epoch 4, 53.6%	 loss: 2.951 acc@1: 36.09 mrr: 51.78, ndcg: 56.95, took: 1.17s
Epoch 4, 62.5%	 loss: 2.775 acc@1: 39.06 mrr: 54.50, ndcg: 59.61, took: 1.13s
Epoch 4, 71.4%	 loss: 2.819 acc@1: 37.66 mrr: 53.57, ndcg: 58.99, took: 1.16s
Epoch 4, 80.4%	 loss: 3.023 acc@1: 35.78 mrr: 50.63, ndcg: 56.09, took: 1.14s
Epoch 4, 89.3%	 loss: 2.842 acc@1: 33.91 mrr: 50.71, ndcg: 56.77, took: 1.11s
Epoch 4, 98.2%	 loss: 2.987 acc@1: 35.47 mrr: 50.76, ndcg: 56.38, took: 1.00s
Validation - loss: 4.4801, acc@1: 34.22%, f1: 22.29%, mrr: 46.51%, ndcg: 50.74%
Current learning rate: 0.001438

=== Epoch 5 ===
Epoch 5, 8.9%	 loss: 2.504 acc@1: 36.41 mrr: 54.38, ndcg: 61.07, took: 0.96s
Epoch 5, 17.9%	 loss: 2.607 acc@1: 36.72 mrr: 53.85, ndcg: 60.11, took: 1.04s
Epoch 5, 26.8%	 loss: 2.524 acc@1: 38.91 mrr: 55.45, ndcg: 61.43, took: 1.01s
Epoch 5, 35.7%	 loss: 2.686 acc@1: 36.25 mrr: 52.43, ndcg: 58.53, took: 1.11s
Epoch 5, 44.6%	 loss: 2.475 acc@1: 40.00 mrr: 56.50, ndcg: 62.57, took: 1.14s
Epoch 5, 53.6%	 loss: 2.498 acc@1: 37.66 mrr: 55.29, ndcg: 61.53, took: 1.11s
Epoch 5, 62.5%	 loss: 2.576 acc@1: 36.56 mrr: 54.49, ndcg: 61.41, took: 1.13s
Epoch 5, 71.4%	 loss: 2.608 acc@1: 37.19 mrr: 53.68, ndcg: 60.08, took: 1.13s
Epoch 5, 80.4%	 loss: 2.553 acc@1: 37.81 mrr: 54.59, ndcg: 60.80, took: 1.13s
Epoch 5, 89.3%	 loss: 2.808 acc@1: 34.69 mrr: 51.12, ndcg: 57.36, took: 1.12s
Epoch 5, 98.2%	 loss: 2.503 acc@1: 41.56 mrr: 57.26, ndcg: 62.44, took: 1.03s
Validation - loss: 4.5509, acc@1: 35.00%, f1: 24.03%, mrr: 47.05%, ndcg: 51.12%
Current learning rate: 0.001406

=== Epoch 6 ===
Epoch 6, 8.9%	 loss: 2.182 acc@1: 42.34 mrr: 60.12, ndcg: 67.47, took: 0.90s
Epoch 6, 17.9%	 loss: 2.357 acc@1: 37.97 mrr: 56.31, ndcg: 63.05, took: 1.03s
Epoch 6, 26.8%	 loss: 2.377 acc@1: 38.12 mrr: 55.73, ndcg: 62.36, took: 1.04s
Epoch 6, 35.7%	 loss: 2.263 acc@1: 38.75 mrr: 57.25, ndcg: 64.61, took: 1.02s
Epoch 6, 44.6%	 loss: 2.437 acc@1: 37.03 mrr: 55.06, ndcg: 61.65, took: 1.11s
Epoch 6, 53.6%	 loss: 2.297 acc@1: 40.31 mrr: 57.41, ndcg: 63.97, took: 1.14s
Epoch 6, 62.5%	 loss: 2.447 acc@1: 40.78 mrr: 56.54, ndcg: 63.01, took: 1.15s
Epoch 6, 71.4%	 loss: 2.388 acc@1: 40.78 mrr: 57.46, ndcg: 63.82, took: 1.14s
Epoch 6, 80.4%	 loss: 2.346 acc@1: 38.44 mrr: 56.51, ndcg: 63.20, took: 1.13s
Epoch 6, 89.3%	 loss: 2.395 acc@1: 38.44 mrr: 56.17, ndcg: 62.46, took: 1.16s
Epoch 6, 98.2%	 loss: 2.514 acc@1: 35.16 mrr: 53.66, ndcg: 61.10, took: 1.03s
Validation - loss: 4.5850, acc@1: 32.95%, f1: 24.69%, mrr: 45.82%, ndcg: 50.26%
Current learning rate: 0.001375

=== Epoch 7 ===
Epoch 7, 8.9%	 loss: 2.116 acc@1: 40.31 mrr: 59.24, ndcg: 67.37, took: 0.90s
Epoch 7, 17.9%	 loss: 2.089 acc@1: 43.59 mrr: 60.56, ndcg: 67.81, took: 0.98s
Epoch 7, 26.8%	 loss: 2.094 acc@1: 43.91 mrr: 61.52, ndcg: 69.01, took: 1.00s
Epoch 7, 35.7%	 loss: 2.007 acc@1: 41.25 mrr: 60.95, ndcg: 68.30, took: 1.03s
Epoch 7, 44.6%	 loss: 2.322 acc@1: 36.25 mrr: 55.59, ndcg: 63.14, took: 1.02s
Epoch 7, 53.6%	 loss: 2.237 acc@1: 38.91 mrr: 57.25, ndcg: 64.56, took: 1.11s
Epoch 7, 62.5%	 loss: 2.218 acc@1: 39.06 mrr: 57.73, ndcg: 65.16, took: 1.14s
Epoch 7, 71.4%	 loss: 2.287 acc@1: 37.66 mrr: 56.38, ndcg: 63.71, took: 1.15s
Epoch 7, 80.4%	 loss: 2.278 acc@1: 37.50 mrr: 56.52, ndcg: 64.10, took: 1.14s
Epoch 7, 89.3%	 loss: 2.272 acc@1: 35.16 mrr: 55.14, ndcg: 63.21, took: 1.15s
Epoch 7, 98.2%	 loss: 2.300 acc@1: 40.31 mrr: 57.52, ndcg: 64.56, took: 1.01s
Validation - loss: 4.6348, acc@1: 34.52%, f1: 24.38%, mrr: 46.82%, ndcg: 51.15%
Current learning rate: 0.001344

=== Epoch 8 ===
Epoch 8, 8.9%	 loss: 1.892 acc@1: 43.28 mrr: 62.55, ndcg: 70.22, took: 0.91s
Epoch 8, 17.9%	 loss: 1.907 acc@1: 45.16 mrr: 63.33, ndcg: 71.10, took: 1.06s
Epoch 8, 26.8%	 loss: 2.050 acc@1: 43.44 mrr: 61.01, ndcg: 68.47, took: 1.03s
Epoch 8, 35.7%	 loss: 1.940 acc@1: 43.28 mrr: 61.95, ndcg: 69.45, took: 1.03s
Epoch 8, 44.6%	 loss: 2.051 acc@1: 42.03 mrr: 60.14, ndcg: 67.34, took: 1.00s
Epoch 8, 53.6%	 loss: 1.936 acc@1: 44.06 mrr: 61.97, ndcg: 69.42, took: 1.03s
Epoch 8, 62.5%	 loss: 2.158 acc@1: 35.94 mrr: 56.28, ndcg: 64.93, took: 1.06s
Epoch 8, 71.4%	 loss: 2.186 acc@1: 37.66 mrr: 57.09, ndcg: 65.15, took: 1.09s
Epoch 8, 80.4%	 loss: 2.137 acc@1: 40.31 mrr: 58.83, ndcg: 66.55, took: 1.13s
Epoch 8, 89.3%	 loss: 2.080 acc@1: 40.31 mrr: 59.13, ndcg: 66.80, took: 1.09s
Epoch 8, 98.2%	 loss: 2.206 acc@1: 37.03 mrr: 56.45, ndcg: 64.44, took: 0.99s
Validation - loss: 4.6876, acc@1: 34.73%, f1: 25.64%, mrr: 46.75%, ndcg: 51.02%
Current learning rate: 0.000131

=== Epoch 9 ===
Epoch 9, 8.9%	 loss: 2.739 acc@1: 37.34 mrr: 53.59, ndcg: 59.61, took: 0.92s
Epoch 9, 17.9%	 loss: 2.828 acc@1: 35.16 mrr: 51.60, ndcg: 57.21, took: 0.98s
Epoch 9, 26.8%	 loss: 2.844 acc@1: 35.78 mrr: 51.57, ndcg: 57.16, took: 1.02s
Epoch 9, 35.7%	 loss: 2.756 acc@1: 38.28 mrr: 53.70, ndcg: 59.29, took: 1.13s
Epoch 9, 44.6%	 loss: 2.672 acc@1: 41.41 mrr: 56.18, ndcg: 61.57, took: 1.08s
Epoch 9, 53.6%	 loss: 2.745 acc@1: 40.47 mrr: 55.02, ndcg: 60.26, took: 1.04s
Epoch 9, 62.5%	 loss: 2.540 acc@1: 42.66 mrr: 57.46, ndcg: 62.45, took: 1.02s
Epoch 9, 71.4%	 loss: 2.812 acc@1: 39.38 mrr: 53.91, ndcg: 59.29, took: 1.01s
Epoch 9, 80.4%	 loss: 2.584 acc@1: 38.44 mrr: 55.16, ndcg: 61.00, took: 1.01s
Epoch 9, 89.3%	 loss: 2.668 acc@1: 38.28 mrr: 54.41, ndcg: 59.93, took: 1.03s
Epoch 9, 98.2%	 loss: 2.659 acc@1: 37.97 mrr: 54.24, ndcg: 59.81, took: 1.02s
Validation - loss: 4.3050, acc@1: 35.57%, f1: 23.52%, mrr: 47.64%, ndcg: 51.87%
Current learning rate: 0.000131

=== Epoch 10 ===
Epoch 10, 8.9%	 loss: 2.640 acc@1: 37.34 mrr: 54.53, ndcg: 60.31, took: 0.94s
Epoch 10, 17.9%	 loss: 2.640 acc@1: 35.62 mrr: 53.10, ndcg: 59.53, took: 0.94s
Epoch 10, 26.8%	 loss: 2.593 acc@1: 39.69 mrr: 55.37, ndcg: 60.65, took: 1.00s
Epoch 10, 35.7%	 loss: 2.622 acc@1: 40.00 mrr: 55.43, ndcg: 60.91, took: 1.07s
Epoch 10, 44.6%	 loss: 2.622 acc@1: 41.09 mrr: 55.97, ndcg: 61.31, took: 1.11s
Epoch 10, 53.6%	 loss: 2.522 acc@1: 41.88 mrr: 56.96, ndcg: 62.40, took: 1.14s
Epoch 10, 62.5%	 loss: 2.567 acc@1: 42.50 mrr: 56.80, ndcg: 62.20, took: 1.11s
Epoch 10, 71.4%	 loss: 2.551 acc@1: 41.56 mrr: 56.79, ndcg: 62.42, took: 1.04s
Epoch 10, 80.4%	 loss: 2.515 acc@1: 40.47 mrr: 56.94, ndcg: 62.54, took: 1.06s
Epoch 10, 89.3%	 loss: 2.704 acc@1: 36.88 mrr: 53.33, ndcg: 59.29, took: 1.04s
Epoch 10, 98.2%	 loss: 2.580 acc@1: 40.94 mrr: 56.26, ndcg: 61.47, took: 0.91s
Validation - loss: 4.3158, acc@1: 35.42%, f1: 23.69%, mrr: 47.70%, ndcg: 51.99%
Current learning rate: 0.000131

=== Epoch 11 ===
Epoch 11, 8.9%	 loss: 2.535 acc@1: 39.84 mrr: 56.22, ndcg: 61.84, took: 1.01s
Epoch 11, 17.9%	 loss: 2.419 acc@1: 43.44 mrr: 58.98, ndcg: 64.61, took: 1.00s
Epoch 11, 26.8%	 loss: 2.520 acc@1: 39.69 mrr: 56.19, ndcg: 62.12, took: 1.04s
Epoch 11, 35.7%	 loss: 2.422 acc@1: 43.75 mrr: 58.93, ndcg: 64.53, took: 1.06s
Epoch 11, 44.6%	 loss: 2.641 acc@1: 39.84 mrr: 55.23, ndcg: 60.84, took: 1.08s
Epoch 11, 53.6%	 loss: 2.421 acc@1: 43.28 mrr: 58.62, ndcg: 64.24, took: 1.13s
Epoch 11, 62.5%	 loss: 2.623 acc@1: 39.53 mrr: 55.37, ndcg: 60.80, took: 1.15s
Epoch 11, 71.4%	 loss: 2.558 acc@1: 39.84 mrr: 56.08, ndcg: 61.83, took: 1.11s
Epoch 11, 80.4%	 loss: 2.648 acc@1: 39.22 mrr: 54.33, ndcg: 60.09, took: 1.05s
Epoch 11, 89.3%	 loss: 2.610 acc@1: 38.75 mrr: 54.42, ndcg: 60.23, took: 0.99s
Epoch 11, 98.2%	 loss: 2.545 acc@1: 39.84 mrr: 56.13, ndcg: 62.11, took: 0.90s
Validation - loss: 4.3500, acc@1: 35.42%, f1: 23.65%, mrr: 47.69%, ndcg: 51.98%
Current learning rate: 0.000131

=== Epoch 12 ===
Epoch 12, 8.9%	 loss: 2.395 acc@1: 45.16 mrr: 59.49, ndcg: 64.73, took: 1.00s
Epoch 12, 17.9%	 loss: 2.514 acc@1: 38.28 mrr: 55.46, ndcg: 61.82, took: 0.95s
Epoch 12, 26.8%	 loss: 2.561 acc@1: 39.84 mrr: 55.64, ndcg: 61.60, took: 0.97s
Epoch 12, 35.7%	 loss: 2.504 acc@1: 41.41 mrr: 57.18, ndcg: 62.76, took: 1.02s
Epoch 12, 44.6%	 loss: 2.430 acc@1: 40.00 mrr: 57.32, ndcg: 63.87, took: 1.04s
Epoch 12, 53.6%	 loss: 2.536 acc@1: 40.78 mrr: 56.49, ndcg: 62.40, took: 1.07s
Epoch 12, 62.5%	 loss: 2.417 acc@1: 40.16 mrr: 57.21, ndcg: 63.19, took: 1.07s
Epoch 12, 71.4%	 loss: 2.579 acc@1: 38.91 mrr: 55.34, ndcg: 61.18, took: 1.12s
Epoch 12, 80.4%	 loss: 2.449 acc@1: 38.28 mrr: 55.86, ndcg: 62.53, took: 1.07s
Epoch 12, 89.3%	 loss: 2.528 acc@1: 39.69 mrr: 55.75, ndcg: 61.54, took: 0.95s
Epoch 12, 98.2%	 loss: 2.353 acc@1: 44.22 mrr: 59.93, ndcg: 65.35, took: 0.89s
Validation - loss: 4.3823, acc@1: 35.33%, f1: 23.92%, mrr: 47.73%, ndcg: 52.12%
Current learning rate: 0.000131

=== Epoch 13 ===
Epoch 13, 8.9%	 loss: 2.386 acc@1: 42.03 mrr: 58.43, ndcg: 64.67, took: 1.03s
Epoch 13, 17.9%	 loss: 2.370 acc@1: 44.53 mrr: 59.44, ndcg: 65.05, took: 1.03s
Epoch 13, 26.8%	 loss: 2.411 acc@1: 41.09 mrr: 57.70, ndcg: 64.29, took: 0.99s
Epoch 13, 35.7%	 loss: 2.507 acc@1: 39.22 mrr: 56.02, ndcg: 62.11, took: 1.02s
Epoch 13, 44.6%	 loss: 2.297 acc@1: 44.38 mrr: 60.20, ndcg: 65.83, took: 1.06s
Epoch 13, 53.6%	 loss: 2.569 acc@1: 40.78 mrr: 56.02, ndcg: 61.91, took: 1.06s
Epoch 13, 62.5%	 loss: 2.334 acc@1: 42.66 mrr: 58.82, ndcg: 64.91, took: 1.02s
Epoch 13, 71.4%	 loss: 2.438 acc@1: 39.69 mrr: 56.64, ndcg: 62.93, took: 1.06s
Epoch 13, 80.4%	 loss: 2.254 acc@1: 43.59 mrr: 60.15, ndcg: 66.23, took: 1.11s
Epoch 13, 89.3%	 loss: 2.569 acc@1: 39.69 mrr: 55.54, ndcg: 61.27, took: 0.98s
Epoch 13, 98.2%	 loss: 2.542 acc@1: 38.44 mrr: 55.02, ndcg: 61.59, took: 0.90s
Validation - loss: 4.3882, acc@1: 35.54%, f1: 23.88%, mrr: 47.85%, ndcg: 52.15%
Current learning rate: 0.000131

=== Epoch 14 ===
Epoch 14, 8.9%	 loss: 2.462 acc@1: 41.09 mrr: 57.18, ndcg: 63.08, took: 1.03s
Epoch 14, 17.9%	 loss: 2.329 acc@1: 42.34 mrr: 59.12, ndcg: 65.12, took: 1.01s
Epoch 14, 26.8%	 loss: 2.462 acc@1: 38.91 mrr: 56.19, ndcg: 62.05, took: 1.03s
Epoch 14, 35.7%	 loss: 2.433 acc@1: 40.16 mrr: 56.56, ndcg: 62.55, took: 1.05s
Epoch 14, 44.6%	 loss: 2.416 acc@1: 41.25 mrr: 57.55, ndcg: 63.61, took: 1.10s
Epoch 14, 53.6%	 loss: 2.258 acc@1: 41.56 mrr: 58.90, ndcg: 65.61, took: 1.05s
Epoch 14, 62.5%	 loss: 2.381 acc@1: 42.34 mrr: 58.39, ndcg: 64.77, took: 1.06s
Epoch 14, 71.4%	 loss: 2.399 acc@1: 38.12 mrr: 56.34, ndcg: 62.71, took: 1.02s
Epoch 14, 80.4%	 loss: 2.357 acc@1: 39.22 mrr: 56.99, ndcg: 63.65, took: 1.06s
Epoch 14, 89.3%	 loss: 2.394 acc@1: 40.47 mrr: 57.31, ndcg: 63.47, took: 1.03s
Epoch 14, 98.2%	 loss: 2.345 acc@1: 42.81 mrr: 58.87, ndcg: 65.22, took: 0.94s
Validation - loss: 4.4134, acc@1: 35.72%, f1: 24.60%, mrr: 47.96%, ndcg: 52.24%
Current learning rate: 0.000013

=== Epoch 15 ===
Epoch 15, 8.9%	 loss: 2.571 acc@1: 38.75 mrr: 54.89, ndcg: 61.24, took: 1.02s
Epoch 15, 17.9%	 loss: 2.593 acc@1: 38.75 mrr: 55.08, ndcg: 61.05, took: 1.04s
Epoch 15, 26.8%	 loss: 2.625 acc@1: 42.03 mrr: 56.34, ndcg: 61.50, took: 1.04s
Epoch 15, 35.7%	 loss: 2.607 acc@1: 38.44 mrr: 54.28, ndcg: 60.17, took: 1.02s
Epoch 15, 44.6%	 loss: 2.581 acc@1: 41.25 mrr: 56.44, ndcg: 61.89, took: 1.06s
Epoch 15, 53.6%	 loss: 2.666 acc@1: 38.59 mrr: 54.63, ndcg: 60.34, took: 1.07s
Epoch 15, 62.5%	 loss: 2.560 acc@1: 40.00 mrr: 55.95, ndcg: 61.38, took: 1.05s
Epoch 15, 71.4%	 loss: 2.621 acc@1: 40.16 mrr: 55.50, ndcg: 61.24, took: 1.02s
Epoch 15, 80.4%	 loss: 2.578 acc@1: 41.25 mrr: 56.46, ndcg: 62.25, took: 1.03s
Epoch 15, 89.3%	 loss: 2.641 acc@1: 37.66 mrr: 54.19, ndcg: 60.32, took: 0.93s
Epoch 15, 98.2%	 loss: 2.591 acc@1: 44.06 mrr: 57.90, ndcg: 62.45, took: 0.94s
Validation - loss: 4.2946, acc@1: 35.36%, f1: 23.51%, mrr: 47.59%, ndcg: 51.81%
Current learning rate: 0.000013

=== Epoch 16 ===
Epoch 16, 8.9%	 loss: 2.567 acc@1: 40.78 mrr: 55.99, ndcg: 61.40, took: 1.11s
Epoch 16, 17.9%	 loss: 2.692 acc@1: 40.00 mrr: 54.99, ndcg: 60.15, took: 1.01s
Epoch 16, 26.8%	 loss: 2.495 acc@1: 42.66 mrr: 57.37, ndcg: 62.86, took: 1.04s
Epoch 16, 35.7%	 loss: 2.463 acc@1: 42.03 mrr: 57.79, ndcg: 63.49, took: 1.02s
Epoch 16, 44.6%	 loss: 2.602 acc@1: 39.53 mrr: 55.57, ndcg: 60.87, took: 1.04s
Epoch 16, 53.6%	 loss: 2.591 acc@1: 38.75 mrr: 55.14, ndcg: 61.15, took: 1.05s
Epoch 16, 62.5%	 loss: 2.770 acc@1: 36.56 mrr: 52.58, ndcg: 58.53, took: 1.06s
Epoch 16, 71.4%	 loss: 2.462 acc@1: 39.69 mrr: 56.28, ndcg: 62.27, took: 1.04s
Epoch 16, 80.4%	 loss: 2.659 acc@1: 37.81 mrr: 53.98, ndcg: 59.66, took: 1.04s
Epoch 16, 89.3%	 loss: 2.605 acc@1: 41.88 mrr: 56.28, ndcg: 61.32, took: 0.92s
Epoch 16, 98.2%	 loss: 2.542 acc@1: 41.25 mrr: 56.92, ndcg: 62.35, took: 0.91s
Validation - loss: 4.3097, acc@1: 35.39%, f1: 23.23%, mrr: 47.62%, ndcg: 51.88%
Current learning rate: 0.000013

=== Epoch 17 ===
Epoch 17, 8.9%	 loss: 2.704 acc@1: 40.16 mrr: 54.80, ndcg: 60.22, took: 1.08s
Epoch 17, 17.9%	 loss: 2.635 acc@1: 39.22 mrr: 54.51, ndcg: 60.06, took: 1.07s
Epoch 17, 26.8%	 loss: 2.430 acc@1: 42.81 mrr: 58.19, ndcg: 63.90, took: 1.06s
Epoch 17, 35.7%	 loss: 2.585 acc@1: 40.00 mrr: 55.67, ndcg: 61.30, took: 1.07s
Epoch 17, 44.6%	 loss: 2.588 acc@1: 38.91 mrr: 55.18, ndcg: 61.06, took: 1.04s
Epoch 17, 53.6%	 loss: 2.502 acc@1: 43.28 mrr: 57.99, ndcg: 63.53, took: 1.07s
Epoch 17, 62.5%	 loss: 2.446 acc@1: 42.03 mrr: 57.92, ndcg: 63.75, took: 1.10s
Epoch 17, 71.4%	 loss: 2.577 acc@1: 40.47 mrr: 55.92, ndcg: 61.28, took: 1.04s
Epoch 17, 80.4%	 loss: 2.563 acc@1: 42.19 mrr: 57.19, ndcg: 62.28, took: 1.01s
Epoch 17, 89.3%	 loss: 2.638 acc@1: 39.53 mrr: 54.73, ndcg: 60.09, took: 0.91s
Epoch 17, 98.2%	 loss: 2.538 acc@1: 41.41 mrr: 56.52, ndcg: 61.82, took: 0.91s
Validation - loss: 4.3105, acc@1: 35.69%, f1: 23.56%, mrr: 47.84%, ndcg: 52.04%
Current learning rate: 0.000013

=== Epoch 18 ===
Epoch 18, 8.9%	 loss: 2.482 acc@1: 41.41 mrr: 57.46, ndcg: 63.11, took: 1.08s
Epoch 18, 17.9%	 loss: 2.592 acc@1: 42.19 mrr: 56.90, ndcg: 62.12, took: 1.11s
Epoch 18, 26.8%	 loss: 2.509 acc@1: 41.56 mrr: 57.00, ndcg: 62.47, took: 1.14s
Epoch 18, 35.7%	 loss: 2.481 acc@1: 40.00 mrr: 56.43, ndcg: 62.62, took: 1.09s
Epoch 18, 44.6%	 loss: 2.583 acc@1: 41.25 mrr: 56.01, ndcg: 61.43, took: 1.06s
Epoch 18, 53.6%	 loss: 2.601 acc@1: 41.25 mrr: 56.45, ndcg: 61.45, took: 1.05s
Epoch 18, 62.5%	 loss: 2.634 acc@1: 38.75 mrr: 54.62, ndcg: 60.44, took: 1.05s
Epoch 18, 71.4%	 loss: 2.551 acc@1: 38.59 mrr: 54.84, ndcg: 60.78, took: 1.03s
Epoch 18, 80.4%	 loss: 2.594 acc@1: 38.59 mrr: 55.06, ndcg: 61.04, took: 1.04s
Epoch 18, 89.3%	 loss: 2.575 acc@1: 38.59 mrr: 54.82, ndcg: 60.87, took: 0.94s
Epoch 18, 98.2%	 loss: 2.682 acc@1: 38.75 mrr: 54.38, ndcg: 60.00, took: 0.95s
Validation - loss: 4.3305, acc@1: 35.39%, f1: 23.20%, mrr: 47.67%, ndcg: 51.96%
Current learning rate: 0.000013

=== Epoch 19 ===
Epoch 19, 8.9%	 loss: 2.504 acc@1: 40.78 mrr: 57.11, ndcg: 63.09, took: 1.05s
Epoch 19, 17.9%	 loss: 2.630 acc@1: 40.16 mrr: 55.60, ndcg: 61.10, took: 1.09s
Epoch 19, 26.8%	 loss: 2.565 acc@1: 40.47 mrr: 55.82, ndcg: 61.29, took: 1.14s
Epoch 19, 35.7%	 loss: 2.744 acc@1: 38.44 mrr: 53.28, ndcg: 59.19, took: 1.14s
Epoch 19, 44.6%	 loss: 2.395 acc@1: 42.34 mrr: 58.32, ndcg: 64.14, took: 1.06s
Epoch 19, 53.6%	 loss: 2.673 acc@1: 36.56 mrr: 53.20, ndcg: 59.32, took: 1.03s
Epoch 19, 62.5%	 loss: 2.529 acc@1: 41.72 mrr: 56.99, ndcg: 62.45, took: 1.07s
Epoch 19, 71.4%	 loss: 2.605 acc@1: 40.94 mrr: 55.48, ndcg: 60.82, took: 1.05s
Epoch 19, 80.4%	 loss: 2.450 acc@1: 44.53 mrr: 59.15, ndcg: 64.50, took: 0.98s
Epoch 19, 89.3%	 loss: 2.627 acc@1: 37.34 mrr: 54.46, ndcg: 60.74, took: 0.93s
Epoch 19, 98.2%	 loss: 2.420 acc@1: 41.09 mrr: 57.68, ndcg: 63.43, took: 0.93s
Validation - loss: 4.3182, acc@1: 35.72%, f1: 23.85%, mrr: 47.85%, ndcg: 52.05%
Current learning rate: 0.000013

=== Epoch 20 ===
Epoch 20, 8.9%	 loss: 2.594 acc@1: 41.25 mrr: 56.17, ndcg: 61.42, took: 1.03s
Epoch 20, 17.9%	 loss: 2.445 acc@1: 41.88 mrr: 57.73, ndcg: 63.72, took: 1.04s
Epoch 20, 26.8%	 loss: 2.595 acc@1: 40.31 mrr: 55.76, ndcg: 61.42, took: 1.04s
Epoch 20, 35.7%	 loss: 2.573 acc@1: 37.81 mrr: 54.79, ndcg: 60.95, took: 1.04s
Epoch 20, 44.6%	 loss: 2.503 acc@1: 42.19 mrr: 57.51, ndcg: 62.97, took: 1.02s
Epoch 20, 53.6%	 loss: 2.506 acc@1: 42.97 mrr: 57.82, ndcg: 63.38, took: 0.95s
Epoch 20, 62.5%	 loss: 2.596 acc@1: 40.47 mrr: 55.66, ndcg: 61.02, took: 0.96s
Epoch 20, 71.4%	 loss: 2.615 acc@1: 37.66 mrr: 54.15, ndcg: 60.35, took: 0.93s
Epoch 20, 80.4%	 loss: 2.566 acc@1: 38.59 mrr: 55.04, ndcg: 61.13, took: 0.94s
Epoch 20, 89.3%	 loss: 2.571 acc@1: 39.84 mrr: 55.34, ndcg: 60.94, took: 0.89s
Epoch 20, 98.2%	 loss: 2.580 acc@1: 40.47 mrr: 56.05, ndcg: 61.82, took: 0.81s
Validation - loss: 4.3207, acc@1: 35.93%, f1: 24.07%, mrr: 47.98%, ndcg: 52.13%
Training finished.	 Time: 297.42s.	 acc@1: 35.36%

=== Test Results ===
Test Results:
  acc@1: 30.60%
  acc@5: 56.45%
  acc@10: 60.27%
  mrr: 42.21%
  ndcg: 46.35%
  f1: 20.10%

=== Training Complete ===
